function main(){var e,t,i,r,n,o,a,s,l,d,c=new Date;startingUp=!0;var u=jQuery(document);jQuery.noConflict(),window.onbeforeunload=function(){return window.confirmExit?confirmExit():void 0},params=getParameters(),params&&(params=params.parseParams("open",null,!1)),store=new TiddlyWiki({config:config}),invokeParamifier(params,"oninit"),story=new Story("tiddlerDisplay","tiddler"),addEvent(document,"click",Popup.onDocumentClick),saveTest();var p;for(p=0;p<config.notifyTiddlers.length;p++)store.addNotification(config.notifyTiddlers[p].name,config.notifyTiddlers[p].notify);d=new Date,loadShadowTiddlers(),u.trigger("loadShadows"),l=new Date,store.loadFromDiv("storeArea","store",!0),u.trigger("loadTiddlers"),loadOptions(),s=new Date,invokeParamifier(params,"onload"),a=new Date,readOnly=window.allowSave()?!1:config.options.chkHttpReadOnly;var f=loadPlugins("systemConfig");u.trigger("loadPlugins"),o=new Date,formatter=new Formatter(config.formatters),invokeParamifier(params,"onconfig"),story.switchTheme(config.options.txtTheme),showBackstage=void 0!==showBackstage?showBackstage:!readOnly,n=new Date;var h;for(h in config.macros)config.macros[h].init&&config.macros[h].init();r=new Date,store.notifyAll(),i=new Date,restart(),refreshDisplay(),t=new Date,f&&(story.displayTiddler(null,"PluginManager"),displayMessage(config.messages.customConfigError)),showBackstage&&backstage.init(),e=new Date,config.options.chkDisplayInstrumentation&&(displayMessage("LoadShadows "+(l-d)+" ms"),displayMessage("LoadFromDiv "+(s-l)+" ms"),displayMessage("LoadPlugins "+(o-a)+" ms"),displayMessage("Macro init "+(r-n)+" ms"),displayMessage("Notify "+(i-r)+" ms"),displayMessage("Restart "+(t-i)+" ms"),displayMessage("Total: "+(e-c)+" ms")),startingUp=!1,u.trigger("startup")}function unload(){window.checkUnsavedChanges&&checkUnsavedChanges(),window.scrubNodes&&scrubNodes(document.body)}function restart(){invokeParamifier(params,"onstart"),story.isEmpty()&&story.displayDefaultTiddlers(),window.scrollTo(0,0)}function saveTest(){var e=document.getElementById("saveTest");e.hasChildNodes()&&alert(config.messages.savedSnapshotError),e.appendChild(document.createTextNode("savetest"))}function loadShadowTiddlers(){var e=new TiddlyWiki;e.loadFromDiv("shadowArea","shadows",!0),e.forEachTiddler(function(e,t){config.shadowTiddlers[e]=t.text})}function loadPlugins(e){if(safeMode)return!1;var t=store.getTaggedTiddlers(e);t.sort(function(e,t){return e.title<t.title?-1:e.title==t.title?0:1});var i=[],r=0,n={},o=t.length;installedPlugins=[];var a;for(a=0;o>a;a++){var s=getPluginInfo(t[a]);installedPlugins[a]=s;var l=s.Name||s.title;l&&(n[l]=s),l=s.Source,l&&(n[l]=s)}var d=function(e){if(e&&!e.done){e.done=1;var t=e.Requires;if(t){t=t.readBracketedList();var r;for(r=0;r<t.length;r++)d(n[t[r]])}i.push(e)}};for(a=0;o>a;a++)d(installedPlugins[a]);for(a=0;a<i.length;a++)if(s=i[a],pluginInfo=s,tiddler=s.tiddler,isPluginExecutable(s))if(isPluginEnabled(s)){s.executed=!0;var c=new Date;try{tiddler.text&&window.eval(tiddler.text),r++}catch(u){s.log.push(config.messages.pluginError.format([exceptionText(u)])),s.error=!0,console.tiddlywiki||console.log("error evaluating "+tiddler.title,u)}pluginInfo.startupTime=String(new Date-c)+"ms"}else o--;else s.warning=!0;return r!=o}function getPluginInfo(e){var t=store.getTiddlerSlices(e.title,["Name","Description","Version","Requires","CoreVersion","Date","Source","Author","License","Browsers"]);return t.tiddler=e,t.title=e.title,t.log=[],t}function isPluginExecutable(e){if(e.tiddler.isTagged("systemConfigForce"))return e.log.push(config.messages.pluginForced),!0;if(e.CoreVersion){var t=e.CoreVersion.split("."),i=parseInt(t[0],10)-version.major;if(0==i&&t[1]&&(i=parseInt(t[1],10)-version.minor),0==i&&t[2]&&(i=parseInt(t[2],10)-version.revision),i>0)return e.log.push(config.messages.pluginVersionError),!1}return!0}function isPluginEnabled(e){return e.tiddler.isTagged("systemConfigDisable")?(e.log.push(config.messages.pluginDisabled),!1):!0}function getParameters(){var e=null;return window.location.hash&&(e=decodeURIComponent(window.location.hash.substr(1)),null!=config.browser.firefoxDate&&config.browser.firefoxDate[1]<"20051111"&&(e=convertUTF8ToUnicode(e))),e}function invokeParamifier(e,t){if(e&&void 0!=e.length&&!(e.length<=1)){var i;for(i=1;i<e.length;i++){var r=config.paramifiers[e[i].name];if(r&&r[t]instanceof Function)r[t](e[i].value);else{var n=config.optionHandlers[e[i].name.substr(0,3)];n&&n.set instanceof Function&&n.set(e[i].name,e[i].value)}}}}function Formatter(e){var t;this.formatters=[];var i=[];for(t=0;t<e.length;t++)i.push("("+e[t].match+")"),this.formatters.push(e[t]);this.formatterRegExp=new RegExp(i.join("|"),"mg")}function getParser(e,t){if(e){t||(t=e.fields.wikiformat);var i;if(t){for(i in config.parsers)if(t==config.parsers[i].format)return config.parsers[i]}else for(i in config.parsers)if(e.isTagged(config.parsers[i].formatTag))return config.parsers[i]}return formatter}function Wikifier(e,t,i,r){this.source=e,this.output=null,this.formatter=t,this.nextMatch=0,this.autoLinkWikiWords=r&&0==r.autoLinkWikiWords()?!1:!0,this.highlightRegExp=i,this.highlightMatch=null,this.isStatic=!1,i&&(i.lastIndex=0,this.highlightMatch=i.exec(e)),this.tiddler=r}function wikify(e,t,i,r){if(e){var n=new Wikifier(e,getParser(r),i,r),o=new Date;n.subWikify(t),r&&config.options.chkDisplayInstrumentation&&displayMessage("wikify:"+r.title+" in "+(new Date-o)+" ms")}}function wikifyStatic(e,t,i,r){var n=createTiddlyElement(document.body,"pre");n.style.display="none";var o="";if(e&&""!=e){i||(i=new Tiddler("temp"));var a=new Wikifier(e,getParser(i,r),t,i);a.isStatic=!0,a.subWikify(n),o=n.innerHTML,jQuery(n).remove()}return o}function wikifyPlainText(e,t,i){t>0&&(e=e.substr(0,t));var r=new Wikifier(e,formatter,null,i);return r.wikifyPlain()}function highlightify(e,t,i,r){if(e){var n=new Wikifier(e,formatter,i,r);n.outputText(t,0,e.length)}}function invokeMacro(e,t,i,r,n){try{var o=config.macros[t];if(o&&o.handler){var a=story.findContainingTiddler(e);window.tiddler=a?store.getTiddler(a.getAttribute("tiddler")):null,window.place=e;var s=!0;"system"==config.evaluateMacroParameters&&(n&&-1!=n.tags.indexOf("systemAllowEval")||(s=!1)),o.handler(e,t,o.noPreParse?null:i.readMacroParams(!s),r,i,n)}else createTiddlyError(e,config.messages.macroError.format([t]),config.messages.macroErrorDetails.format([t,config.messages.missingMacro]))}catch(l){createTiddlyError(e,config.messages.macroError.format([t]),config.messages.macroErrorDetails.format([t,l.toString()]))}}function Tiddler(e){return this.title=e,this.text="",this.creator=null,this.modifier=null,this.created=new Date,this.modified=this.created,this.links=[],this.linksUpdated=!1,this.tags=[],this.fields={},this}function TiddlyWiki(e){var t={};e&&e.config&&(this.config=config),this.tiddlersUpdated=!1,this.namedNotifications=[],this.notificationLevel=0,this.slices={},this.clear=function(){t={},this.setDirty(!1)},this.fetchTiddler=function(e){var i=t[e];return i instanceof Tiddler?i:null},this.deleteTiddler=function(e){delete this.slices[e],delete t[e]},this.addTiddler=function(e){delete this.slices[e.title],t[e.title]=e},this.forEachTiddler=function(e){var i;for(i in t){var r=t[i];r instanceof Tiddler&&e.call(this,i,r)}}}function StringFieldAccess(e,t){this.set=t?function(t,i){if(i!=t[e])throw config.messages.fieldCannotBeChanged.format([e])}:function(t,i){return i!=t[e]?(t[e]=i,!0):void 0},this.get=function(t){return t[e]}}function DateFieldAccess(e){this.set=function(t,i){var r=i instanceof Date?i:Date.convertFromYYYYMMDDHHMM(i);return r!=t[e]?(t[e]=r,!0):void 0},this.get=function(t){return t[e].convertToYYYYMMDDHHMM()}}function LinksFieldAccess(e){this.set=function(t,i){var r="string"==typeof i?i.readBracketedList():i;return r.toString()!=t[e].toString()?(t[e]=r,!0):void 0},this.get=function(t){return String.encodeTiddlyLinkList(t[e])}}function Story(e,t){this.container=e,this.idPrefix=t,this.highlightRegExp=null,this.tiddlerId=function(e){e=e.replace(/_/g,"__").replace(/ /g,"_");var t=this.idPrefix+e;return t==this.container?this.idPrefix+"_"+e:t},this.containerId=function(){return this.container}}function upgradeFrom(e){var t=new TiddlyWiki,i=loadFile(e);void 0!==window.netscape&&(i=convertUTF8ToUnicode(i)),t.importTiddlyWiki(i),t.forEachTiddler(function(e,t){store.getTiddler(e)||store.addTiddler(t)}),refreshDisplay(),saveChanges(),alert(config.messages.upgradeDone.format([formatVersion()])),window.location=window.location.toString().substr(0,window.location.toString().lastIndexOf("?"))}function getMessageDiv(){var e=document.getElementById("messageArea");return e?(e.hasChildNodes()||createTiddlyButton(createTiddlyElement(e,"div",null,"messageToolbar"),config.messages.messageClose.text,config.messages.messageClose.tooltip,clearMessage),e.style.display="block",createTiddlyElement(e,"div")):null}function displayMessage(e,t){var i=getMessageDiv();if(!i)return void alert(e);if(t){var r=createTiddlyElement(i,"a",null,null,e);r.href=t,r.target="_blank"}else i.appendChild(document.createTextNode(e))}function clearMessage(){var e=document.getElementById("messageArea");return e&&(jQuery(e).empty(),e.style.display="none"),!1}function refreshElements(e,t){var i,r=e.childNodes;for(i=0;i<r.length;i++){var n=r[i],o=null;n.getAttribute&&(n.tagName?"IFRAME"!=n.tagName:!0)&&(o=n.getAttribute("refresh"));var a=config.refreshers[o],s=!1;void 0!=a&&(s=a(n,t)),n.hasChildNodes()&&!s&&refreshElements(n,t)}}function applyHtmlMacros(e,t){for(var i=e.firstChild;i;){var r=i.nextSibling;if(i.getAttribute){var n=i.getAttribute("macro");if(n){i.removeAttribute("macro");var o="",a=n.indexOf(" ");-1!=a&&(o=n.substr(a+1),n=n.substr(0,a)),invokeMacro(i,n,o,null,t)}}i.hasChildNodes()&&applyHtmlMacros(i,t),i=r}}function refreshPageTemplate(e){var t,i,r=jQuery("<div/>").appendTo("body").hide()[0],n=story.getContainer();if(n)for(t=n.childNodes,i=t.length-1;i>=0;i--)r.appendChild(t[i]);var o=document.getElementById("contentWrapper");for(e&&store.isAvailable(e)||(e=config.refresherData.pageTemplate),store.isAvailable(e)||(e=config.refresherData.defaultPageTemplate),o.innerHTML=store.getRecursiveTiddlerText(e,null,10),applyHtmlMacros(o),refreshElements(o),n=story.getContainer(),jQuery(n).empty(),n||(n=createTiddlyElement(o,"div",story.containerId())),t=r.childNodes,i=t.length-1;i>=0;i--)n.appendChild(t[i]);jQuery(r).remove()}function refreshDisplay(e){"string"==typeof e&&(e=[e]);var t=document.getElementById("contentWrapper");refreshElements(t,e),backstage.isPanelVisible()&&(t=document.getElementById("backstage"),refreshElements(t,e))}function refreshPageTitle(){document.title=getPageTitle()}function getPageTitle(){return wikifyPlainText(store.getTiddlerText("WindowTitle",""),null,tiddler)}function refreshStyles(e,t){setStylesheet(null==e?"":store.getRecursiveTiddlerText(e,"",10),e,t||document)}function refreshColorPalette(){startingUp||refreshAll()}function refreshAll(){refreshPageTemplate(),refreshDisplay(),refreshStyles("StyleSheetLayout"),refreshStyles("StyleSheetColors"),refreshStyles(config.refresherData.styleSheet),refreshStyles("StyleSheetPrint")}function setOption(e,t){var i=e.substr(0,3);config.optionHandlers[i]&&config.optionHandlers[i].set&&config.optionHandlers[i].set(e,t)}function getOption(e){var t=e.substr(0,3);return config.optionHandlers[t]&&config.optionHandlers[t].get?config.optionHandlers[t].get(e):null}function loadOptions(){safeMode||(loadCookies(),loadSystemSettings())}function getCookies(){var e,t=document.cookie.split(";"),i={};for(e=0;e<t.length;e++){var r=t[e].indexOf("=");if(-1!=r){var n=t[e].substr(0,r).trim(),o=t[e].substr(r+1).trim();i[n]=o}}return i}function loadCookies(){var e,t=getCookies();t.TiddlyWiki&&(t=t.TiddlyWiki.decodeHashMap());for(e in t)"setting"!=config.optionsSource[e]&&setOption(e,t[e])}function loadSystemSettings(){var e,t=store.calcAllSlices("SystemSettings");config.optionsSource={};for(e in t)setOption(e,t[e]),config.optionsSource[e]="setting"}function onSystemSettingsChange(){startingUp||loadSystemSettings()}function saveOption(e){if(!safeMode){if(e.match(/[()\s]/g,"_"))return void alert(config.messages.invalidCookie.format([e]));saveCookie(e),"setting"==config.optionsSource[e]&&saveSystemSetting(e,!0)}}function removeCookie(e){document.cookie=e+"=; expires=Thu, 01-Jan-1970 00:00:01 UTC; path=/;"}function saveCookie(){var e,t={};for(e in config.options){var i=getOption(e);i=null==i?"false":i,t[e]=i}document.cookie="TiddlyWiki="+String.encodeHashMap(t)+"; expires=Fri, 1 Jan 2038 12:00:00 UTC; path=/",t=getCookies();var r;for(r in t){var n=r.substr(0,3);config.optionHandlers[n]&&removeCookie(r)}}function commitSystemSettings(){systemSettingSave&&window.clearTimeout(systemSettingSave),systemSettingSave=window.setTimeout(function(){var e=store.getTiddler("SystemSettings");autoSaveChanges(null,[e])},1e3)}function saveSystemSetting(e,t){var i="SystemSettings",r=store.getTiddlerSlice(i,e);if(!readOnly&&r!==getOption(e)){var n,o=store.calcAllSlices(i);for(n in config.optionsSource){var a=getOption(n)||"";o[n]!==a&&(o[n]=a)}var s=[];for(n in o)s.push("%0: %1".format([n,o[n]]));s=s.sort().join("\n");var l=store.isDirty(),d=store.getTiddler(i);d?(d.text=s,d=store.saveTiddler(d)):d=store.saveTiddler(i,i,s,"System",new Date,["excludeLists"],config.defaultCustomFields),t&&commitSystemSettings(l)}}function encodeCookie(e){return escape(convertUnicodeToHtmlEntities(e))}function decodeCookie(s){s=unescape(s);var re=/&#[0-9]{1,5};/g;return s.replace(re,function($0){return String.fromCharCode(eval($0.replace(/[&#;]/g,"")))})}function confirmExit(){return hadConfirmExit=!0,store&&store.isDirty&&store.isDirty()||story&&story.areAnyDirty&&story.areAnyDirty()?config.messages.confirmExit:void 0}function checkUnsavedChanges(){store&&store.isDirty&&store.isDirty()&&window.hadConfirmExit===!1&&confirm(config.messages.unsavedChangesWarning)&&saveChanges()}function updateLanguageAttribute(e){if(config.locale){var t=/(<html(?:.*?)?)(?: xml:lang\="([a-z]+)")?(?: lang\="([a-z]+)")?>/,i=t.exec(e);if(i){var r=i[1];i[2]&&(r+=' xml:lang="'+config.locale+'"'),i[3]&&(r+=' lang="'+config.locale+'"'),r+=">",e=e.substr(0,i.index)+r+e.substr(i.index+i[0].length)}}return e}function updateMarkupBlock(e,t,i){return e.replaceChunk("<!--%0-START-->".format([t]),"<!--%0-END-->".format([t]),"\n"+convertUnicodeToFileFormat(store.getRecursiveTiddlerText(i,""))+"\n")}function updateOriginal(e,t,i){if(t||(t=locateStoreArea(e)),!t)return alert(config.messages.invalidFileError.format([i])),null;var r=e.substr(0,t[0]+startSaveArea.length)+"\n"+convertUnicodeToFileFormat(store.allTiddlersAsHtml())+"\n"+e.substr(t[1]),n=convertUnicodeToFileFormat(getPageTitle()).htmlEncode();return r=r.replaceChunk("<title>","</title>"," "+n+" "),r=updateLanguageAttribute(r),r=updateMarkupBlock(r,"PRE-HEAD","MarkupPreHead"),r=updateMarkupBlock(r,"POST-HEAD","MarkupPostHead"),r=updateMarkupBlock(r,"PRE-BODY","MarkupPreBody"),r=updateMarkupBlock(r,"POST-SCRIPT","MarkupPostBody")}function locateStoreArea(e){if(!e)return null;var t=e.search(startSaveAreaRE),i=e.indexOf("<!--POST-STOREAREA-->");-1==i&&(i=e.indexOf("<!--POST-BODY-START-->"));var r=-1==i?e.length:i,n=e.lastIndexOf(endSaveArea,r);return-1==n&&(n=e.lastIndexOf(endSaveAreaCaps,r)),-1!=t&&-1!=n?[t,n]:null}function autoSaveChanges(e,t){config.options.chkAutoSave&&saveChanges(e,t)}function loadOriginal(e){return loadFile(e)}function saveChanges(e){if(!e||store.isDirty()){clearMessage();var t=new Date,i=config.messages,r=document.location.toString();if(!window.allowSave())return alert(i.notFileUrlError),void(store.tiddlerExists(i.saveInstructions)&&story.displayTiddler(null,i.saveInstructions));var n=getLocalPath(r),o=loadOriginal(n);if(null==o)return alert(i.cantSaveError),void(store.tiddlerExists(i.saveInstructions)&&story.displayTiddler(null,i.saveInstructions));var a=locateStoreArea(o);if(!a)return void alert(i.invalidFileError.format([n]));saveMain(n,o,a),config.options.chkSaveBackups&&saveBackup(n,o),config.options.chkSaveEmptyTemplate&&saveEmpty(n,o,a),config.options.chkGenerateAnRssFeed&&saveRss instanceof Function&&saveRss(n),config.options.chkDisplayInstrumentation&&displayMessage("saveChanges "+(new Date-t)+" ms")}}function saveMain(e,t,i){var r;try{var n=updateOriginal(t,i,e);r=saveFile(e,n)}catch(o){showException(o)}r?(displayMessage(config.messages.mainSaved,"file://"+e),store.setDirty(!1)):alert(config.messages.mainFailed)}function saveBackup(e,t){var i=getBackupPath(e),r=copyFile(i,e);r||(r=saveFile(i,t)),r?displayMessage(config.messages.backupSaved,"file://"+i):alert(config.messages.backupFailed)}function saveEmpty(e,t,i){var r,n;r=-1!=(n=e.lastIndexOf("/"))?e.substr(0,n)+"/":-1!=(n=e.lastIndexOf("\\"))?e.substr(0,n)+"\\":e+".",r+="empty.html";var o=t.substr(0,i[0]+startSaveArea.length)+t.substr(i[1]),a=saveFile(r,o);a?displayMessage(config.messages.emptySaved,"file://"+r):alert(config.messages.emptyFailed)}function getBackupPath(e,t,i){var r="\\",n=e.lastIndexOf("\\");-1==n&&(n=e.lastIndexOf("/"),r="/");var o=config.options.txtBackupFolder;o&&""!=o||(o=".");var a=e.substr(0,n)+r+o+e.substr(n);return a=a.substr(0,a.lastIndexOf("."))+".",t&&(a+=t.replace(/[\\\/\*\?\":<> ]/g,"_")+"."),a+=(new Date).convertToYYYYMMDDHHMMSSMMM()+"."+(i||"html")}function saveRss(e){var t=e.substr(0,e.lastIndexOf("."))+".xml";saveFile(t,convertUnicodeToFileFormat(generateRss()))?displayMessage(config.messages.rssSaved,"file://"+t):alert(config.messages.rssFailed)}function generateRss(){var e=[],t=new Date,i=store.getTiddlerText("SiteUrl");e.push('<?xml version="1.0"?>'),e.push('<rss version="2.0">'),e.push("<channel>"),e.push("<title>"+wikifyPlainText(store.getTiddlerText("SiteTitle",""),null,tiddler).htmlEncode()+"</title>"),i&&e.push("<link>"+i.htmlEncode()+"</link>"),e.push("<description>"+wikifyPlainText(store.getTiddlerText("SiteSubtitle",""),null,tiddler).htmlEncode()+"</description>"),e.push("<language>"+config.locale+"</language>"),e.push("<copyright>Copyright "+t.getFullYear()+" "+config.options.txtUserName.htmlEncode()+"</copyright>"),e.push("<pubDate>"+t.toGMTString()+"</pubDate>"),e.push("<lastBuildDate>"+t.toGMTString()+"</lastBuildDate>"),e.push("<docs>http://blogs.law.harvard.edu/tech/rss</docs>"),e.push("<generator>TiddlyWiki "+formatVersion()+"</generator>");var r,n=store.getTiddlers("modified","excludeLists"),o=config.numRssItems>n.length?0:n.length-config.numRssItems;for(r=n.length-1;r>=o;r--)e.push("<item>\n"+tiddlerToRssItem(n[r],i)+"\n</item>");return e.push("</channel>"),e.push("</rss>"),e.join("\n")}function ieCreatePath(e){try{var t=new ActiveXObject("Scripting.FileSystemObject")}catch(r){return null}var n=e.lastIndexOf("\\");-1==n&&(n=e.lastIndexOf("/")),-1!=n&&(e=e.substring(0,n+1));for(var o=[e],a=t.GetParentFolderName(e);a&&!t.FolderExists(a);)o.push(a),a=t.GetParentFolderName(a);for(i=o.length-1;i>=0;i--)t.FolderExists(o[i])||t.CreateFolder(o[i]);return!0}function ieSaveFile(e,t){ieCreatePath(e);try{var i=new ActiveXObject("Scripting.FileSystemObject")}catch(r){return null}var n=i.OpenTextFile(e,2,-1,0);return n.Write(t),n.Close(),!0}function ieLoadFile(e){try{var t=new ActiveXObject("Scripting.FileSystemObject"),i=t.OpenTextFile(e,1),r=i.ReadAll();i.Close()}catch(n){return null}return r}function ieCopyFile(e,t){ieCreatePath(e);try{var i=new ActiveXObject("Scripting.FileSystemObject");i.GetFile(t).Copy(e)}catch(r){return!1}return!0}function mozillaSaveFile(e,t){if(window.Components)try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var i=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);i.initWithPath(e),i.exists()||i.create(0,436);var r=Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);return r.init(i,34,4,null),r.write(t,t.length),r.flush(),r.close(),!0}catch(n){return!1}return null}function mozillaLoadFile(e){if(window.Components)try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var t=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);if(t.initWithPath(e),!t.exists())return null;var i=Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(Components.interfaces.nsIFileInputStream);i.init(t,1,4,null);var r=Components.classes["@mozilla.org/scriptableinputstream;1"].createInstance(Components.interfaces.nsIScriptableInputStream);r.init(i);var n=r.read(r.available());return r.close(),i.close(),n}catch(o){return!1}return null}function javaUrlToFilename(e){var t="//localhost";if(0==e.indexOf(t))return e.substring(t.length);var i=e.indexOf(":");return i>0?e.substring(i-1):e}function logTiddlySaverException(e,t){var i=document.applets.TiddlySaver;if(console.log(e+": "+t),LOG_TIDDLYSAVER&&i)try{console.log(e+": "+i.getLastErrorMsg()),console.log(e+": "+i.getLastErrorStackTrace())}catch(t){}}function javaDebugInformation(){function e(e,i){try{result=String(i.call(t))}catch(r){result=String(r)}return e+": "+result}var t=document.applets.TiddlySaver,i=[["Java Version",t.getJavaVersion],["Last Exception",t.getLastErrorMessage],["Last Exception Stack Trace",t.getLastErrorStackTrace],["System Properties",t.getSystemProperties]];return jQuery.map(i,function(t){return e.apply(this,t)}).join("\n\n")}function javaSaveFile(e,t){var i=document.applets.TiddlySaver;try{if(i&&e)return i.saveFile(javaUrlToFilename(e),"UTF-8",t)}catch(r){logTiddlySaverException("javaSaveFile",r)}try{var n=new java.io.PrintStream(new java.io.FileOutputStream(javaUrlToFilename(e)));n.print(t),n.close()}catch(o){return null}return!0}function javaLoadFile(e){var t=document.applets.TiddlySaver;try{if(t&&e){var i=t.loadFile(javaUrlToFilename(e),"UTF-8");return i?String(i):null}}catch(r){logTiddlySaverException("javaLoadFile",r)}var n=[];try{for(var o,a=new java.io.BufferedReader(new java.io.FileReader(javaUrlToFilename(e)));null!=(o=a.readLine());)n.push(String(o));a.close()}catch(s){return null}return n.join("\n")}function convertUTF8ToUnicode(e){return config.browser.isOpera||!window.netscape?manualConvertUTF8ToUnicode(e):mozConvertUTF8ToUnicode(e)}function manualConvertUTF8ToUnicode(e){for(var t,i,r,n,o=e,a=0,s=0;a<e.length;)t=e.charCodeAt(a++),128>t?s++:224>t?(i=e.charCodeAt(a++),n=String.fromCharCode((31&t)<<6|63&i),o=o.substring(0,s++).concat(n,e.substr(a))):(i=e.charCodeAt(a++),r=e.charCodeAt(a++),n=String.fromCharCode((15&t)<<12|(63&i)<<6|63&r),o=o.substring(0,s++).concat(n,e.substr(a)));return o}function mozConvertUTF8ToUnicode(e){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var t=Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Components.interfaces.nsIScriptableUnicodeConverter);t.charset="UTF-8"}catch(i){return manualConvertUTF8ToUnicode(e)}var r=t.ConvertToUnicode(e),n=t.Finish();return n.length>0?r+n:r}function convertUnicodeToFileFormat(e){return config.browser.isOpera||!window.netscape?config.browser.isIE?convertUnicodeToHtmlEntities(e):e:mozConvertUnicodeToUTF8(e)}function convertUnicodeToHtmlEntities(e){var t=/[^\u0000-\u007F]/g;return e.replace(t,function(e){return"&#"+e.charCodeAt(0).toString()+";"})}function convertUnicodeToUTF8(e){return convertUnicodeToFileFormat(e)}function manualConvertUnicodeToUTF8(e){return unescape(encodeURIComponent(e))}function mozConvertUnicodeToUTF8(e){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var t=Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Components.interfaces.nsIScriptableUnicodeConverter);t.charset="UTF-8"}catch(i){return manualConvertUnicodeToUTF8(e)}var r=t.ConvertFromUnicode(e),n=t.Finish();return n.length>0?r+n:r}function convertUriToUTF8(e,t){if(void 0==window.netscape||void 0==t||""==t)return e;try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var i=Components.classes["@mozilla.org/intl/utf8converterservice;1"].getService(Components.interfaces.nsIUTF8ConverterService)}catch(r){return e}return i.convertURISpecToUTF8(e,t)}function AdaptorBase(){return this.host=null,this.store=null,this}function FileAdaptor(){}function ajaxReq(e){if(e.url.startsWith("file"))try{window.Components&&window.netscape&&window.netscape.security&&window.netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead")}catch(t){return localAjax(e)}return jQuery.ajax(e)}function localAjax(e){var t=loadFile(getLocalPath(e.url));if(t){var i={responseText:t};e.success(t,"success",i)}else{var i={message:"Cannot read local file"};e.error(i,"error",0)}return!0}function httpReq(e,t,i,r,n,o,a,s,l,d){var c=function(e){try{return!e.status&&"file:"===location.protocol||e.status>=200&&e.status<300||304===e.status||1223===e.status}catch(t){}return!1},u={type:e,url:t,processData:!1,data:o,cache:!!d,beforeSend:function(e){var t;for(t in n)e.setRequestHeader(t,n[t])}};i&&(u.complete=function(e){c(e)?i(!0,r,e.responseText,t,e):i(!1,r,null,t,e)}),a&&(u.contentType=a),s&&(u.username=s),l&&(u.password=l);try{window.Components&&window.netscape&&window.netscape.security&&-1==document.location.protocol.indexOf("http")&&window.netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead")}catch(p){}return jQuery.ajax(u)}function formatVersion(e){return e=e||version,e.major+"."+e.minor+"."+e.revision+(e.alpha?" (alpha "+e.alpha+")":"")+(e.beta?" (beta "+e.beta+")":"")}function compareVersions(e,t){var i,r,n,o=["major","minor","revision"];for(n=0;n<o.length;n++){if(i=e[o[n]]||0,r=t[o[n]]||0,r>i)return 1;if(i>r)return-1}return i=e.beta||9999,r=t.beta||9999,r>i?1:i>r?-1:0}function merge(e,t,i){var r;for(r in t)i&&void 0!==e[r]||(e[r]=t[r]);return e}function resolveTarget(e){var t;return e.target?t=e.target:e.srcElement&&(t=e.srcElement),3==t.nodeType&&(t=t.parentNode),t}function exceptionText(e,t){var i=e.description||e.toString();return t?"%0:\n%1".format([t,i]):i}function showException(e,t){alert(exceptionText(e,t))}function alertAndThrow(e){throw alert(e),e}function glyph(e){var t=config.glyphs,i=t.currBrowser;if(null==i){for(i=0;i<t.browsers.length-1&&!t.browsers[i]();)i++;t.currBrowser=i}return t.codes[e]?t.codes[e][i]:""}function createTiddlyText(e,t){return e.appendChild(document.createTextNode(t))}function createTiddlyCheckbox(e,t,i,r){var n=document.createElement("input");return n.setAttribute("type","checkbox"),n.onclick=r,e.appendChild(n),n.checked=i,n.className="chkOptionInput",t&&wikify(t,e),n}function createTiddlyElement(e,t,i,r,n,o){var a,s=document.createElement(t);if(null!=r&&(s.className=r),null!=i&&s.setAttribute("id",i),null!=n&&s.appendChild(document.createTextNode(n)),o)for(a in o)s.setAttribute(a,o[a]);return null!=e&&e.appendChild(s),s}function createTiddlyButton(e,t,i,r,n,o,a,s){var l,d=document.createElement("a");if(d.setAttribute("href","javascript:;"),r&&(d.onclick=r),i&&d.setAttribute("title",i),t&&d.appendChild(document.createTextNode(t)),d.className=n||"button",o&&(d.id=o),s)for(l in s)d.setAttribute(l,s[l]);return e&&e.appendChild(d),a&&d.setAttribute("accessKey",a),d}function createExternalLink(e,t,i){var r=document.createElement("a");r.className="externalLink",r.href=t;var n=config.messages.externalLinkTooltip;return r.title=n?n.format([t]):t,config.options.chkOpenInNewWindow&&(r.target="_blank"),e.appendChild(r),i&&createTiddlyText(r,i),r}function getTiddlyLinkInfo(e,t){var i=t?t.split(" "):[];i.pushUnique("tiddlyLink");var r,n=store.fetchTiddler(e);if(n)r=n.getSubtitle(),i.pushUnique("tiddlyLinkExisting"),i.remove("tiddlyLinkNonExisting"),i.remove("shadow");else{var o;i.remove("tiddlyLinkExisting"),i.pushUnique("tiddlyLinkNonExisting"),store.isShadowTiddler(e)?(o=config.messages.shadowedTiddlerToolTip,i.pushUnique("shadow")):(o=config.messages.undefinedTiddlerToolTip,i.remove("shadow")),r=o?o.format([e]):""}return"string"==typeof config.annotations[e]&&(r=config.annotations[e]),{classes:i.join(" "),subTitle:r}}function onClickTiddlerLink(e){var t=e||window.event,i=resolveTarget(t),r=i,n=null,o=null,a=null;do n=r.getAttribute("tiddlyLink"),o=r.getAttribute("tiddlyFields"),a=r.getAttribute("noToggle"),r=r.parentNode;while(null==n&&null!=r);if(!store.isShadowTiddler(n)){var s=o?o.decodeHashMap():{};o=String.encodeHashMap(merge(s,config.defaultCustomFields,!0))}if(n){var l=t.metaKey||t.ctrlKey;config.options.chkToggleLinks&&(l=!l),a&&(l=!1),store.getTiddler(n)&&(o=null),story.displayTiddler(i,n,null,!0,null,o,l)}return clearMessage(),!1}function createTiddlyLink(e,t,i,r,n,o,a){var t=jQuery.trim(t),s=i?t:null,l=getTiddlyLinkInfo(t,r),d=n?createExternalLink(e,store.getTiddlerText("SiteUrl",null)+"#"+t):createTiddlyButton(e,s,l.subTitle,onClickTiddlerLink,l.classes);if(n&&(d.className+=" "+r),d.setAttribute("refresh","link"),d.setAttribute("tiddlyLink",t),a&&d.setAttribute("noToggle","true"),o){var c=o.getInheritedFields();c&&d.setAttribute("tiddlyFields",c)}return d}function refreshTiddlyLink(e,t){var i=getTiddlyLinkInfo(t,e.className);e.className=i.classes,e.title=i.subTitle}function createTiddlyDropDown(e,t,i,r){var n=createTiddlyElement(e,"select");n.onchange=t;var o;for(o=0;o<i.length;o++){var a=createTiddlyElement(n,"option",null,null,i[o].caption);a.value=i[o].name,i[o].name==r&&(a.selected=!0)}return n}function onClickTagOpenAll(){var e=store.getTaggedTiddlers(this.getAttribute("tag")),t=this.getAttribute("sortby");return t&&t.length&&store.sortTiddlers(e,t),story.displayTiddlers(this,e),!1}function onClickTag(e){var t=e||window.event,i=Popup.create(this);jQuery(i).addClass("taggedTiddlerList");var r=this.getAttribute("tag"),n=this.getAttribute("tiddler");if(i&&r){var o=-1==r.indexOf("[")?store.getTaggedTiddlers(r):store.filterTiddlers(r),a=this.getAttribute("sortby");a&&a.length&&store.sortTiddlers(o,a);var s,l=[];for(s=0;s<o.length;s++)o[s].title!=n&&l.push(o[s].title);var d=config.views.wikified.tag;if(l.length>0){var c=createTiddlyButton(createTiddlyElement(i,"li"),d.openAllText.format([r]),d.openAllTooltip,onClickTagOpenAll);for(c.setAttribute("tag",r),c.setAttribute("sortby",a),createTiddlyElement(createTiddlyElement(i,"li",null,"listBreak"),"div"),s=0;s<l.length;s++)createTiddlyLink(createTiddlyElement(i,"li"),l[s],!0)}else createTiddlyElement(i,"li",null,"disabled",d.popupNone.format([r]));createTiddlyElement(createTiddlyElement(i,"li",null,"listBreak"),"div");var u=createTiddlyLink(createTiddlyElement(i,"li"),r,!1);createTiddlyText(u,d.openTag.format([r]))}return Popup.show(),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),!1}function createTagButton(e,t,i,r,n){var o=createTiddlyButton(e,r||t,(n||config.views.wikified.tag.tooltip).format([t]),onClickTag);return o.setAttribute("tag",t),i&&o.setAttribute("tiddler",i),o}function onClickTiddlyPopup(e){var t=e||window.event,i=this.tiddler;if(i.text){var r=Popup.create(this,"div","popupTiddler");wikify(i.text,r,null,i),Popup.show()}return t&&(t.cancelBubble=!0),t&&t.stopPropagation&&t.stopPropagation(),!1}function createTiddlyPopup(e,t,i,r){if(r.text){createTiddlyLink(e,t,!0);var n=createTiddlyButton(e,glyph("downArrow"),i,onClickTiddlyPopup,"tiddlerPopupButton");n.tiddler=r}else createTiddlyText(e,t)}function onClickError(e){var t,i=e||window.event,r=Popup.create(this),n=this.getAttribute("errorText").split("\n");for(t=0;t<n.length;t++)createTiddlyElement(r,"li",null,null,n[t]);return Popup.show(),i.cancelBubble=!0,i.stopPropagation&&i.stopPropagation(),!1}function createTiddlyError(e,t,i){var r=createTiddlyButton(e,t,null,onClickError,"errorButton");i&&r.setAttribute("errorText",i)}function Animator(){return this.running=0,this.timerID=0,this.animations=[],this}function Morpher(e,t,i,r){return this.element=e,this.duration=t,this.properties=i,this.startTime=new Date,this.endTime=Number(this.startTime)+t,this.callback=r,this.tick(),this}function Zoomer(e,t,i){var r=createTiddlyElement(document.body,"div",null,"zoomer");createTiddlyElement(r,"div",null,null,e);var n=findWindowWidth(),o=findWindowHeight(),a=[{style:"left",start:findPosX(t),end:findPosX(i),template:"%0px"},{style:"top",start:findPosY(t),end:findPosY(i),template:"%0px"},{style:"width",start:Math.min(t.scrollWidth,n),end:Math.min(i.scrollWidth,n),template:"%0px",atEnd:"auto"},{style:"height",start:Math.min(t.scrollHeight,o),end:Math.min(i.scrollHeight,o),template:"%0px",atEnd:"auto"},{style:"fontSize",start:8,end:24,template:"%0pt"}],s=function(e){jQuery(e).remove()
};return new Morpher(r,config.animDuration,a,s)}function Scroller(e){var t=[{style:"-tw-vertScroll",start:findScrollY(),end:ensureVisible(e)}];return new Morpher(e,config.animDuration,t)}function Slider(e,t,i,r){e.style.overflow="hidden",t&&(e.style.height="0px"),e.style.display="block";var n=e.scrollHeight,o=[],a=null;if(t)o.push({style:"height",start:0,end:n,template:"%0px",atEnd:"auto"}),o.push({style:"opacity",start:0,end:1,template:"%0"}),o.push({style:"filter",start:0,end:100,template:"alpha(opacity:%0)"});else switch(o.push({style:"height",start:n,end:0,template:"%0px"}),o.push({style:"display",atEnd:"none"}),o.push({style:"opacity",start:1,end:0,template:"%0"}),o.push({style:"filter",start:100,end:0,template:"alpha(opacity:%0)"}),r){case"all":a=function(e){jQuery(e).remove()};break;case"children":a=function(e){jQuery(e).empty()}}return new Morpher(e,config.animDuration,o,a)}function Wizard(e){e?(this.formElem=findRelated(e,"wizard","className"),this.bodyElem=findRelated(this.formElem.firstChild,"wizardBody","className","nextSibling"),this.footElem=findRelated(this.formElem.firstChild,"wizardFooter","className","nextSibling")):(this.formElem=null,this.bodyElem=null,this.footElem=null)}function getParam(e,t,i){if(!e)return i;var r=e[0][t];return r?r[0]:i}function getFlag(e,t,i){return!!getParam(e,t,i)}function RGB(e,t,i){if(this.r=0,this.g=0,this.b=0,"string"==typeof e)if("#"==e.substr(0,1))7==e.length?(this.r=parseInt(e.substr(1,2),16)/255,this.g=parseInt(e.substr(3,2),16)/255,this.b=parseInt(e.substr(5,2),16)/255):(this.r=parseInt(e.substr(1,1),16)/15,this.g=parseInt(e.substr(2,1),16)/15,this.b=parseInt(e.substr(3,1),16)/15);else{var r=/rgb\s*\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/,n=e.match(r);n&&(this.r=parseInt(n[1],10)/255,this.g=parseInt(n[2],10)/255,this.b=parseInt(n[3],10)/255)}else this.r=e,this.g=t,this.b=i;return this}function drawGradient(e,t,i,r){r||(r=i);var n;for(n=0;100>=n;n+=2){var o=document.createElement("div");e.appendChild(o),o.style.position="absolute",o.style.left=t?n+"%":0,o.style.top=t?0:n+"%",o.style.width=t?101-n+"%":"100%",o.style.height=t?"100%":101-n+"%",o.style.zIndex=-1;var a=n/100*(i.length-1),s=r[Math.floor(a)];"string"==typeof s&&(s=new RGB(s));var l=i[Math.ceil(a)];"string"==typeof l&&(l=new RGB(l)),o.style.backgroundColor=s.mix(l,a-Math.floor(a)).toString()}}function addEvent(e,t,i){e.attachEvent?(e["e"+t+i]=i,e[t+i]=function(){e["e"+t+i](window.event)},e.attachEvent("on"+t,e[t+i])):e.addEventListener(t,i,!1)}function removeEvent(e,t,i){e.detachEvent?(e.detachEvent("on"+t,e[t+i]),e[t+i]=null):e.removeEventListener(t,i,!1)}function findRelated(e,t,i,r){if(i=i||"tagName",r=r||"parentNode","className"==i)for(;e&&!jQuery(e).hasClass(t);)e=e[r];else for(;e&&e[i]!=t;)e=e[r];return e}function ensureVisible(e){var t=findPosY(e),i=t+e.offsetHeight,r=findScrollY(),n=findWindowHeight(),o=r+n;return r>t?t:i>o?e.offsetHeight<n?t-(n-e.offsetHeight):t:r}function findWindowWidth(){return window.innerWidth||document.documentElement.clientWidth}function findWindowHeight(){return window.innerHeight||document.documentElement.clientHeight}function findDocHeight(){var e=document;return Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}function findScrollX(){return window.scrollX||document.documentElement.scrollLeft}function findScrollY(){return window.scrollY||document.documentElement.scrollTop}function findPosX(e){for(var t=0;e.offsetParent;)t+=e.offsetLeft,e=e.offsetParent;return t}function findPosY(e){for(var t=0;e.offsetParent;)t+=e.offsetTop,e=e.offsetParent;return t}function blurElement(e){e&&e.focus&&e.blur&&(e.focus(),e.blur())}function insertSpacer(e){var t=document.createTextNode(String.fromCharCode(160));return e&&e.appendChild(t),t}function replaceSelection(e,t){if(e.setSelectionRange){var i=e.selectionStart,r=e.selectionEnd>e.selectionStart;e.value=e.value.substr(0,e.selectionStart)+t+e.value.substr(e.selectionEnd),e.setSelectionRange(r?i:i+t.length,i+t.length);var n=e.value.split("\n").length,o=e.value.substr(0,e.selectionStart).split("\n").length-1;e.scrollTop=Math.floor((o-e.rows/2)*e.scrollHeight/n)}else if(document.selection){var a=document.selection.createRange();if(a.parentElement()==e){var s=""==a.text;a.text=t,s||(a.moveStart("character",-t.length),a.select())}}}function setCaretPosition(e,t){if(e.selectionStart||"0"==e.selectionStart)e.selectionStart=t,e.selectionEnd=t,e.focus();else if(document.selection){e.focus();var i=document.selection.createRange();i.moveStart("character",-e.value.length),i.moveStart("character",t),i.moveEnd("character",0),i.select()}}function getNodeText(e){for(var t="";e&&"#text"==e.nodeName;)t+=e.nodeValue,e=e.nextSibling;return t}function isDescendant(e,t){for(;e;){if(e===t)return!0;e=e.parentNode}return!1}function stopEvent(e){var t=e||window.event;return t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),!1}function scrubNode(e){if(config.browser.isIE){var t=e.attributes;if(t){var i;for(i=0;i<t.length;i++){var r=t[i].name;if("style"!==r&&("function"==typeof e[r]||"object"==typeof e[r]&&null!=e[r]))try{e[r]=null}catch(n){}}}for(var o=e.firstChild;o;)scrubNode(o),o=o.nextSibling}}function setStylesheet(e,t,i){jQuery.twStylesheet(e,{id:t,doc:i})}function removeStyleSheet(e){jQuery.twStylesheet.remove({id:e})}function LoaderBase(){}function SaverBase(){}function TW21Loader(){}function TW21Saver(){}function Crypto(){}function allTiddlersAsHtml(){return store.allTiddlersAsHtml()}function applyPageTemplate(e){refreshPageTemplate(e)}function displayTiddlers(e,t,i,r,n,o){story.displayTiddlers(e,t,i,o)}function displayTiddler(e,t,i,r,n,o){story.displayTiddler(e,t,i,o)}function loadRemoteFile(e,t,i){return httpReq("GET",e,t,i)}function doHttp(e,t,i,r,n,o,a,s,l,d){return httpReq(e,t,a,s,l,i,r,n,o,d)}function removeChildren(e){jQuery(e).empty()}function removeNode(e){jQuery(e).remove()}function getPlainText(e){return jQuery(e).text()}function addClass(e,t){jQuery(e).addClass(t)}function removeClass(e,t){jQuery(e).removeClass(t)}function hasClass(e,t){return jQuery(e).hasClass(t)}function wikifyPlain(e,t,i){return t||(t=store),t.tiddlerExists(e)||t.isShadowTiddler(e)?wikifyPlainText(t.getTiddlerText(e),i,tiddler):""}var config={numRssItems:20,animDuration:400,cascadeFast:20,cascadeSlow:60,cascadeDepth:5,locale:"en"};config.parsers={},config.adaptors={},config.defaultAdaptor=null,config.tasks={},config.annotations={},config.defaultCustomFields={},config.messages={messageClose:{},dates:{},tiddlerPopup:{}},config.options={chkRegExpSearch:!1,chkCaseSensitiveSearch:!1,chkIncrementalSearch:!0,chkAnimate:!0,chkSaveBackups:!0,chkAutoSave:!1,chkGenerateAnRssFeed:!1,chkSaveEmptyTemplate:!1,chkOpenInNewWindow:!0,chkToggleLinks:!1,chkHttpReadOnly:!0,chkForceMinorUpdate:!1,chkConfirmDelete:!0,chkInsertTabs:!1,chkUsePreForStorage:!0,chkDisplayInstrumentation:!1,txtBackupFolder:"",txtEditorFocus:"text",txtMainTab:"tabTimeline",txtMoreTab:"moreTabAll",txtMaxEditRows:"30",txtFileSystemCharSet:"UTF-8",txtTheme:""},config.optionsDesc={},config.optionsSource={};var DEFAULT_VIEW_TEMPLATE=1,DEFAULT_EDIT_TEMPLATE=2;config.tiddlerTemplates={1:"ViewTemplate",2:"EditTemplate"},config.views={wikified:{tag:{}},editor:{tagChooser:{}}},config.backstageTasks=["save","importTask","tweak","upgrade","plugins"],config.extensions={},config.macros={today:{},version:{},search:{sizeTextbox:15},tiddler:{},tag:{},tags:{},tagging:{},timeline:{},allTags:{},list:{all:{},missing:{},orphans:{},shadowed:{},touched:{},filter:{}},closeAll:{},permaview:{},saveChanges:{},slider:{},option:{},options:{},newTiddler:{},newJournal:{},tabs:{},gradient:{},message:{},view:{defaultView:"text"},edit:{},tagChooser:{},toolbar:{},plugins:{},refreshDisplay:{},importTiddlers:{},upgrade:{source:"http://tiddlywiki-releases.tiddlyspace.com/upgrade",backupExtension:"pre.core.upgrade"},sync:{},annotations:{}},config.commands={closeTiddler:{},closeOthers:{},editTiddler:{},saveTiddler:{hideReadOnly:!0},cancelTiddler:{},deleteTiddler:{hideReadOnly:!0},permalink:{},references:{type:"popup"},jump:{type:"popup"},syncing:{type:"popup"},fields:{type:"popup"}},config.evaluateMacroParameters="all",config.textPrimitives={upperLetter:"[A-ZÀ-ÞŐŰ]",lowerLetter:"[a-z0-9_\\-ß-ÿőű]",anyLetter:"[A-Za-z0-9_\\-À-Þß-ÿŐŰőű]",anyLetterStrict:"[A-Za-z0-9À-Þß-ÿŐŰőű]"},new RegExp("[ŐŰ]","g").test("Ő")||(config.textPrimitives={upperLetter:"[A-ZÀ-Þ]",lowerLetter:"[a-z0-9_\\-ß-ÿ]",anyLetter:"[A-Za-z0-9_\\-À-Þß-ÿ]",anyLetterStrict:"[A-Za-z0-9À-Þß-ÿ]"}),config.textPrimitives.sliceSeparator="::",config.textPrimitives.sectionSeparator="##",config.textPrimitives.urlPattern="(?:file|http|https|mailto|ftp|irc|news|data):[^\\s'\"]+(?:/|\\b)",config.textPrimitives.unWikiLink="~",config.textPrimitives.wikiLink="(?:(?:"+config.textPrimitives.upperLetter+"+"+config.textPrimitives.lowerLetter+"+"+config.textPrimitives.upperLetter+config.textPrimitives.anyLetter+"*)|(?:"+config.textPrimitives.upperLetter+"{2,}"+config.textPrimitives.lowerLetter+"+))",config.textPrimitives.cssLookahead="(?:("+config.textPrimitives.anyLetter+"+)\\(([^\\)\\|\\n]+)(?:\\):))|(?:("+config.textPrimitives.anyLetter+"+):([^;\\|\\n]+);)",config.textPrimitives.cssLookaheadRegExp=new RegExp(config.textPrimitives.cssLookahead,"mg"),config.textPrimitives.brackettedLink="\\[\\[([^\\]]+)\\]\\]",config.textPrimitives.titledBrackettedLink="\\[\\[([^\\[\\]\\|]+)\\|([^\\[\\]\\|]+)\\]\\]",config.textPrimitives.tiddlerForcedLinkRegExp=new RegExp("(?:"+config.textPrimitives.titledBrackettedLink+")|(?:"+config.textPrimitives.brackettedLink+")|(?:"+config.textPrimitives.urlPattern+")","mg"),config.textPrimitives.tiddlerAnyLinkRegExp=new RegExp("("+config.textPrimitives.wikiLink+")|(?:"+config.textPrimitives.titledBrackettedLink+")|(?:"+config.textPrimitives.brackettedLink+")|(?:"+config.textPrimitives.urlPattern+")","mg"),config.glyphs={currBrowser:null,browsers:[],codes:{}},config.shadowTiddlers={StyleSheet:"",MarkupPreHead:"",MarkupPostHead:"",MarkupPreBody:"",MarkupPostBody:"",TabTimeline:"<<timeline>>",TabAll:"<<list all>>",TabTags:"<<allTags excludeLists>>",TabMoreMissing:"<<list missing>>",TabMoreOrphans:"<<list orphans>>",TabMoreShadowed:"<<list shadowed>>",AdvancedOptions:"<<options>>",PluginManager:"<<plugins>>",SystemSettings:"",ToolbarCommands:"|~ViewToolbar|closeTiddler closeOthers +editTiddler > fields syncing permalink references jump|\n|~EditToolbar|+saveTiddler -cancelTiddler deleteTiddler|",WindowTitle:"<<tiddler SiteTitle>> - <<tiddler SiteSubtitle>>"},config.userAgent=navigator.userAgent.toLowerCase(),config.browser={isIE:-1!=config.userAgent.indexOf("msie")&&-1==config.userAgent.indexOf("opera"),isGecko:"Gecko"==navigator.product&&-1==config.userAgent.indexOf("WebKit"),ieVersion:/MSIE (\d.\d)/i.exec(config.userAgent),isSafari:-1!=config.userAgent.indexOf("applewebkit"),isBadSafari:!new RegExp("[ŐŰ]","g").test("Ő"),firefoxDate:/gecko\/(\d{8})/i.exec(config.userAgent),isOpera:-1!=config.userAgent.indexOf("opera"),isChrome:config.userAgent.indexOf("chrome")>-1,isLinux:-1!=config.userAgent.indexOf("linux"),isUnix:-1!=config.userAgent.indexOf("x11"),isMac:-1!=config.userAgent.indexOf("mac"),isWindows:-1!=config.userAgent.indexOf("win")},merge(config.glyphs,{browsers:[function(){return config.browser.isIE},function(){return!0}],codes:{downTriangle:["▼","▾"],downArrow:["↓","↓"],bentArrowLeft:["←","↩"],bentArrowRight:["→","↪"]}}),merge(config.options,{txtUserName:"YourName"}),merge(config.tasks,{save:{text:"save",tooltip:"Save your changes to this TiddlyWiki"},importTask:{text:"import",tooltip:"Import tiddlers and plugins from other TiddlyWiki files and servers",content:"<<importTiddlers>>"},tweak:{text:"tweak",tooltip:"Tweak the appearance and behaviour of TiddlyWiki",content:"<<options>>"},upgrade:{text:"upgrade",tooltip:"Upgrade TiddlyWiki core code",content:"<<upgrade>>"},plugins:{text:"plugins",tooltip:"Manage installed plugins",content:"<<plugins>>"}}),merge(config.optionsDesc,{txtUserName:"Username for signing your edits",chkRegExpSearch:"Enable regular expressions for searches",chkCaseSensitiveSearch:"Case-sensitive searching",chkIncrementalSearch:"Incremental key-by-key searching",chkAnimate:"Enable animations",chkSaveBackups:"Keep backup file when saving changes",chkAutoSave:"Automatically save changes",chkGenerateAnRssFeed:"Generate an RSS feed when saving changes",chkSaveEmptyTemplate:"Generate an empty template when saving changes",chkOpenInNewWindow:"Open external links in a new window",chkToggleLinks:"Clicking on links to open tiddlers causes them to close",chkHttpReadOnly:"Hide editing features when viewed over HTTP",chkForceMinorUpdate:"Don't update modifier username and date when editing tiddlers",chkConfirmDelete:"Require confirmation before deleting tiddlers",chkInsertTabs:"Use the tab key to insert tab characters instead of moving between fields",txtBackupFolder:"Name of folder to use for backups",txtMaxEditRows:"Maximum number of rows in edit boxes",txtTheme:"Name of the theme to use",txtFileSystemCharSet:"Default character set for saving changes (Firefox/Mozilla only)"}),merge(config.messages,{customConfigError:"Problems were encountered loading plugins. See PluginManager for details",pluginError:"Error: %0",pluginDisabled:"Not executed because disabled via 'systemConfigDisable' tag",pluginForced:"Executed because forced via 'systemConfigForce' tag",pluginVersionError:"Not executed because this plugin needs a newer version of TiddlyWiki",nothingSelected:"Nothing is selected. You must select one or more items first",savedSnapshotError:"It appears that this TiddlyWiki has been incorrectly saved. Please see http://www.tiddlywiki.com/#Download for details",subtitleUnknown:"(unknown)",undefinedTiddlerToolTip:"The tiddler '%0' doesn't yet exist",shadowedTiddlerToolTip:"The tiddler '%0' doesn't yet exist, but has a pre-defined shadow value",tiddlerLinkTooltip:"%0 - %1, %2",externalLinkTooltip:"External link to %0",noTags:"There are no tagged tiddlers",notFileUrlError:"You need to save this TiddlyWiki to a file before you can save changes",cantSaveError:"It's not possible to save changes. Possible reasons include:\n- your browser doesn't support saving (Firefox, Internet Explorer, Safari and Opera all work if properly configured)\n- the pathname to your TiddlyWiki file contains illegal characters\n- the TiddlyWiki HTML file has been moved or renamed",invalidFileError:"The original file '%0' does not appear to be a valid TiddlyWiki",backupSaved:"Backup saved",backupFailed:"Failed to save backup file",rssSaved:"RSS feed saved",rssFailed:"Failed to save RSS feed file",emptySaved:"Empty template saved",emptyFailed:"Failed to save empty template file",mainSaved:"Main TiddlyWiki file saved",mainFailed:"Failed to save main TiddlyWiki file. Your changes have not been saved",macroError:"Error in macro <<%0>>",macroErrorDetails:"Error while executing macro <<%0>>:\n%1",missingMacro:"No such macro",overwriteWarning:"A tiddler named '%0' already exists. Choose OK to overwrite it",unsavedChangesWarning:"WARNING! There are unsaved changes in TiddlyWiki\n\nChoose OK to save\nChoose CANCEL to discard",confirmExit:"--------------------------------\n\nThere are unsaved changes in TiddlyWiki. If you continue you will lose those changes\n\n--------------------------------",saveInstructions:"SaveChanges",unsupportedTWFormat:"Unsupported TiddlyWiki format '%0'",tiddlerSaveError:"Error when saving tiddler '%0'",tiddlerLoadError:"Error when loading tiddler '%0'",wrongSaveFormat:"Cannot save with storage format '%0'. Using standard format for save.",invalidFieldName:"Invalid field name %0",fieldCannotBeChanged:"Field '%0' cannot be changed",loadingMissingTiddler:"Attempting to retrieve the tiddler '%0' from the '%1' server at:\n\n'%2' in the workspace '%3'",upgradeDone:"The upgrade to version %0 is now complete\n\nClick 'OK' to reload the newly upgraded TiddlyWiki",invalidCookie:"Invalid cookie '%0'"}),merge(config.messages.messageClose,{text:"close",tooltip:"close this message area"}),config.messages.backstage={open:{text:"backstage",tooltip:"Open the backstage area to perform authoring and editing tasks"},close:{text:"close",tooltip:"Close the backstage area"},prompt:"backstage: ",decal:{edit:{text:"edit",tooltip:"Edit the tiddler '%0'"}}},config.messages.listView={tiddlerTooltip:"Click for the full text of this tiddler",previewUnavailable:"(preview not available)"},config.messages.dates.months=["January","February","March","April","May","June","July","August","September","October","November","December"],config.messages.dates.days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],config.messages.dates.shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],config.messages.dates.shortDays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],config.messages.dates.daySuffixes=["st","nd","rd","th","th","th","th","th","th","th","th","th","th","th","th","th","th","th","th","th","st","nd","rd","th","th","th","th","th","th","th","st"],config.messages.dates.am="am",config.messages.dates.pm="pm",merge(config.messages.tiddlerPopup,{}),merge(config.views.wikified.tag,{labelNoTags:"no tags",labelTags:"tags: ",openTag:"Open tag '%0'",tooltip:"Show tiddlers tagged with '%0'",openAllText:"Open all",openAllTooltip:"Open all of these tiddlers",popupNone:"No other tiddlers tagged with '%0'"}),merge(config.views.wikified,{defaultText:"The tiddler '%0' doesn't yet exist. Double-click to create it",defaultModifier:"(missing)",shadowModifier:"(built-in shadow tiddler)",dateFormat:"DD MMM YYYY",createdPrompt:"created"}),merge(config.views.editor,{tagPrompt:"Type tags separated with spaces, [[use double square brackets]] if necessary, or add existing",defaultText:"Type the text for '%0'"}),merge(config.views.editor.tagChooser,{text:"tags",tooltip:"Choose existing tags to add to this tiddler",popupNone:"There are no tags defined",tagTooltip:"Add the tag '%0'"}),merge(config.messages,{sizeTemplates:[{unit:1073741824,template:"%0 GB"},{unit:1048576,template:"%0 MB"},{unit:1024,template:"%0 KB"},{unit:1,template:"%0 B"}]}),merge(config.macros.search,{label:"search",prompt:"Search this TiddlyWiki",placeholder:"",accessKey:"F",successMsg:"%0 tiddlers found matching %1",failureMsg:"No tiddlers found matching %0"}),merge(config.macros.tagging,{label:"Tiddlers tagged with '%0'",labelNotTag:"No tiddlers tagged with '%0'",tooltip:"List of tiddlers tagged with '%0'"}),merge(config.macros.timeline,{dateFormat:"DD MMM YYYY"}),merge(config.macros.allTags,{tooltip:"Show tiddlers tagged with '%0'",noTags:"There are no tagged tiddlers"}),config.macros.list.all.prompt="All tiddlers in alphabetical order",config.macros.list.missing.prompt="Tiddlers that have links to them but are not defined",config.macros.list.orphans.prompt="Tiddlers that are not linked to from any other tiddlers",config.macros.list.shadowed.prompt="Tiddlers shadowed with default contents",config.macros.list.touched.prompt="Tiddlers that have been modified locally",merge(config.macros.closeAll,{label:"close all",prompt:"Close all displayed tiddlers (except any that are being edited)"}),merge(config.macros.permaview,{label:"permaview",prompt:"Link to an URL that retrieves all the currently displayed tiddlers"}),merge(config.macros.saveChanges,{label:"save changes",prompt:"Save all tiddlers to create a new TiddlyWiki",accessKey:"S"}),merge(config.macros.newTiddler,{label:"new tiddler",prompt:"Create a new tiddler",title:"New Tiddler",accessKey:"N"}),merge(config.macros.newJournal,{label:"new journal",prompt:"Create a new tiddler from the current date and time",accessKey:"J"}),merge(config.macros.options,{wizardTitle:"Tweak advanced options",step1Title:"These options are saved in cookies in your browser",step1Html:"<input type='hidden' name='markList'></input><br><input type='checkbox' checked='false' name='chkUnknown'>Show unknown options</input>",unknownDescription:"//(unknown)//",listViewTemplate:{columns:[{name:"Option",field:"option",title:"Option",type:"String"},{name:"Description",field:"description",title:"Description",type:"WikiText"},{name:"Name",field:"name",title:"Name",type:"String"}],rowClasses:[{className:"lowlight",field:"lowlight"}]}}),merge(config.macros.plugins,{wizardTitle:"Manage plugins",step1Title:"Currently loaded plugins",step1Html:"<input type='hidden' name='markList'></input>",skippedText:"(This plugin has not been executed because it was added since startup)",noPluginText:"There are no plugins installed",confirmDeleteText:"Are you sure you want to delete these plugins:\n\n%0",removeLabel:"remove systemConfig tag",removePrompt:"Remove systemConfig tag",deleteLabel:"delete",deletePrompt:"Delete these tiddlers forever",listViewTemplate:{columns:[{name:"Selected",field:"Selected",rowName:"title",type:"Selector"},{name:"Tiddler",field:"tiddler",title:"Tiddler",type:"Tiddler"},{name:"Description",field:"Description",title:"Description",type:"String"},{name:"Version",field:"Version",title:"Version",type:"String"},{name:"Size",field:"size",tiddlerLink:"size",title:"Size",type:"Size"},{name:"Forced",field:"forced",title:"Forced",tag:"systemConfigForce",type:"TagCheckbox"},{name:"Disabled",field:"disabled",title:"Disabled",tag:"systemConfigDisable",type:"TagCheckbox"},{name:"Executed",field:"executed",title:"Loaded",type:"Boolean",trueText:"Yes",falseText:"No"},{name:"Startup Time",field:"startupTime",title:"Startup Time",type:"String"},{name:"Error",field:"error",title:"Status",type:"Boolean",trueText:"Error",falseText:"OK"},{name:"Log",field:"log",title:"Log",type:"StringList"}],rowClasses:[{className:"error",field:"error"},{className:"warning",field:"warning"}]},listViewTemplateReadOnly:{columns:[{name:"Tiddler",field:"tiddler",title:"Tiddler",type:"Tiddler"},{name:"Description",field:"Description",title:"Description",type:"String"},{name:"Version",field:"Version",title:"Version",type:"String"},{name:"Size",field:"size",tiddlerLink:"size",title:"Size",type:"Size"},{name:"Executed",field:"executed",title:"Loaded",type:"Boolean",trueText:"Yes",falseText:"No"},{name:"Startup Time",field:"startupTime",title:"Startup Time",type:"String"},{name:"Error",field:"error",title:"Status",type:"Boolean",trueText:"Error",falseText:"OK"},{name:"Log",field:"log",title:"Log",type:"StringList"}],rowClasses:[{className:"error",field:"error"},{className:"warning",field:"warning"}]}}),merge(config.macros.toolbar,{moreLabel:"more",morePrompt:"Show additional commands",lessLabel:"less",lessPrompt:"Hide additional commands",separator:"|"}),merge(config.macros.refreshDisplay,{label:"refresh",prompt:"Redraw the entire TiddlyWiki display"}),merge(config.macros.importTiddlers,{readOnlyWarning:"You cannot import into a read-only TiddlyWiki file. Try opening it from a file:// URL",wizardTitle:"Import tiddlers from another file or server",step1Title:"Step 1: Locate the server or TiddlyWiki file",step1Html:"Specify the type of the server: <select name='selTypes'><option value=''>Choose...</option></select><br>Enter the URL or pathname here: <input type='text' size=50 name='txtPath'><br>...or browse for a file: <input type='file' size=50 name='txtBrowse'><br><hr>...or select a pre-defined feed: <select name='selFeeds'><option value=''>Choose...</option></select>",openLabel:"open",openPrompt:"Open the connection to this file or server",statusOpenHost:"Opening the host",statusGetWorkspaceList:"Getting the list of available workspaces",step2Title:"Step 2: Choose the workspace",step2Html:"Enter a workspace name: <input type='text' size=50 name='txtWorkspace'><br>...or select a workspace: <select name='selWorkspace'><option value=''>Choose...</option></select>",cancelLabel:"cancel",cancelPrompt:"Cancel this import",statusOpenWorkspace:"Opening the workspace",statusGetTiddlerList:"Getting the list of available tiddlers",errorGettingTiddlerList:"Error getting list of tiddlers, click Cancel to try again",errorGettingTiddlerListHttp404:"Error retrieving tiddlers from url, please ensure the url exists. Click Cancel to try again.",errorGettingTiddlerListHttp:"Error retrieving tiddlers from url, please ensure this url exists and is <a href='http://enable-cors.org/'>CORS</a> enabled",errorGettingTiddlerListFile:"Error retrieving tiddlers from local file, please make sure the file is in the same directory as your TiddlyWiki. Click Cancel to try again.",step3Title:"Step 3: Choose the tiddlers to import",step3Html:"<input type='hidden' name='markList'></input><br><input type='checkbox' checked='true' name='chkSync'>Keep these tiddlers linked to this server so that you can synchronise subsequent changes</input><br><input type='checkbox' name='chkSave'>Save the details of this server in a 'systemServer' tiddler called:</input> <input type='text' size=25 name='txtSaveTiddler'>",importLabel:"import",importPrompt:"Import these tiddlers",confirmOverwriteText:"Are you sure you want to overwrite these tiddlers:\n\n%0",step4Title:"Step 4: Importing %0 tiddler(s)",step4Html:"<input type='hidden' name='markReport'></input>",doneLabel:"done",donePrompt:"Close this wizard",statusDoingImport:"Importing tiddlers",statusDoneImport:"All tiddlers imported",systemServerNamePattern:"%2 on %1",systemServerNamePatternNoWorkspace:"%1",confirmOverwriteSaveTiddler:"The tiddler '%0' already exists. Click 'OK' to overwrite it with the details of this server, or 'Cancel' to leave it unchanged",serverSaveTemplate:"|''Type:''|%0|\n|''URL:''|%1|\n|''Workspace:''|%2|\n\nThis tiddler was automatically created to record the details of this server",serverSaveModifier:"(System)",listViewTemplate:{columns:[{name:"Selected",field:"Selected",rowName:"title",type:"Selector"},{name:"Tiddler",field:"tiddler",title:"Tiddler",type:"Tiddler"},{name:"Size",field:"size",tiddlerLink:"size",title:"Size",type:"Size"},{name:"Tags",field:"tags",title:"Tags",type:"Tags"}],rowClasses:[]}}),merge(config.macros.upgrade,{wizardTitle:"Upgrade TiddlyWiki core code",step1Title:"Update or repair this TiddlyWiki to the latest release",step1Html:"You are about to upgrade to the latest release of the TiddlyWiki core code (from <a href='%0' class='externalLink' target='_blank'>%1</a>). Your content will be preserved across the upgrade.<br><br>Note that core upgrades have been known to interfere with older plugins. If you run into problems with the upgraded file, see <a href='http://www.tiddlywiki.org/wiki/CoreUpgrades' class='externalLink' target='_blank'>http://www.tiddlywiki.org/wiki/CoreUpgrades</a>",errorCantUpgrade:"Unable to upgrade this TiddlyWiki. You can only perform upgrades on TiddlyWiki files stored locally",errorNotSaved:"You must save changes before you can perform an upgrade",step2Title:"Confirm the upgrade details",step2Html_downgrade:"You are about to downgrade to TiddlyWiki version %0 from %1.<br><br>Downgrading to an earlier version of the core code is not recommended",step2Html_restore:"This TiddlyWiki appears to be already using the latest version of the core code (%0).<br><br>You can continue to upgrade anyway to ensure that the core code hasn't been corrupted or damaged",step2Html_upgrade:"You are about to upgrade to TiddlyWiki version %0 from %1",upgradeLabel:"upgrade",upgradePrompt:"Prepare for the upgrade process",statusPreparingBackup:"Preparing backup",statusSavingBackup:"Saving backup file",errorSavingBackup:"There was a problem saving the backup file",statusLoadingCore:"Loading core code",errorLoadingCore:"Error loading the core code",errorCoreFormat:"Error with the new core code",statusSavingCore:"Saving the new core code",statusReloadingCore:"Reloading the new core code",startLabel:"start",startPrompt:"Start the upgrade process",cancelLabel:"cancel",cancelPrompt:"Cancel the upgrade process",step3Title:"Upgrade cancelled",step3Html:"You have cancelled the upgrade process"}),merge(config.macros.annotations,{}),merge(config.commands.closeTiddler,{text:"close",tooltip:"Close this tiddler"}),merge(config.commands.closeOthers,{text:"close others",tooltip:"Close all other tiddlers"}),merge(config.commands.editTiddler,{text:"edit",tooltip:"Edit this tiddler",readOnlyText:"view",readOnlyTooltip:"View the source of this tiddler"}),merge(config.commands.saveTiddler,{text:"done",tooltip:"Save changes to this tiddler"}),merge(config.commands.cancelTiddler,{text:"cancel",tooltip:"Undo changes to this tiddler",warning:"Are you sure you want to abandon your changes to '%0'?",readOnlyText:"done",readOnlyTooltip:"View this tiddler normally"}),merge(config.commands.deleteTiddler,{text:"delete",tooltip:"Delete this tiddler",warning:"Are you sure you want to delete '%0'?"}),merge(config.commands.permalink,{text:"permalink",tooltip:"Permalink for this tiddler"}),merge(config.commands.references,{text:"references",tooltip:"Show tiddlers that link to this one",popupNone:"No references"}),merge(config.commands.jump,{text:"jump",tooltip:"Jump to another open tiddler"}),merge(config.commands.fields,{text:"fields",tooltip:"Show the extended fields of this tiddler",emptyText:"There are no extended fields for this tiddler",listViewTemplate:{columns:[{name:"Field",field:"field",title:"Field",type:"String"},{name:"Value",field:"value",title:"Value",type:"String"}],rowClasses:[],buttons:[]}}),merge(config.shadowTiddlers,{DefaultTiddlers:"[[GettingStarted]]",MainMenu:"[[GettingStarted]]",SiteTitle:"My TiddlyWiki",SiteSubtitle:"a reusable non-linear personal web notebook",SiteUrl:"",SideBarOptions:'<<search>><<closeAll>><<permaview>><<newTiddler>><<newJournal "DD MMM YYYY" "journal">><<saveChanges>><<slider chkSliderOptionsPanel OptionsPanel "options »" "Change TiddlyWiki advanced options">>',SideBarTabs:'<<tabs txtMainTab "Timeline" "Timeline" TabTimeline "All" "All tiddlers" TabAll "Tags" "All tags" TabTags "More" "More lists" TabMore>>',TabMore:'<<tabs txtMoreTab "Missing" "Missing tiddlers" TabMoreMissing "Orphans" "Orphaned tiddlers" TabMoreOrphans "Shadowed" "Shadowed tiddlers" TabMoreShadowed>>'}),merge(config.annotations,{AdvancedOptions:"This shadow tiddler provides access to several advanced options",ColorPalette:"These values in this shadow tiddler determine the colour scheme of the ~TiddlyWiki user interface",DefaultTiddlers:"The tiddlers listed in this shadow tiddler will be automatically displayed when ~TiddlyWiki starts up",EditTemplate:"The HTML template in this shadow tiddler determines how tiddlers look while they are being edited",GettingStarted:"This shadow tiddler provides basic usage instructions",ImportTiddlers:"This shadow tiddler provides access to importing tiddlers",MainMenu:"This shadow tiddler is used as the contents of the main menu in the left-hand column of the screen",MarkupPreHead:"This tiddler is inserted at the top of the <head> section of the TiddlyWiki HTML file",MarkupPostHead:"This tiddler is inserted at the bottom of the <head> section of the TiddlyWiki HTML file",MarkupPreBody:"This tiddler is inserted at the top of the <body> section of the TiddlyWiki HTML file",MarkupPostBody:"This tiddler is inserted at the end of the <body> section of the TiddlyWiki HTML file immediately after the script block",OptionsPanel:"This shadow tiddler is used as the contents of the options panel slider in the right-hand sidebar",PageTemplate:"The HTML template in this shadow tiddler determines the overall ~TiddlyWiki layout",PluginManager:"This shadow tiddler provides access to the plugin manager",SideBarOptions:"This shadow tiddler is used as the contents of the option panel in the right-hand sidebar",SideBarTabs:"This shadow tiddler is used as the contents of the tabs panel in the right-hand sidebar",SiteSubtitle:"This shadow tiddler is used as the second part of the page title",SiteTitle:"This shadow tiddler is used as the first part of the page title",SiteUrl:"This shadow tiddler should be set to the full target URL for publication",StyleSheetColors:"This shadow tiddler contains CSS definitions related to the color of page elements. ''DO NOT EDIT THIS TIDDLER'', instead make your changes in the StyleSheet shadow tiddler",StyleSheet:"This tiddler can contain custom CSS definitions",StyleSheetLayout:"This shadow tiddler contains CSS definitions related to the layout of page elements. ''DO NOT EDIT THIS TIDDLER'', instead make your changes in the StyleSheet shadow tiddler",StyleSheetLocale:"This shadow tiddler contains CSS definitions related to the translation locale",StyleSheetPrint:"This shadow tiddler contains CSS definitions for printing",SystemSettings:"This tiddler is used to store configuration options for this TiddlyWiki document",TabAll:"This shadow tiddler contains the contents of the 'All' tab in the right-hand sidebar",TabMore:"This shadow tiddler contains the contents of the 'More' tab in the right-hand sidebar",TabMoreMissing:"This shadow tiddler contains the contents of the 'Missing' tab in the right-hand sidebar",TabMoreOrphans:"This shadow tiddler contains the contents of the 'Orphans' tab in the right-hand sidebar",TabMoreShadowed:"This shadow tiddler contains the contents of the 'Shadowed' tab in the right-hand sidebar",TabTags:"This shadow tiddler contains the contents of the 'Tags' tab in the right-hand sidebar",TabTimeline:"This shadow tiddler contains the contents of the 'Timeline' tab in the right-hand sidebar",ToolbarCommands:"This shadow tiddler determines which commands are shown in tiddler toolbars",ViewTemplate:"The HTML template in this shadow tiddler determines how tiddlers look"});
var params=null,store=null,story=null,formatter=null,anim="function"==typeof Animator?new Animator:null,readOnly=!1,highlightHack=null,hadConfirmExit=!1,safeMode=!1,showBackstage,installedPlugins=[],startingUp=!1,pluginInfo,tiddler;window.allowSave=window.allowSave||function(){return"file:"==document.location.protocol};var useJavaSaver=window.allowSave()&&(config.browser.isSafari||config.browser.isOpera);window.tweakConfig&&window.tweakConfig(),window&&window.console||(console={tiddlywiki:!0,log:function(e){displayMessage(e)}}),config.paramifiers={},config.paramifiers.start={oninit:function(e){safeMode="safe"==e.toLowerCase()}},config.paramifiers.open={onstart:function(e){(!readOnly||store.tiddlerExists(e)||store.isShadowTiddler(e))&&story.displayTiddler("bottom",e,null,!1,null)}},config.paramifiers.story={onstart:function(e){var t=store.getTiddlerText(e,"").parseParams("open",null,!1);invokeParamifier(t,"onstart")}},config.paramifiers.search={onstart:function(e){story.search(e,!1,!1)}},config.paramifiers.searchRegExp={onstart:function(e){story.prototype.search(e,!1,!0)}},config.paramifiers.tag={onstart:function(e){story.displayTiddlers(null,store.filterTiddlers("[tag["+e+"]]"),null,!1,null)}},config.paramifiers.newTiddler={onstart:function(e){var t=e.parseParams("anon",null,null)[0],i=t.title?t.title[0]:e,r=t.fields?t.fields[0]:null;if(!readOnly){story.displayTiddler(null,i,DEFAULT_EDIT_TEMPLATE,!1,null,r),story.focusTiddler(i,"text");var n,o=t.tag||[];for(n=0;n<o.length;n++)story.setTiddlerTag(i,o[n],1)}}},config.paramifiers.newJournal={onstart:function(e){if(!readOnly){var t=new Date,i=t.formatString(e.trim());story.displayTiddler(null,i,DEFAULT_EDIT_TEMPLATE),story.focusTiddler(i,"text")}}},config.paramifiers.readOnly={onconfig:function(e){var t=e.toLowerCase();readOnly="yes"==t?!0:"no"==t?!1:readOnly}},config.paramifiers.theme={onconfig:function(e){story.switchTheme(e)}},config.paramifiers.upgrade={onstart:function(e){upgradeFrom(e)}},config.paramifiers.recent={onstart:function(e){var t,i=[],r=store.getTiddlers("modified","excludeLists").reverse();for(t=0;e>t&&t<r.length;t++)i.push(r[t].title);story.displayTiddlers(null,i)}},config.paramifiers.filter={onstart:function(e){story.displayTiddlers(null,store.filterTiddlers(e),null,!1)}},config.formatterHelpers={createElementAndWikify:function(e){e.subWikifyTerm(createTiddlyElement(e.output,this.element),this.termRegExp)},inlineCssHelper:function(e){var t=[];config.textPrimitives.cssLookaheadRegExp.lastIndex=e.nextMatch;for(var i=config.textPrimitives.cssLookaheadRegExp.exec(e.source);i&&i.index==e.nextMatch;){var r,n;i[1]?(r=i[1].unDash(),n=i[2]):(r=i[3].unDash(),n=i[4]),"bgcolor"==r&&(r="backgroundColor"),"float"==r&&(r="cssFloat"),t.push({style:r,value:n}),e.nextMatch=i.index+i[0].length,config.textPrimitives.cssLookaheadRegExp.lastIndex=e.nextMatch,i=config.textPrimitives.cssLookaheadRegExp.exec(e.source)}return t},applyCssHelper:function(e,t){var i;for(i=0;i<t.length;i++)try{e.style[t[i].style]=t[i].value}catch(r){}},enclosedTextHelper:function(e){this.lookaheadRegExp.lastIndex=e.matchStart;var t=this.lookaheadRegExp.exec(e.source);if(t&&t.index==e.matchStart){var i=t[1];config.browser.isIE&&(i=i.replace(/\n/g,"\r")),createTiddlyElement(e.output,this.element,null,null,i),e.nextMatch=t.index+t[0].length}},isExternalLink:function(e){if(store.tiddlerExists(e)||store.isShadowTiddler(e))return!1;var t=new RegExp(config.textPrimitives.urlPattern,"mg");return t.exec(e)?!0:-1!=e.indexOf(".")||-1!=e.indexOf("\\")||-1!=e.indexOf("/")||-1!=e.indexOf("#")?!0:!1}},config.formatters=[{name:"table",match:"^\\|(?:[^\\n]*)\\|(?:[fhck]?)$",lookaheadRegExp:/^\|([^\n]*)\|([fhck]?)$/gm,rowTermRegExp:/(\|(?:[fhck]?)$\n?)/gm,cellRegExp:/(?:\|([^\n\|]*)\|)|(\|[fhck]?$\n?)/gm,cellTermRegExp:/((?:\x20*)\|)/gm,rowTypes:{c:"caption",h:"thead","":"tbody",f:"tfoot"},handler:function(e){var t,i=createTiddlyElement(e.output,"table",null,"twtable"),r=[],n=null,o=0,a=function(){jQuery(this).addClass("hoverRow")},s=function(){jQuery(this).removeClass("hoverRow")};e.nextMatch=e.matchStart,this.lookaheadRegExp.lastIndex=e.nextMatch;for(var l=this.lookaheadRegExp.exec(e.source);l&&l.index==e.nextMatch;){var d=l[2];if("k"==d)i.className=l[1],e.nextMatch+=l[0].length+1;else if(d!=n&&(t=createTiddlyElement(i,this.rowTypes[d]),n=d),"c"==n)e.nextMatch++,t!=i.firstChild&&i.insertBefore(t,i.firstChild),t.setAttribute("align",0==o?"top":"bottom"),e.subWikifyTerm(t,this.rowTermRegExp);else{var c=createTiddlyElement(t,"tr",null,o%2?"oddRow":"evenRow");c.onmouseover=a,c.onmouseout=s,this.rowHandler(e,c,r),o++}this.lookaheadRegExp.lastIndex=e.nextMatch,l=this.lookaheadRegExp.exec(e.source)}},rowHandler:function(e,t,i){var r=0,n=1,o=null;this.cellRegExp.lastIndex=e.nextMatch;for(var a=this.cellRegExp.exec(e.source);a&&a.index==e.nextMatch;){if("~"==a[1]){var s=i[r];s&&(s.rowSpanCount++,s.element.setAttribute("rowspan",s.rowSpanCount),s.element.setAttribute("rowSpan",s.rowSpanCount),s.element.valign="center",n>1&&(s.element.setAttribute("colspan",n),s.element.setAttribute("colSpan",n),n=1)),e.nextMatch=this.cellRegExp.lastIndex-1}else if(">"==a[1])n++,e.nextMatch=this.cellRegExp.lastIndex-1;else{if(a[2]){o&&n>1&&(o.setAttribute("colspan",n),o.setAttribute("colSpan",n)),e.nextMatch=this.cellRegExp.lastIndex;break}e.nextMatch++;for(var l=config.formatterHelpers.inlineCssHelper(e),d=!1,c=e.source.substr(e.nextMatch,1);" "==c;)d=!0,e.nextMatch++,c=e.source.substr(e.nextMatch,1);var u;"!"==c?(u=createTiddlyElement(t,"th"),e.nextMatch++):u=createTiddlyElement(t,"td"),o=u,i[r]={rowSpanCount:1,element:u},n>1&&(u.setAttribute("colspan",n),u.setAttribute("colSpan",n),n=1),config.formatterHelpers.applyCssHelper(u,l),e.subWikifyTerm(u,this.cellTermRegExp)," "==e.matchText.substr(e.matchText.length-2,1)?u.align=d?"center":"left":d&&(u.align="right"),e.nextMatch--}r++,this.cellRegExp.lastIndex=e.nextMatch,a=this.cellRegExp.exec(e.source)}}},{name:"heading",match:"^!{1,6}",termRegExp:/(\n)/gm,handler:function(e){e.subWikifyTerm(createTiddlyElement(e.output,"h"+e.matchLength),this.termRegExp)}},{name:"list",match:"^(?:[\\*#;:]+)",lookaheadRegExp:/^(?:(?:(\*)|(#)|(;)|(:))+)/gm,termRegExp:/(\n)/gm,handler:function(e){var t,i,r,n,o=[e.output],a=0,s=null;e.nextMatch=e.matchStart,this.lookaheadRegExp.lastIndex=e.nextMatch;for(var l=this.lookaheadRegExp.exec(e.source);l&&l.index==e.nextMatch;){l[1]?(i="ul",r="li"):l[2]?(i="ol",r="li"):l[3]?(i="dl",r="dt"):l[4]&&(i="dl",r="dd"),n||(n=i),t=l[0].length,e.nextMatch+=l[0].length;var d;if(t>a)for(d=a;t>d;d++){var c=0==a?o[o.length-1]:o[o.length-1].lastChild;o.push(createTiddlyElement(c,i))}else{if(i!=n&&1==t)return void(e.nextMatch-=l[0].length);if(a>t)for(d=a;d>t;d--)o.pop();else t==a&&i!=s&&(o.pop(),o.push(createTiddlyElement(o[o.length-1].lastChild,i)))}a=t,s=i;var u=createTiddlyElement(o[o.length-1],r);e.subWikifyTerm(u,this.termRegExp),this.lookaheadRegExp.lastIndex=e.nextMatch,l=this.lookaheadRegExp.exec(e.source)}}},{name:"quoteByBlock",match:"^<<<\\n",termRegExp:/(^<<<(\n|$))/gm,element:"blockquote",handler:config.formatterHelpers.createElementAndWikify},{name:"quoteByLine",match:"^>+",lookaheadRegExp:/^>+/gm,termRegExp:/(\n)/gm,element:"blockquote",handler:function(e){var t,i,r=[e.output],n=0,o=e.matchLength;do{if(o>n)for(t=n;o>t;t++)r.push(createTiddlyElement(r[r.length-1],this.element));else if(n>o)for(t=n;t>o;t--)r.pop();n=o,e.subWikifyTerm(r[r.length-1],this.termRegExp),createTiddlyElement(r[r.length-1],"br"),this.lookaheadRegExp.lastIndex=e.nextMatch;var a=this.lookaheadRegExp.exec(e.source);i=a&&a.index==e.nextMatch,i&&(o=a[0].length,e.nextMatch+=a[0].length)}while(i)}},{name:"rule",match:"^----+$\\n?|<hr ?/?>\\n?",handler:function(e){createTiddlyElement(e.output,"hr")}},{name:"monospacedByLine",match:"^(?:/\\*\\{\\{\\{\\*/|\\{\\{\\{|//\\{\\{\\{|<!--\\{\\{\\{-->)\\n",element:"pre",handler:function(e){switch(e.matchText){case"/*{{{*/\n":this.lookaheadRegExp=/\/\*\{\{\{\*\/\n*((?:^[^\n]*\n)+?)(\n*^\f*\/\*\}\}\}\*\/$\n?)/gm;break;case"{{{\n":this.lookaheadRegExp=/^\{\{\{\n((?:^[^\n]*\n)+?)(^\f*\}\}\}$\n?)/gm;break;case"//{{{\n":this.lookaheadRegExp=/^\/\/\{\{\{\n\n*((?:^[^\n]*\n)+?)(\n*^\f*\/\/\}\}\}$\n?)/gm;break;case"<!--{{{-->\n":this.lookaheadRegExp=/<!--\{\{\{-->\n*((?:^[^\n]*\n)+?)(\n*^\f*<!--\}\}\}-->$\n?)/gm}config.formatterHelpers.enclosedTextHelper.call(this,e)}},{name:"wikifyComment",match:"^(?:/\\*\\*\\*|<!---)\\n",handler:function(e){var t="/***\n"==e.matchText?/(^\*\*\*\/\n)/gm:/(^--->\n)/gm;e.subWikifyTerm(e.output,t)}},{name:"macro",match:"<<",lookaheadRegExp:/<<([^>\s]+)(?:\s*)((?:[^>]|(?:>(?!>)))*)>>/gm,handler:function(e){this.lookaheadRegExp.lastIndex=e.matchStart;var t=this.lookaheadRegExp.exec(e.source);t&&t.index==e.matchStart&&t[1]&&(e.nextMatch=this.lookaheadRegExp.lastIndex,invokeMacro(e.output,t[1],t[2],e,e.tiddler))}},{name:"prettyLink",match:"\\[\\[",lookaheadRegExp:/\[\[(.*?)(?:\|(~)?(.*?))?\]\]/gm,handler:function(e){this.lookaheadRegExp.lastIndex=e.matchStart;var t=this.lookaheadRegExp.exec(e.source);if(t&&t.index==e.matchStart){var i,r=t[1];if(t[3]){var n=t[3];i=!t[2]&&config.formatterHelpers.isExternalLink(n)?createExternalLink(e.output,n):createTiddlyLink(e.output,n,!1,null,e.isStatic,e.tiddler)}else i=createTiddlyLink(e.output,r,!1,null,e.isStatic,e.tiddler);createTiddlyText(i,r),e.nextMatch=this.lookaheadRegExp.lastIndex}}},{name:"wikiLink",match:config.textPrimitives.unWikiLink+"?"+config.textPrimitives.wikiLink,handler:function(e){if(e.matchText.substr(0,1)==config.textPrimitives.unWikiLink)return void e.outputText(e.output,e.matchStart+1,e.nextMatch);if(e.matchStart>0){var t=new RegExp(config.textPrimitives.anyLetterStrict,"mg");t.lastIndex=e.matchStart-1;var i=t.exec(e.source);if(i.index==e.matchStart-1)return void e.outputText(e.output,e.matchStart,e.nextMatch)}if(e.autoLinkWikiWords||store.isShadowTiddler(e.matchText)){var r=createTiddlyLink(e.output,e.matchText,!1,null,e.isStatic,e.tiddler);e.outputText(r,e.matchStart,e.nextMatch)}else e.outputText(e.output,e.matchStart,e.nextMatch)}},{name:"urlLink",match:config.textPrimitives.urlPattern,handler:function(e){e.outputText(createExternalLink(e.output,e.matchText),e.matchStart,e.nextMatch)}},{name:"image",match:"\\[[<>]?[Ii][Mm][Gg]\\[",lookaheadRegExp:/\[([<]?)(>?)[Ii][Mm][Gg]\[(?:([^\|\]]+)\|)?([^\[\]\|]+)\](?:\[([^\]]*)\])?\]/gm,handler:function(e){this.lookaheadRegExp.lastIndex=e.matchStart;var t=this.lookaheadRegExp.exec(e.source);if(t&&t.index==e.matchStart){var i=e.output;if(t[5]){var r=t[5];i=config.formatterHelpers.isExternalLink(r)?createExternalLink(e.output,r):createTiddlyLink(e.output,r,!1,null,e.isStatic,e.tiddler),jQuery(i).addClass("imageLink")}var n=createTiddlyElement(i,"img");t[1]?n.align="left":t[2]&&(n.align="right"),t[3]&&(n.title=t[3],n.setAttribute("alt",t[3])),n.src=t[4],e.nextMatch=this.lookaheadRegExp.lastIndex}}},{name:"html",match:"<[Hh][Tt][Mm][Ll]>",lookaheadRegExp:/<[Hh][Tt][Mm][Ll]>((?:.|\n)*?)<\/[Hh][Tt][Mm][Ll]>/gm,handler:function(e){this.lookaheadRegExp.lastIndex=e.matchStart;var t=this.lookaheadRegExp.exec(e.source);t&&t.index==e.matchStart&&(createTiddlyElement(e.output,"span").innerHTML=t[1],e.nextMatch=this.lookaheadRegExp.lastIndex)}},{name:"commentByBlock",match:"/%",lookaheadRegExp:/\/%((?:.|\n)*?)%\//gm,handler:function(e){this.lookaheadRegExp.lastIndex=e.matchStart;var t=this.lookaheadRegExp.exec(e.source);t&&t.index==e.matchStart&&(e.nextMatch=this.lookaheadRegExp.lastIndex)}},{name:"characterFormat",match:"''|//|__|\\^\\^|~~|--(?!\\s|$)|\\{\\{\\{",handler:function(e){switch(e.matchText){case"''":e.subWikifyTerm(e.output.appendChild(document.createElement("strong")),/('')/gm);break;case"//":e.subWikifyTerm(createTiddlyElement(e.output,"em"),/(\/\/)/gm);break;case"__":e.subWikifyTerm(createTiddlyElement(e.output,"u"),/(__)/gm);break;case"^^":e.subWikifyTerm(createTiddlyElement(e.output,"sup"),/(\^\^)/gm);break;case"~~":e.subWikifyTerm(createTiddlyElement(e.output,"sub"),/(~~)/gm);break;case"--":e.subWikifyTerm(createTiddlyElement(e.output,"strike"),/(--)/gm);break;case"{{{":var t=/\{\{\{((?:.|\n)*?)\}\}\}/gm;t.lastIndex=e.matchStart;var i=t.exec(e.source);i&&i.index==e.matchStart&&(createTiddlyElement(e.output,"code",null,null,i[1]),e.nextMatch=t.lastIndex)}}},{name:"customFormat",match:"@@|\\{\\{",handler:function(e){switch(e.matchText){case"@@":var t=createTiddlyElement(e.output,"span"),i=config.formatterHelpers.inlineCssHelper(e);0==i.length?t.className="marked":config.formatterHelpers.applyCssHelper(t,i),e.subWikifyTerm(t,/(@@)/gm);break;case"{{":var r=/\{\{[\s]*([\w]+[\s\w]*)[\s]*\{(\n?)/gm;r.lastIndex=e.matchStart;var n=r.exec(e.source);n&&(e.nextMatch=r.lastIndex,t=createTiddlyElement(e.output,"\n"==n[2]?"div":"span",null,n[1]),e.subWikifyTerm(t,/(\}\}\})/gm))}}},{name:"mdash",match:"--",handler:function(e){createTiddlyElement(e.output,"span").innerHTML="&mdash;"}},{name:"lineBreak",match:"\\n|<br ?/?>",handler:function(e){createTiddlyElement(e.output,"br")}},{name:"rawText",match:'"{3}|<nowiki>',lookaheadRegExp:/(?:\"{3}|<nowiki>)((?:.|\n)*?)(?:\"{3}|<\/nowiki>)/gm,handler:function(e){this.lookaheadRegExp.lastIndex=e.matchStart;var t=this.lookaheadRegExp.exec(e.source);t&&t.index==e.matchStart&&(createTiddlyElement(e.output,"span",null,null,t[1]),e.nextMatch=this.lookaheadRegExp.lastIndex)}},{name:"htmlEntitiesEncoding",match:"(?:(?:&#?[a-zA-Z0-9]{2,8};|.)(?:&#?(?:x0*(?:3[0-6][0-9a-fA-F]|1D[c-fC-F][0-9a-fA-F]|20[d-fD-F][0-9a-fA-F]|FE2[0-9a-fA-F])|0*(?:76[89]|7[7-9][0-9]|8[0-7][0-9]|761[6-9]|76[2-7][0-9]|84[0-3][0-9]|844[0-7]|6505[6-9]|6506[0-9]|6507[0-1]));)+|&#?[a-zA-Z0-9]{2,8};)",handler:function(e){createTiddlyElement(e.output,"span").innerHTML=e.matchText}}],Wikifier.prototype.wikifyPlain=function(){var e=createTiddlyElement(document.body,"div");e.style.display="none",this.subWikify(e);var t=jQuery(e).text();return jQuery(e).remove(),t},Wikifier.prototype.subWikify=function(e,t){try{t?this.subWikifyTerm(e,new RegExp("("+t+")","mg")):this.subWikifyUnterm(e)}catch(i){showException(i)}},Wikifier.prototype.subWikifyUnterm=function(e){var t=this.output;this.output=e,this.formatter.formatterRegExp.lastIndex=this.nextMatch;for(var i=this.formatter.formatterRegExp.exec(this.source);i;){i.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,i.index),this.matchStart=i.index,this.matchLength=i[0].length,this.matchText=i[0],this.nextMatch=this.formatter.formatterRegExp.lastIndex;var r;for(r=1;r<i.length;r++)if(i[r]){this.formatter.formatters[r-1].handler(this),this.formatter.formatterRegExp.lastIndex=this.nextMatch;break}i=this.formatter.formatterRegExp.exec(this.source)}this.nextMatch<this.source.length&&(this.outputText(this.output,this.nextMatch,this.source.length),this.nextMatch=this.source.length),this.output=t},Wikifier.prototype.subWikifyTerm=function(e,t){var i=this.output;this.output=e,t.lastIndex=this.nextMatch;var r=t.exec(this.source);this.formatter.formatterRegExp.lastIndex=this.nextMatch;for(var n=this.formatter.formatterRegExp.exec(r?this.source.substr(0,r.index):this.source);r||n;){if(r&&(!n||r.index<=n.index))return r.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,r.index),this.matchText=r[1],this.matchLength=r[1].length,this.matchStart=r.index,this.nextMatch=this.matchStart+this.matchLength,void(this.output=i);n.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,n.index),this.matchStart=n.index,this.matchLength=n[0].length,this.matchText=n[0],this.nextMatch=this.formatter.formatterRegExp.lastIndex;var o;for(o=1;o<n.length;o++)if(n[o]){this.formatter.formatters[o-1].handler(this),this.formatter.formatterRegExp.lastIndex=this.nextMatch;break}t.lastIndex=this.nextMatch,r=t.exec(this.source),n=this.formatter.formatterRegExp.exec(r?this.source.substr(0,r.index):this.source)}this.nextMatch<this.source.length&&(this.outputText(this.output,this.nextMatch,this.source.length),this.nextMatch=this.source.length),this.output=i},Wikifier.prototype.outputText=function(e,t,i){for(;this.highlightMatch&&this.highlightRegExp.lastIndex>t&&this.highlightMatch.index<i&&i>t;){this.highlightMatch.index>t&&(createTiddlyText(e,this.source.substring(t,this.highlightMatch.index)),t=this.highlightMatch.index);var r=Math.min(this.highlightRegExp.lastIndex,i);createTiddlyElement(e,"span",null,"highlight",this.source.substring(t,r)),t=r,t>=this.highlightRegExp.lastIndex&&(this.highlightMatch=this.highlightRegExp.exec(this.source))}i>t&&createTiddlyText(e,this.source.substring(t,i))},config.macros.version.handler=function(e){jQuery("<span/>").text(formatVersion()).appendTo(e)},config.macros.today.handler=function(e,t,i){var r=new Date,n=i[0]?r.formatString(i[0].trim()):r.toLocaleString();jQuery("<span/>").text(n).appendTo(e)},config.macros.list.template="<<view title link>>",config.macros.list.handler=function(e,t,i,r,n){var o=document.createElement("ul");jQuery(o).attr({refresh:"macro",macroName:t}).data("params",n),e.appendChild(o),this.refresh(o)},config.macros.list.refresh=function(e){var t=jQuery(e).data("params"),i=t.readMacroParams(),r=t.parseParams("anon",null,null)[0],n=r.anon?r.anon[0]:"all";jQuery(e).empty().addClass("list list-"+n);var o=r.template?store.getTiddlerText(r.template[0]):!1;o||(o=config.macros.list.template),this[n].prompt&&createTiddlyElement(e,"li",null,"listTitle",this[n].prompt);var a;this[n].handler&&(a=this[n].handler(i));var s;for(s=0;s<a.length;s++){var l=document.createElement("li");e.appendChild(l);var d=a[s];"string"==typeof d&&(d=store.getTiddler(d)||new Tiddler(d)),wikify(o,l,null,d)}0===a.length&&r.emptyMessage&&(jQuery(e).addClass("emptyList"),jQuery("<li />").text(r.emptyMessage[0]).appendTo(e))},config.macros.list.all.handler=function(){return store.reverseLookup("tags","excludeLists",!1,"title")},config.macros.list.missing.handler=function(){return store.getMissingLinks()},config.macros.list.orphans.handler=function(){return store.getOrphans()},config.macros.list.shadowed.handler=function(){return store.getShadowed()},config.macros.list.touched.handler=function(){return store.getTouched()},config.macros.list.filter.handler=function(e){var t=e[1],i=[];if(t){var r,n=store.filterTiddlers(t);for(r=0;r<n.length;r++)i.push(n[r].title)}return i},config.macros.allTags.handler=function(e,t,i){var r=store.getTags(i[0]),n=createTiddlyElement(e,"ul");0==r.length&&createTiddlyElement(n,"li",null,"listTitle",this.noTags);var o;for(o=0;o<r.length;o++){var a=r[o][0],s=getTiddlyLinkInfo(a),l=createTiddlyElement(n,"li"),d=createTiddlyButton(l,a+" ("+r[o][1]+")",this.tooltip.format([a]),onClickTag,s.classes);d.setAttribute("tag",a),d.setAttribute("refresh","link"),d.setAttribute("tiddlyLink",a),i[1]&&d.setAttribute("sortby",i[1])}};var macro=config.macros.timeline;merge(macro,{handler:function(e,t,i,r,n){var o=jQuery("<div />").attr("params",n).attr("macroName",t).appendTo(e)[0];macro.refresh(o)},refresh:function(e){jQuery(e).attr("refresh","macro").empty();var t=jQuery(e).attr("params"),i=t.parseParams("anon",null,null)[0],r=i.anon||[],n=r[0]||"modified",o=n.charAt(0),a="-"===o||"+"===o?n.substr(1,n.length):n,s=r[2]||this.dateFormat,l=macro.groupTemplate.format(a,s);l=i.groupTemplate?store.getTiddlerText(i.groupTemplate[0])||l:l;var d=macro.itemTemplate;d=i.template?store.getTiddlerText(i.template[0])||d:d;var c,u,p=i.filter?store.sortTiddlers(store.filterTiddlers(i.filter[0]),n):store.reverseLookup("tags","excludeLists",!1,n),f="",h=r[1]?p.length-Math.min(p.length,parseInt(r[1],10)):0;for(u=p.length-1;u>=h;u--){var g=p[u],m=wikifyPlainText(l,0,g);("undefined"==typeof c||m!=f)&&(c=document.createElement("ul"),jQuery(c).addClass("timeline"),e.appendChild(c),createTiddlyElement(c,"li",null,"listTitle",m),f=m);var y=createTiddlyElement(c,"li",null,"listLink");wikify(d,y,null,g)}},groupTemplate:"<<view %0 date '%1'>>",itemTemplate:"<<view title link>>"}),config.macros.tiddler.handler=function(e,t,i,r,n){var o=!0,a=config.macros.tiddler.tiddlerStack;if(a.length>0&&"system"==config.evaluateMacroParameters){var s=a[a.length-1],l=s.indexOf(config.textPrimitives.sectionSeparator);-1!=l&&(s=s.substr(0,l));var d=store.getTiddler(s);d&&-1!=d.tags.indexOf("systemAllowEval")||(o=!1)}i=n.parseParams("name",null,o,!1,!0);var c=i[0].name,u=c[0],p=c[1]||null,f=i[0]["with"],h=createTiddlyElement(e,"span",null,p,null,{refresh:"content",tiddler:u});void 0!==f&&h.setAttribute("args","[["+f.join("]] [[")+"]]"),this.transclude(h,u,f)},config.macros.tiddler.transclude=function(e,t,i){var r=store.getTiddlerText(t);if(r){var n=config.macros.tiddler.tiddlerStack;if(-1===n.indexOf(t)){n.push(t);try{"string"==typeof i&&(i=i.readBracketedList());var o,a=i?Math.min(i.length,9):0;for(o=0;a>o;o++){var s=new RegExp("\\$"+(o+1),"mg");r=r.replace(s,i[o])}config.macros.tiddler.renderText(e,r,t)}finally{n.pop()}}}},config.macros.tiddler.renderText=function(e,t,i){wikify(t,e,null,store.getTiddler(i))},config.macros.tiddler.tiddlerStack=[],config.macros.tag.handler=function(e,t,i){var r=createTagButton(e,i[0],null,i[1],i[2]);i[3]&&r.setAttribute("sortby",i[3])},config.macros.tags.handler=function(e,t,i,r,n,o){i=n.parseParams("anon",null,!0,!1,!1);var a=createTiddlyElement(e,"ul"),s=getParam(i,"anon","");s&&store.tiddlerExists(s)&&(o=store.getTiddler(s));var l,d=getParam(i,"sep"," "),c=config.views.wikified.tag,u=null;for(l=0;l<o.tags.length;l++){var p=store.getTiddler(o.tags[l]);p&&p.tags.contains("excludeLists")||(u||(u=createTiddlyElement(a,"li",null,"listTitle",c.labelTags.format([o.title]))),createTagButton(createTiddlyElement(a,"li"),o.tags[l],o.title),l<o.tags.length-1&&createTiddlyText(a,d))}u||createTiddlyElement(a,"li",null,"listTitle",c.labelNoTags.format([o.title]))},config.macros.tagging.handler=function(e,t,i,r,n,o){i=n.parseParams("anon",null,!0,!1,!1);var a=createTiddlyElement(e,"ul"),s=getParam(i,"anon","");""==s&&o instanceof Tiddler&&(s=o.title);var l=getParam(i,"sep"," ");a.setAttribute("title",this.tooltip.format([s]));var d=getParam(i,"sortBy",!1),c=store.getTaggedTiddlers(s,d),u=0==c.length?this.labelNotTag:this.label;createTiddlyElement(a,"li",null,"listTitle",u.format([s,c.length]));var p;for(p=0;p<c.length;p++)createTiddlyLink(createTiddlyElement(a,"li"),c[p].title,!0),p<c.length-1&&createTiddlyText(a,l)},config.macros.closeAll.handler=function(e){createTiddlyButton(e,this.label,this.prompt,this.onClick)},config.macros.closeAll.onClick=function(){return story.closeAllTiddlers(),!1},config.macros.permaview.handler=function(e){createTiddlyButton(e,this.label,this.prompt,this.onClick)},config.macros.permaview.onClick=function(){return story.permaView(),!1},config.macros.saveChanges.handler=function(e,t,i){readOnly||createTiddlyButton(e,i[0]||this.label,i[1]||this.prompt,this.onClick,null,null,this.accessKey)},config.macros.saveChanges.onClick=function(){return saveChanges(),!1},config.macros.slider.onClickSlider=function(){var e=this.nextSibling,t=e.getAttribute("cookie"),i="none"!=e.style.display;return config.options.chkAnimate&&anim&&"function"==typeof Slider?anim.startAnimating(new Slider(e,!i,null,"none")):e.style.display=i?"none":"block",config.options[t]=!i,saveOption(t),!1},config.macros.slider.createSlider=function(e,t,i,r){var n=t||"";createTiddlyButton(e,i,r,this.onClickSlider);var o=createTiddlyElement(null,"div",null,"sliderPanel");return o.setAttribute("cookie",n),o.style.display=config.options[n]?"block":"none",e.appendChild(o),o},config.macros.slider.handler=function(e,t,i){var r=this.createSlider(e,i[0],i[2],i[3]),n=store.getTiddlerText(i[1]);r.setAttribute("refresh","content"),r.setAttribute("tiddler",i[1]),n&&wikify(n,r,null,store.getTiddler(i[1]))},config.macros.gradient.handler=function(e,t,i,r,n){var o=r?createTiddlyElement(e,"div",null,"gradient"):e;if(o.style.position="relative",o.style.overflow="hidden",o.style.zIndex="0",r){var a=config.formatterHelpers.inlineCssHelper(r);config.formatterHelpers.applyCssHelper(o,a)}i=n.parseParams("color");var s,l=[],d=[];for(s=2;s<i.length;s++){var c=i[s].value;"snap"==i[s].name?d[d.length-1]=c:(l.push(c),d.push(c))}drawGradient(o,"vert"!=i[1].value,l,d),r&&r.subWikify(o,">>"),document.all&&(o.style.height="100%",o.style.width="100%")},config.macros.message.handler=function(e,t,i){if(i[0]){var r=i[0].split("."),n=function(e,t){return e[r[t]]?t<r.length-1?n(e[r[t]],t+1):e[r[t]]:null},o=n(config,0);null==o&&(o=n(window,0)),createTiddlyText(e,o.toString().format(i.splice(1)))}},config.macros.view.depth=0,config.macros.view.values=[],config.macros.view.views={text:function(e,t,i,r,n,o){highlightify(e,t,highlightHack,o)},link:function(e,t){createTiddlyLink(t,e,!0)},wikified:function(e,t,i,r,n,o){config.macros.view.depth>50||config.macros.view.depth>0&&e==config.macros.view.values[config.macros.view.depth-1]||(config.macros.view.values[config.macros.view.depth]=e,config.macros.view.depth++,i[2]&&(e=i[2].unescapeLineBreaks().format([e])),wikify(e,t,highlightHack,o),config.macros.view.depth--,config.macros.view.values[config.macros.view.depth]=null)},date:function(e,t,i){e=Date.convertFromYYYYMMDDHHMM(e),createTiddlyText(t,e.formatString(i[2]||config.views.wikified.dateFormat))}},config.macros.view.handler=function(e,t,i,r,n,o){if(o instanceof Tiddler&&i[0]){var a=store.getValue(o,i[0]);if(a){var s=i[1]||config.macros.view.defaultView,l=config.macros.view.views[s];l&&l(a,e,i,r,n,o)}}},config.macros.edit.handler=function(e,t,i,r,n,o){var a=i[0],s=i[1]||0,l=i[2]||"";if(o instanceof Tiddler&&a){story.setDirty(o.title,!0);var d,c;if("text"==a||s){var u=createTiddlyElement(null,"fieldset",null,"fieldsetFix"),p=createTiddlyElement(u,"div");d=createTiddlyElement(p,"textarea"),d.value=c=store.getValue(o,a)||l,s=s||10;var f=c.match(/\n/gm),h=Math.max(parseInt(config.options.txtMaxEditRows,10),5);null!=f&&f.length>s&&(s=f.length+5),s=Math.min(s,h),d.setAttribute("rows",s),d.setAttribute("edit",a),e.appendChild(u)}else d=createTiddlyElement(null,"input",null,null,null,{type:"text",edit:a,size:"40",autocomplete:"off"}),d.value=store.getValue(o,a)||l,e.appendChild(d);return o.isReadOnly()&&(d.setAttribute("readOnly","readOnly"),jQuery(d).addClass("readOnly")),d}},config.macros.tagChooser.onClick=function(e){var t=e||window.event,i=config.views.editor.tagChooser,r=Popup.create(this),n=store.getTags(this.getAttribute("tags"));0==n.length&&jQuery("<li/>").text(i.popupNone).appendTo(r);var o;for(o=0;o<n.length;o++){var a=createTiddlyButton(createTiddlyElement(r,"li"),n[o][0],i.tagTooltip.format([n[o][0]]),config.macros.tagChooser.onTagClick);a.setAttribute("tag",n[o][0]),a.setAttribute("tiddler",this.getAttribute("tiddler"))}return Popup.show(),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),!1},config.macros.tagChooser.onTagClick=function(e){var t=e||window.event;(t.metaKey||t.ctrlKey)&&stopEvent(t);var i=this.getAttribute("tag"),r=this.getAttribute("tiddler");return readOnly||story.setTiddlerTag(r,i,0),!1},config.macros.tagChooser.handler=function(e,t,i,r,n,o){if(o instanceof Tiddler){var a=config.views.editor.tagChooser,s=createTiddlyButton(e,a.text,a.tooltip,this.onClick);s.setAttribute("tiddler",o.title),s.setAttribute("tags",i[0])}},config.macros.refreshDisplay.handler=function(e){createTiddlyButton(e,this.label,this.prompt,this.onClick)},config.macros.refreshDisplay.onClick=function(){return refreshAll(),!1},config.macros.annotations.handler=function(e,t,i,r,n,o){var a=o?o.title:null,s=a?config.annotations[a]:null;if(o&&a&&s){var l=s.format([a]);wikify(l,createTiddlyElement(e,"div",null,"annotation"),null,o)}},config.macros.newTiddler.createNewTiddlerButton=function(e,t,i,r,n,o,a,s){var l,d=[];for(l=1;l<i.length;l++)("anon"==i[l].name&&1!=l||"tag"==i[l].name)&&d.push(i[l].value);r=getParam(i,"label",r),n=getParam(i,"prompt",n),o=getParam(i,"accessKey",o),a=getParam(i,"focus",a);var c=getParam(i,"fields","");c||store.isShadowTiddler(t)||(c=String.encodeHashMap(config.defaultCustomFields));var u=createTiddlyButton(e,r,n,this.onClickNewTiddler,null,null,o);u.setAttribute("newTitle",t),u.setAttribute("isJournal",s?"true":"false"),d.length>0&&u.setAttribute("params",d.join("|")),u.setAttribute("newFocus",a),u.setAttribute("newTemplate",getParam(i,"template",DEFAULT_EDIT_TEMPLATE)),""!==c&&u.setAttribute("customFields",c);var p=getParam(i,"text");return void 0!==p&&u.setAttribute("newText",p),u},config.macros.newTiddler.onClickNewTiddler=function(){var e=this.getAttribute("newTitle");"true"==this.getAttribute("isJournal")&&(e=(new Date).formatString(e.trim()));var t=this.getAttribute("params"),i=t?t.split("|"):[],r=this.getAttribute("newFocus"),n=this.getAttribute("newTemplate"),o=this.getAttribute("customFields");o||store.isShadowTiddler(e)||(o=String.encodeHashMap(config.defaultCustomFields)),story.displayTiddler(null,e,n,!1,null,null);var a=story.getTiddler(e);o&&story.addCustomFields(a,o);var s=this.getAttribute("newText");"string"==typeof s&&story.getTiddlerField(e,"text")&&(story.getTiddlerField(e,"text").value=s.format([e]));var l;for(l=0;l<i.length;l++)story.setTiddlerTag(e,i[l],1);return story.focusTiddler(e,r),!1},config.macros.newTiddler.handler=function(e,t,i,r,n){if(!readOnly){i=n.parseParams("anon",null,!0,!1,!1);var o=i[1]&&"anon"==i[1].name?i[1].value:this.title;o=getParam(i,"title",o),this.createNewTiddlerButton(e,o,i,this.label,this.prompt,this.accessKey,"title",!1)}},config.macros.newJournal.handler=function(e,t,i,r,n){if(!readOnly){i=n.parseParams("anon",null,!0,!1,!1);var o=i[1]&&"anon"==i[1].name?i[1].value:config.macros.timeline.dateFormat;o=getParam(i,"title",o),config.macros.newTiddler.createNewTiddlerButton(e,o,i,this.label,this.prompt,this.accessKey,"text",!0)}},config.macros.search.handler=function(e,t,i,r,n){i=n.parseParams("anon",null,!1,!1,!1),createTiddlyButton(e,this.label,this.prompt,this.onClick,"searchButton");var o=createTiddlyElement(null,"input",null,"txtOptionInput searchField");o.value=getParam(i,"anon",""),config.browser.isSafari?(o.setAttribute("type","search"),o.setAttribute("results","5")):o.setAttribute("type","text"),e.appendChild(o),o.onkeyup=this.onKeyPress,o.onfocus=this.onFocus,o.setAttribute("size",this.sizeTextbox),o.setAttribute("accessKey",getParam(i,"accesskey",this.accessKey)),o.setAttribute("autocomplete","off"),o.setAttribute("lastSearchText",""),o.setAttribute("placeholder",getParam(i,"placeholder",this.placeholder))},config.macros.search.timeout=null,config.macros.search.doSearch=function(e){e.value.length>0&&(story.search(e.value,config.options.chkCaseSensitiveSearch,config.options.chkRegExpSearch),e.setAttribute("lastSearchText",e.value))},config.macros.search.onClick=function(){return config.macros.search.doSearch(this.nextSibling),!1},config.macros.search.onKeyPress=function(e){var t=config.macros.search,i=e||window.event;switch(i.keyCode){case 9:return;case 13:case 10:t.doSearch(this);break;case 27:this.value="",clearMessage()}if(config.options.chkIncrementalSearch)if(this.value.length>2){if(this.value!=this.getAttribute("lastSearchText")){t.timeout&&clearTimeout(t.timeout);var r=this;t.timeout=setTimeout(function(){t.doSearch(r)},500)}}else t.timeout&&clearTimeout(t.timeout)},config.macros.search.onFocus=function(){this.select()},config.macros.tabs.handler=function(e,t,i){var r=i[0],n=(i.length-1)/3,o=createTiddlyElement(null,"div",null,"tabsetWrapper "+r),a=createTiddlyElement(o,"div",null,"tabset");a.setAttribute("cookie",r);var s,l=!1;for(s=0;n>s;s++){var d=i[3*s+1],c=i[3*s+2],u=i[3*s+3],p=createTiddlyButton(a,d,c,this.onClickTab,"tab tabUnselected");createTiddlyElement(p,"span",null,null," ",{style:"font-size:0pt;line-height:0px"}),p.setAttribute("tab",d),p.setAttribute("content",u),p.title=c,config.options[r]==d&&(l=!0)}l||(config.options[r]=i[1]),e.appendChild(o),this.switchTab(a,config.options[r])},config.macros.tabs.onClickTab=function(){return config.macros.tabs.switchTab(this.parentNode,this.getAttribute("tab")),!1},config.macros.tabs.switchTab=function(e,t){var i,r=e.getAttribute("cookie"),n=null,o=e.childNodes;for(i=0;i<o.length;i++)o[i].getAttribute&&o[i].getAttribute("tab")==t?(n=o[i],n.className="tab tabSelected"):o[i].className="tab tabUnselected";
if(n){e.nextSibling&&"tabContents"==e.nextSibling.className&&jQuery(e.nextSibling).remove();var a=createTiddlyElement(null,"div",null,"tabContents");e.parentNode.insertBefore(a,e.nextSibling);var s=n.getAttribute("content");wikify(store.getTiddlerText(s),a,null,store.getTiddler(s)),r&&(config.options[r]=t,saveOption(r))}},config.macros.toolbar.createCommand=function(e,t,i,r){if("string"!=typeof t){var n,o=null;for(n in config.commands)config.commands[n]==t&&(o=n);t=o}if(i instanceof Tiddler&&"string"==typeof t){var a=config.commands[t];if(a.isEnabled?a.isEnabled(i):this.isCommandEnabled(a,i)){var s=a.getText?a.getText(i):this.getCommandText(a,i),l=a.getTooltip?a.getTooltip(i):this.getCommandTooltip(a,i),d="popup"==a.type?this.onClickPopup:this.onClickCommand,c=createTiddlyButton(null,s,l,d);c.setAttribute("commandName",t),c.setAttribute("tiddler",i.title),jQuery(c).addClass("command_"+t),r&&jQuery(c).addClass(r),e.appendChild(c)}}},config.macros.toolbar.isCommandEnabled=function(e,t){var i=t.title,r=t.isReadOnly(),n=store.isShadowTiddler(i)&&!store.tiddlerExists(i);return!(r&&(!r||e.hideReadOnly)||n&&e.hideShadow)},config.macros.toolbar.getCommandText=function(e,t){return t.isReadOnly()&&e.readOnlyText||e.text},config.macros.toolbar.getCommandTooltip=function(e,t){return t.isReadOnly()&&e.readOnlyTooltip||e.tooltip},config.macros.toolbar.onClickCommand=function(e){var t=e||window.event;t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation();var i=config.commands[this.getAttribute("commandName")];return i.handler(t,this,this.getAttribute("tiddler"))},config.macros.toolbar.onClickPopup=function(e){var t=e||window.event;t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation();var i=Popup.create(this),r=config.commands[this.getAttribute("commandName")],n=this.getAttribute("tiddler");return i.setAttribute("tiddler",n),r.handlePopup(i,n),Popup.show(),!1},config.macros.toolbar.invokeCommand=function(e,t,i){var r,n=e.getElementsByTagName("a");for(r=0;r<n.length;r++){var o=n[r];if(jQuery(o).hasClass(t)&&o.getAttribute&&o.getAttribute("commandName")){o.onclick instanceof Function&&o.onclick.call(o,i);break}}},config.macros.toolbar.onClickMore=function(){var e=this.nextSibling;return e.style.display="inline",this.style.display="none",!1},config.macros.toolbar.onClickLess=function(){var e=this.parentNode,t=e.previousSibling;return e.style.display="none",t.style.display="inline",!1},config.macros.toolbar.handler=function(e,t,i,r,n,o){var a;for(a=0;a<i.length;a++){var s,l=i[a];switch(l){case"!":createTiddlyText(e,this.separator);break;case"*":createTiddlyElement(e,"br");break;case"<":s=createTiddlyButton(e,this.lessLabel,this.lessPrompt,config.macros.toolbar.onClickLess),jQuery(s).addClass("lessCommand");break;case">":s=createTiddlyButton(e,this.moreLabel,this.morePrompt,config.macros.toolbar.onClickMore),jQuery(s).addClass("moreCommand");var d=createTiddlyElement(e,"span",null,"moreCommand");d.style.display="none",e=d;break;default:var c="";switch(l.substr(0,1)){case"+":c="defaultCommand",l=l.substr(1);break;case"-":c="cancelCommand",l=l.substr(1)}config.commands[l]?this.createCommand(e,l,o,c):this.customCommand(e,l,r,o)}}},config.macros.toolbar.customCommand=function(){},config.commands.closeTiddler.handler=function(e,t,i){return!story.isDirty(i)||readOnly||confirm(config.commands.cancelTiddler.warning.format([i]))?(story.setDirty(i,!1),story.closeTiddler(i,!0),!1):!1},config.commands.closeOthers.handler=function(e,t,i){return story.closeAllTiddlers(i),!1},config.commands.editTiddler.handler=function(e,t,i){clearMessage();var r=story.getTiddler(i),n=r.getAttribute("tiddlyFields");story.displayTiddler(null,i,DEFAULT_EDIT_TEMPLATE,!1,null,n);var o=story.getTiddlerField(i,config.options.txtEditorFocus||"text");return o&&setCaretPosition(o,0),!1},config.commands.saveTiddler.handler=function(e,t,i){var r=story.saveTiddler(i,e.shiftKey);return r&&story.displayTiddler(null,r),!1},config.commands.cancelTiddler.handler=function(e,t,i){return!story.hasChanges(i)||readOnly||confirm(this.warning.format([i]))?(story.setDirty(i,!1),story.displayTiddler(null,i),!1):!1},config.commands.deleteTiddler.handler=function(e,t,i){var r=!0;return config.options.chkConfirmDelete&&(r=confirm(this.warning.format([i]))),r&&(store.removeTiddler(i),story.closeTiddler(i,!0),autoSaveChanges()),!1},config.commands.permalink.handler=function(e,t,i){var r=encodeURIComponent(String.encodeTiddlyLink(i));return window.location.hash!=r&&(window.location.hash=r),!1},config.commands.references.handlePopup=function(e,t){var i,r=store.getReferringTiddlers(t),n=!1;for(i=0;i<r.length;i++)r[i].title==t||r[i].isTagged("excludeLists")||(createTiddlyLink(createTiddlyElement(e,"li"),r[i].title,!0),n=!0);n||createTiddlyElement(e,"li",null,"disabled",this.popupNone)},config.commands.jump.handlePopup=function(e){story.forEachTiddler(function(t){createTiddlyLink(createTiddlyElement(e,"li"),t,!0,null,!1,null,!0)})},config.commands.fields.handlePopup=function(e,t){var i=store.fetchTiddler(t);if(i){var r=[];store.forEachField(i,function(e,t,i){r.push({field:t,value:i})},!0),r.sort(function(e,t){return e.field<t.field?-1:e.field==t.field?0:1}),r.length>0?ListView.create(e,r,this.listViewTemplate):createTiddlyElement(e,"div",null,null,this.emptyText)}},Tiddler.prototype.getLinks=function(){return 0==this.linksUpdated&&this.changed(),this.links},Tiddler.prototype.getInheritedFields=function(){var e,t={};for(e in this.fields)("server.host"==e||"server.workspace"==e||"wikiformat"==e||"server.type"==e)&&(t[e]=this.fields[e]);return String.encodeHashMap(t)},Tiddler.prototype.incChangeCount=function(){var e=this.fields.changecount;e=e?parseInt(e,10):0,this.fields.changecount=String(e+1)},Tiddler.prototype.clearChangeCount=function(){this.fields.changecount&&delete this.fields.changecount},Tiddler.prototype.doNotSave=function(){return this.fields.doNotSave},Tiddler.prototype.isTouched=function(){var e=this.fields.changecount||0;return e>0},Tiddler.prototype.set=function(e,t,i,r,n,o,a,s){return this.assign(e,t,i,r,n,o,a,s),this.changed(),this},Tiddler.prototype.assign=function(e,t,i,r,n,o,a,s){return void 0!=e&&(this.title=e),void 0!=t&&(this.text=t),void 0!=i&&(this.modifier=i),void 0!=r&&(this.modified=r),void 0!=s&&(this.creator=s),void 0!=o&&(this.created=o),void 0!=a&&(this.fields=a),void 0!=n?this.tags="string"==typeof n?n.readBracketedList():n:void 0==this.tags&&(this.tags=[]),this},Tiddler.prototype.getTags=function(){return String.encodeTiddlyLinkList(this.tags)},Tiddler.prototype.isTagged=function(e){return-1!=this.tags.indexOf(e)},Tiddler.unescapeLineBreaks=function(e){return e?e.unescapeLineBreaks():""},Tiddler.prototype.escapeLineBreaks=function(){return this.text.escapeLineBreaks()},Tiddler.prototype.changed=function(){this.links=[];var e=this.text;e=e.replace(/\/%((?:.|\n)*?)%\//g,"").replace(/\{{3}((?:.|\n)*?)\}{3}/g,"").replace(/"""((?:.|\n)*?)"""/g,"").replace(/<nowiki\>((?:.|\n)*?)<\/nowiki\>/g,"").replace(/<html\>((?:.|\n)*?)<\/html\>/g,"").replace(/<script((?:.|\n)*?)<\/script\>/g,"");var t=this.autoLinkWikiWords()?0:1,i=0==t?config.textPrimitives.tiddlerAnyLinkRegExp:config.textPrimitives.tiddlerForcedLinkRegExp;i.lastIndex=0;for(var r=i.exec(e);r;){var n=i.lastIndex;if(0==t&&r[1]&&r[1]!=this.title)if(r.index>0){var o=new RegExp(config.textPrimitives.unWikiLink+"|"+config.textPrimitives.anyLetter,"mg");o.lastIndex=r.index-1;var a=o.exec(e);a.index!=r.index-1&&this.links.pushUnique(r[1])}else this.links.pushUnique(r[1]);else r[2-t]&&!config.formatterHelpers.isExternalLink(r[3-t])?this.links.pushUnique(r[3-t]):r[4-t]&&r[4-t]!=this.title&&this.links.pushUnique(r[4-t]);i.lastIndex=n,r=i.exec(e)}this.linksUpdated=!0},Tiddler.prototype.getSubtitle=function(){var e=this.modifier;e||(e=config.messages.subtitleUnknown||"");var t=this.modified;t=t?t.toLocaleString():config.messages.subtitleUnknown||"";var i=config.messages.tiddlerLinkTooltip||"%0 - %1, %2";return i.format([this.title,e,t])},Tiddler.prototype.isReadOnly=function(){return readOnly},Tiddler.prototype.autoLinkWikiWords=function(){return!(this.isTagged("systemConfig")||this.isTagged("excludeMissing"))},Tiddler.prototype.getServerType=function(){var e=null;return this.fields["server.type"]&&(e=this.fields["server.type"]),e||(e=this.fields.wikiformat),e&&!config.adaptors[e]&&(e=null),e},Tiddler.prototype.getAdaptor=function(){var e=this.getServerType();return e?new config.adaptors[e]:null},TiddlyWiki.prototype.setDirty=function(e){this.dirty=e},TiddlyWiki.prototype.isDirty=function(){return this.dirty},TiddlyWiki.prototype.tiddlerExists=function(e){var t=this.fetchTiddler(e);return void 0!=t},TiddlyWiki.prototype.isShadowTiddler=function(e){return void 0===config.shadowTiddlers[e]?!1:!0},TiddlyWiki.prototype.isAvailable=function(e){if(!e)return!1;var t=e?e.indexOf(config.textPrimitives.sectionSeparator):-1;return-1!=t&&(e=e.substr(0,t)),this.tiddlerExists(e)||this.isShadowTiddler(e)},TiddlyWiki.prototype.createTiddler=function(e){var t=this.fetchTiddler(e);return t||(t=new Tiddler(e),this.addTiddler(t),this.setDirty(!0)),t},TiddlyWiki.prototype.getTiddler=function(e){var t=this.fetchTiddler(e);return void 0!=t?t:null},TiddlyWiki.prototype.getShadowTiddlerText=function(e){return"string"==typeof config.shadowTiddlers[e]?config.shadowTiddlers[e]:""},TiddlyWiki.prototype.getTiddlerText=function(e,t){if(!e)return t;var i=e.indexOf(config.textPrimitives.sectionSeparator),r=null;if(-1!=i&&(r=e.substr(i+config.textPrimitives.sectionSeparator.length),e=e.substr(0,i)),i=e.indexOf(config.textPrimitives.sliceSeparator),-1!=i){var n=this.getTiddlerSlice(e.substr(0,i),e.substr(i+config.textPrimitives.sliceSeparator.length));if(n)return n}var o=this.fetchTiddler(e),a=o?o.text:null;if(!o&&this.isShadowTiddler(e)&&(a=this.getShadowTiddlerText(e)),a){if(!r)return a;var s=new RegExp("(^!{1,6}[ 	]*"+r.escapeRegExp()+"[ 	]*\n)","mg");s.lastIndex=0;var l=s.exec(a);if(l){var d=a.substr(l.index+l[1].length),c=/^!/gm;return c.lastIndex=0,l=c.exec(d),l&&(d=d.substr(0,l.index-1)),d}return t}return void 0!=t?t:null},TiddlyWiki.prototype.getRecursiveTiddlerText=function(e,t,i){var r=new RegExp("(?:\\[\\[([^\\]]+)\\]\\])","mg"),n=this.getTiddlerText(e,null);if(null==n)return t;var o,a=[],s=0;do o=r.exec(n),o?(a.push(n.substr(s,o.index-s)),o[1]&&a.push(0>=i?o[1]:this.getRecursiveTiddlerText(o[1],"",i-1)),s=o.index+o[0].length):a.push(n.substr(s));while(o);return a.join("")},TiddlyWiki.prototype.slicesRE=/(?:^([\'\/]{0,2})~?([\.\w]+)\:\1[\t\x20]*([^\n]*)[\t\x20]*$)|(?:^\|([\'\/]{0,2})~?([\.\w]+)\:?\4\|[\t\x20]*([^\|\n]*)[\t\x20]*\|$)/gm,TiddlyWiki.prototype.calcAllSlices=function(e){var t={},i=this.getTiddlerText(e,"");this.slicesRE.lastIndex=0;for(var r=this.slicesRE.exec(i);r;)r[2]?t[r[2]]=r[3]:t[r[5]]=r[6],r=this.slicesRE.exec(i);return t},TiddlyWiki.prototype.getTiddlerSlice=function(e,t){var i=this.slices[e];return i||(i=this.calcAllSlices(e),this.slices[e]=i),i[t]},TiddlyWiki.prototype.getTiddlerSlices=function(e,t){var i,r={};for(i=0;i<t.length;i++){var n=this.getTiddlerSlice(e,t[i]);n&&(r[t[i]]=n)}return r},TiddlyWiki.prototype.suspendNotifications=function(){this.notificationLevel--},TiddlyWiki.prototype.resumeNotifications=function(){this.notificationLevel++},TiddlyWiki.prototype.notify=function(e,t){if(!this.notificationLevel){var i;for(i=0;i<this.namedNotifications.length;i++){var r=this.namedNotifications[i];(null==r.name&&t||r.name==e)&&r.notify(e)}}},TiddlyWiki.prototype.notifyAll=function(){if(!this.notificationLevel){var e;for(e=0;e<this.namedNotifications.length;e++){var t=this.namedNotifications[e];t.name&&t.notify(t.name)}}},TiddlyWiki.prototype.addNotification=function(e,t){var i;for(i=0;i<this.namedNotifications.length;i++)if(this.namedNotifications[i].name==e&&this.namedNotifications[i].notify==t)return this;return this.namedNotifications.push({name:e,notify:t}),this},TiddlyWiki.prototype.removeTiddler=function(e){var t=this.fetchTiddler(e);t&&(this.deleteTiddler(e),this.notify(e,!0),this.setDirty(!0))},TiddlyWiki.prototype.resetTiddler=function(e){var t=this.fetchTiddler(e);t&&(t.clearChangeCount(),this.notify(e,!0),this.setDirty(!0))},TiddlyWiki.prototype.setTiddlerTag=function(e,t,i){var r=this.fetchTiddler(e);if(r){var n=r.tags.indexOf(i);-1!=n&&r.tags.splice(n,1),t&&r.tags.push(i),r.changed(),r.incChangeCount(),this.notify(e,!0),this.setDirty(!0)}},TiddlyWiki.prototype.addTiddlerFields=function(e,t){var i=this.fetchTiddler(e);i&&(merge(i.fields,t),i.changed(),i.incChangeCount(),this.notify(e,!0),this.setDirty(!0))},TiddlyWiki.prototype.saveTiddler=function(e,t,i,r,n,o,a,s,l,d){var c;return e instanceof Tiddler?(c=e,c.fields=merge(merge({},c.fields),config.defaultCustomFields,!0),e=c.title,t=e):(c=this.fetchTiddler(e),c?(l=l||c.created,d=d||c.creator,this.deleteTiddler(e)):(l=l||n,c=new Tiddler),a=merge(merge({},a),config.defaultCustomFields,!0),c.set(t,i,r,n,o,l,a,d)),this.addTiddler(c),s?c.clearChangeCount():c.incChangeCount(),e!=t&&this.notify(e,!0),this.notify(t,!0),this.setDirty(!0),c},TiddlyWiki.prototype.incChangeCount=function(e){var t=this.fetchTiddler(e);t&&t.incChangeCount()},TiddlyWiki.prototype.getLoader=function(){return this.loader||(this.loader=new TW21Loader),this.loader},TiddlyWiki.prototype.getSaver=function(){return this.saver||(this.saver=new TW21Saver),this.saver},TiddlyWiki.prototype.allTiddlersAsHtml=function(){return this.getSaver().externalize(store)},TiddlyWiki.prototype.loadFromDiv=function(e,t,i){this.idPrefix=t;var r="string"==typeof e?document.getElementById(e):e;if(r){var n=this.getLoader().loadTiddlers(this,r.childNodes);if(this.setDirty(!1),!i){var o;for(o=0;o<n.length;o++)n[o].changed()}jQuery(document).trigger("loadTiddlers")}},TiddlyWiki.prototype.importTiddlyWiki=function(e){var t=locateStoreArea(e);if(!t)return null;var i="<html><body>"+e.substring(t[0],t[1]+endSaveArea.length)+"</body></html>",r=document.createElement("iframe");r.style.display="none",document.body.appendChild(r);var n=r.document;r.contentDocument?n=r.contentDocument:r.contentWindow&&(n=r.contentWindow.document),n.open(),n.writeln(i),n.close();var o=n.getElementById("storeArea");return this.loadFromDiv(o,"store"),r.parentNode.removeChild(r),this},TiddlyWiki.prototype.updateTiddlers=function(){this.tiddlersUpdated=!0,this.forEachTiddler(function(e,t){t.changed()})},TiddlyWiki.prototype.search=function(e,t,i,r){var n,o=this.reverseLookup("tags",i,!!r),a=[];for(n=0;n<o.length;n++)(-1!=o[n].title.search(e)||-1!=o[n].text.search(e))&&a.push(o[n]);return t||(t="title"),a.sort(function(e,i){return e[t]<i[t]?-1:e[t]==i[t]?0:1}),a},TiddlyWiki.prototype.getTags=function(e){var t=[];return this.forEachTiddler(function(i,r){var n,o;for(n=0;n<r.tags.length;n++){var a=r.tags[n],s=!0;for(o=0;o<t.length;o++)t[o][0]==a&&(s=!1,t[o][1]++);if(s&&e){var l=this.fetchTiddler(a);l&&l.isTagged(e)&&(s=!1)}s&&t.push([a,1])}}),t.sort(function(e,t){return e[0].toLowerCase()<t[0].toLowerCase()?-1:e[0].toLowerCase()==t[0].toLowerCase()?0:1}),t},TiddlyWiki.prototype.getTaggedTiddlers=function(e,t){return this.reverseLookup("tags",e,!0,t)},TiddlyWiki.prototype.getValueTiddlers=function(e,t,i){return this.reverseLookup(e,t,!0,i)},TiddlyWiki.prototype.getReferringTiddlers=function(e,t,i){return this.tiddlersUpdated||this.updateTiddlers(),this.reverseLookup("links",e,!0,i)},TiddlyWiki.prototype.reverseLookup=function(e,t,i,r){var n=[];return this.forEachTiddler(function(r,o){var a,s=!i;if(["links","tags"].contains(e))a=o[e];else{var l=TiddlyWiki.standardFieldAccess[e];a=l?[l.get(o)]:o.fields[e]?[o.fields[e]]:[]}var d;for(d=0;d<a.length;d++)a[d]==t&&(s=i);s&&n.push(o)}),r||(r="title"),this.sortTiddlers(n,r)},TiddlyWiki.prototype.getTiddlers=function(e,t){var i=[];return this.forEachTiddler(function(e,r){void 0!=t&&r.isTagged(t)||i.push(r)}),e&&i.sort(function(t,i){return t[e]<i[e]?-1:t[e]==i[e]?0:1}),i},TiddlyWiki.prototype.getMissingLinks=function(){this.tiddlersUpdated||this.updateTiddlers();var e=[];return this.forEachTiddler(function(t,i){if(!i.isTagged("excludeMissing")&&!i.isTagged("systemConfig")){var r;for(r=0;r<i.links.length;r++){var n=i.links[r];null!=this.getTiddlerText(n,null)||this.isShadowTiddler(n)||config.macros[n]||e.pushUnique(n)}}}),e.sort(),e},TiddlyWiki.prototype.getOrphans=function(){var e=[];return this.forEachTiddler(function(t,i){0!=this.getReferringTiddlers(t).length||i.isTagged("excludeLists")||e.push(t)}),e.sort(),e},TiddlyWiki.prototype.getShadowed=function(){var e,t=[];for(e in config.shadowTiddlers)this.isShadowTiddler(e)&&t.push(e);return t.sort(),t},TiddlyWiki.prototype.getTouched=function(){var e=[];return this.forEachTiddler(function(t,i){i.isTouched()&&e.push(i)}),e.sort(),e},TiddlyWiki.prototype.resolveTiddler=function(e){var t="string"==typeof e?this.getTiddler(e):e;return t instanceof Tiddler?t:null},TiddlyWiki.prototype.sortTiddlers=function(e,t){var i=1;switch(t.substr(0,1)){case"-":i=-1,t=t.substr(1);break;case"+":t=t.substr(1)}return e.sort(TiddlyWiki.standardFieldAccess[t]?"title"==t?function(e,r){return e[t].toLowerCase()<r[t].toLowerCase()?-i:e[t].toLowerCase()==r[t].toLowerCase()?0:i}:function(e,r){return e[t]<r[t]?-i:e[t]==r[t]?0:i}:function(e,r){return e.fields[t]<r.fields[t]?-i:e.fields[t]==r.fields[t]?0:+i}),e},config.filters={tiddler:function(e,t){var i=t[1]||t[4],r=this.fetchTiddler(i);return r?e.pushUnique(r):this.isShadowTiddler(i)?(r=new Tiddler,r.set(i,this.getTiddlerText(i)),e.pushUnique(r)):e.pushUnique(new Tiddler(i)),e},tag:function(e,t){var i,r=this.getTaggedTiddlers(t[3]);for(i=0;i<r.length;i++)e.pushUnique(r[i]);return e},sort:function(e,t){return this.sortTiddlers(e,t[3])},limit:function(e,t){return e.slice(0,parseInt(t[3],10))},field:function(e,t){var i,r=this.getValueTiddlers(t[2],t[3]);for(i=0;i<r.length;i++)e.pushUnique(r[i]);return e}},TiddlyWiki.prototype.filterTiddlers=function(e){var t=/([^\s\[\]]+)|(?:\[([ \w\.\-]+)\[([^\]]+)\]\])|(?:\[\[([^\]]+)\]\])/gm,i=[];if(e)for(var r=t.exec(e);r;){var n=r[1]||r[4]?"tiddler":config.filters[r[2]]?r[2]:"field";i=config.filters[n].call(this,i,r),r=t.exec(e)}return i},TiddlyWiki.isValidFieldName=function(e){var t=/[a-zA-Z_]\w*(\.[a-zA-Z_]\w*)*/.exec(e);return t&&t[0]==e},TiddlyWiki.checkFieldName=function(e){if(!TiddlyWiki.isValidFieldName(e))throw config.messages.invalidFieldName.format([e])},TiddlyWiki.standardFieldAccess={title:new StringFieldAccess("title",!0),tiddler:new StringFieldAccess("title",!0),text:new StringFieldAccess("text"),modifier:new StringFieldAccess("modifier"),modified:new DateFieldAccess("modified"),creator:new StringFieldAccess("creator"),created:new DateFieldAccess("created"),tags:new LinksFieldAccess("tags")},TiddlyWiki.isStandardField=function(e){return void 0!=TiddlyWiki.standardFieldAccess[e]},TiddlyWiki.prototype.setValue=function(e,t,i){TiddlyWiki.checkFieldName(t);var r=this.resolveTiddler(e);if(r){t=t.toLowerCase();var n=void 0===i||null===i,o=TiddlyWiki.standardFieldAccess[t];if(o){if(n)return;var a=TiddlyWiki.standardFieldAccess[t];if(!a.set(r,i))return}else{var s=r.fields[t];if(n)if(void 0!==s)delete r.fields[t];else{var l,d=new RegExp("^"+t+"\\."),c=!1;for(l in r.fields)l.match(d)&&(delete r.fields[l],c=!0);if(!c)return}else{if(i=i instanceof Date?i.convertToYYYYMMDDHHMMSSMMM():String(i),s==i)return;r.fields[t]=i}}this.notify(r.title,!0),t.match(/^temp\./)||this.setDirty(!0)}},TiddlyWiki.prototype.getValue=function(e,t){var i=this.resolveTiddler(e);if(!i)return void 0;if(0===t.indexOf(config.textPrimitives.sectionSeparator)||0===t.indexOf(config.textPrimitives.sliceSeparator)){var r=t.substr(0,2),n=t.substring(2);return store.getTiddlerText("%0%1%2".format(i.title,r,n))}t=t.toLowerCase();var o=TiddlyWiki.standardFieldAccess[t];return o?o.get(i):i.fields[t]},TiddlyWiki.prototype.forEachField=function(e,t,i){var r=this.resolveTiddler(e);if(!r)return void 0;var n,o;for(n in r.fields)if(o=t(r,n,r.fields[n]))return o;if(i)return void 0;for(n in TiddlyWiki.standardFieldAccess)if("tiddler"!=n&&(o=t(r,n,TiddlyWiki.standardFieldAccess[n].get(r))))return o;return void 0},Story.prototype.getTiddler=function(e){return document.getElementById(this.tiddlerId(e))},Story.prototype.getContainer=function(){return document.getElementById(this.containerId())},Story.prototype.forEachTiddler=function(e){var t=this.getContainer();if(t)for(var i=t.firstChild;i;){var r=i.nextSibling,n=i.getAttribute("tiddler");n&&e.call(this,n,i),i=r}},Story.prototype.displayDefaultTiddlers=function(){this.displayTiddlers(null,store.filterTiddlers(store.getTiddlerText("DefaultTiddlers")))},Story.prototype.displayTiddlers=function(e,t,i,r,n,o){var a;for(a=t.length-1;a>=0;a--)this.displayTiddler(e,t[a],i,r,n,o)},Story.prototype.displayTiddler=function(e,t,i,r,n,o,a,s){var l=t instanceof Tiddler?t.title:t,d=this.getTiddler(l);if(d)a?"true"!=d.getAttribute("dirty")&&this.closeTiddler(l,!0):this.refreshTiddler(l,i,!1,o);else{var c=this.getContainer(),u=this.positionTiddler(e);d=this.createTiddler(c,u,l,i,o)}return s&&"string"!=typeof s&&(e=s),e&&"string"!=typeof e&&(config.options.chkAnimate&&(void 0==r||1==r)&&anim&&"function"==typeof Zoomer&&"function"==typeof Scroller?anim.startAnimating(new Zoomer(l,e,d),new Scroller(d)):window.scrollTo(0,ensureVisible(d))),d},Story.prototype.positionTiddler=function(e){var t=this.getContainer(),i=null;if("string"==typeof e)switch(e){case"top":i=t.firstChild;break;case"bottom":i=null}else{var r=this.findContainingTiddler(e);null==r?i=t.firstChild:r.nextSibling&&(i=r.nextSibling,1!=i.nodeType&&(i=null))}return i},Story.prototype.createTiddler=function(e,t,i,r,n){var o=createTiddlyElement(null,"div",this.tiddlerId(i),"tiddler");o.setAttribute("refresh","tiddler"),n&&o.setAttribute("tiddlyFields",n),e.insertBefore(o,t);var a=null;return store.tiddlerExists(i)||store.isShadowTiddler(i)||(a=this.loadMissingTiddler(i,n)),this.refreshTiddler(i,r,!1,n,a),o},Story.prototype.loadMissingTiddler=function(e,t,i){var r=function(e){if(e.status){var t=e.tiddler;t.created||(t.created=new Date),t.modified||(t.modified=t.created);var r=store.isDirty();e.tiddler=store.saveTiddler(t.title,t.title,t.text,t.modifier,t.modified,t.tags,t.fields,!0,t.created,t.creator),window.allowSave()||store.setDirty(r),autoSaveChanges()}else story.refreshTiddler(e.title,null,!0);e.adaptor.close(),i&&i(e)},n=new Tiddler(e);n.fields="string"==typeof t?t.decodeHashMap():t||{};var o={serverType:n.getServerType()};if(!o.serverType)return"";o.host=n.fields["server.host"],o.workspace=n.fields["server.workspace"];var a=new config.adaptors[o.serverType];return a.getTiddler(e,o,null,r),config.messages.loadingMissingTiddler.format([e,o.serverType,o.host,o.workspace])},Story.prototype.chooseTemplateForTiddler=function(e,t){return t||(t=DEFAULT_VIEW_TEMPLATE),(t==DEFAULT_VIEW_TEMPLATE||t==DEFAULT_EDIT_TEMPLATE)&&(t=config.tiddlerTemplates[t]),t},Story.prototype.getTemplateForTiddler=function(e,t){return store.getRecursiveTiddlerText(t,null,10)},Story.prototype.refreshTiddler=function(e,t,i,r,n){var o=this.getTiddler(e);if(o){if("true"==o.getAttribute("dirty")&&!i)return o;t=this.chooseTemplateForTiddler(e,t);var a=o.getAttribute("template");if(t!=a||i){var s=store.getTiddler(e);if(!s)if(s=new Tiddler,store.isShadowTiddler(e)){var l=[];s.set(e,store.getTiddlerText(e),config.views.wikified.shadowModifier,version.date,l,version.date)}else{var d="EditTemplate"==t?config.views.editor.defaultText.format([e]):config.views.wikified.defaultText.format([e]);d=n||d;var c=r?r.decodeHashMap():null;s.set(e,d,config.views.wikified.defaultModifier,version.date,[],version.date,c)}o.setAttribute("tags",s.tags.join(" ")),o.setAttribute("tiddler",e),o.setAttribute("template",t),o.onmouseover=this.onTiddlerMouseOver,o.onmouseout=this.onTiddlerMouseOut,o.ondblclick=this.onTiddlerDblClick,o[window.event?"onkeydown":"onkeypress"]=this.onTiddlerKeyPress,o.innerHTML=this.getTemplateForTiddler(e,t,s),applyHtmlMacros(o,s),store.getTaggedTiddlers(e).length>0?jQuery(o).addClass("isTag"):jQuery(o).removeClass("isTag"),store.tiddlerExists(e)?(jQuery(o).removeClass("shadow"),jQuery(o).removeClass("missing")):jQuery(o).addClass(store.isShadowTiddler(e)?"shadow":"missing"),r&&this.addCustomFields(o,r)}}return o},Story.prototype.addCustomFields=function(e,t){var i=t.decodeHashMap(),r=createTiddlyElement(e,"div",null,"customFields");r.style.display="none";var n;for(n in i){var o=document.createElement("input");o.setAttribute("type","text"),o.setAttribute("value",i[n]),r.appendChild(o),o.setAttribute("edit",n)}},Story.prototype.refreshAllTiddlers=function(e){for(var t=this.getContainer().firstChild;t;){var i=t.getAttribute("template");i&&"true"!=t.getAttribute("dirty")&&this.refreshTiddler(t.getAttribute("tiddler"),e?null:i,!0),t=t.nextSibling}},Story.prototype.onTiddlerMouseOver=function(){jQuery(this).addClass("selected")},Story.prototype.onTiddlerMouseOut=function(){jQuery(this).removeClass("selected")},Story.prototype.onTiddlerDblClick=function(e){var t=e||window.event,i=resolveTarget(t);return i&&"input"!=i.nodeName.toLowerCase()&&"textarea"!=i.nodeName.toLowerCase()?(document.selection&&document.selection.empty&&document.selection.empty(),config.macros.toolbar.invokeCommand(this,"defaultCommand",t),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),!0):!1},Story.prototype.onTiddlerKeyPress=function(e){var t=e||window.event;clearMessage();var i=!1,r=this.getAttribute("tiddler"),n=resolveTarget(t);switch(t.keyCode){case 9:var o=story.getTiddlerField(r,"text");"input"==n.tagName.toLowerCase()&&o.value==config.views.editor.defaultText.format([r])&&(o.focus(),o.select(),i=!0),config.options.chkInsertTabs&&"textarea"==n.tagName.toLowerCase()&&(replaceSelection(n,String.fromCharCode(9)),i=!0),config.isOpera&&(n.onblur=function(){this.focus(),this.onblur=null});break;case 13:case 10:case 77:t.ctrlKey&&(blurElement(this),config.macros.toolbar.invokeCommand(this,"defaultCommand",t),i=!0);break;case 27:blurElement(this),config.macros.toolbar.invokeCommand(this,"cancelCommand",t),i=!0}return t.cancelBubble=i,i&&(t.stopPropagation&&t.stopPropagation(),t.returnValue=!0,t.preventDefault&&t.preventDefault()),!i},Story.prototype.getTiddlerField=function(e,t){var i=this.getTiddler(e),r=null;if(i){var n,o=i.getElementsByTagName("*");for(n=0;n<o.length;n++){var a=o[n];("input"==a.tagName.toLowerCase()||"textarea"==a.tagName.toLowerCase())&&(r||(r=a),a.getAttribute("edit")==t&&(r=a))}}return r},Story.prototype.focusTiddler=function(e,t){var i=this.getTiddlerField(e,t);i&&(i.focus(),i.select())},Story.prototype.blurTiddler=function(e){var t=this.getTiddler(e);t&&t.focus&&t.blur&&(t.focus(),t.blur())},Story.prototype.setTiddlerField=function(e,t,i,r){var n=this.getTiddlerField(e,r),o=n.value.readBracketedList();o.setItem(t,i),n.value=String.encodeTiddlyLinkList(o)},Story.prototype.setTiddlerTag=function(e,t,i){this.setTiddlerField(e,t,i,"tags")},Story.prototype.closeTiddler=function(e,t){var i=this.getTiddler(e);i&&(clearMessage(),this.scrubTiddler(i),config.options.chkAnimate&&t&&anim&&"function"==typeof Slider?anim.startAnimating(new Slider(i,!1,null,"all")):jQuery(i).remove())},Story.prototype.scrubTiddler=function(e){e.id=null},Story.prototype.setDirty=function(e,t){var i=this.getTiddler(e);i&&i.setAttribute("dirty",t?"true":"false")},Story.prototype.isDirty=function(e){var t=this.getTiddler(e);return t?"true"==t.getAttribute("dirty"):null},Story.prototype.areAnyDirty=function(){var e=!1;return this.forEachTiddler(function(t){this.isDirty(t)&&(e=!0)}),e},Story.prototype.closeAllTiddlers=function(e){clearMessage(),this.forEachTiddler(function(t,i){t!=e&&"true"!=i.getAttribute("dirty")&&this.closeTiddler(t)}),window.scrollTo(0,ensureVisible(this.container))},Story.prototype.isEmpty=function(){var e=this.getContainer();return e&&null==e.firstChild},Story.prototype.search=function(e,t,i){this.closeAllTiddlers(),highlightHack=new RegExp(i?e:e.escapeRegExp(),t?"mg":"img");var r=store.search(highlightHack,"title","excludeSearch");this.displayTiddlers(null,r),highlightHack=null;var n=i?"/":"'";displayMessage(r.length>0?config.macros.search.successMsg.format([r.length.toString(),n+e+n]):config.macros.search.failureMsg.format([n+e+n]))},Story.prototype.findContainingTiddler=function(e){for(;e&&!jQuery(e).hasClass("tiddler");)e=jQuery(e).hasClass("popup")&&Popup.stack[0]?Popup.stack[0].root:e.parentNode;return e},Story.prototype.gatherSaveFields=function(e,t){if(e&&e.getAttribute){var i=e.getAttribute("edit");if(i&&(t[i]=e.value.replace(/\r/gm,"")),e.hasChildNodes()){var r,n=e.childNodes;for(r=0;r<n.length;r++)this.gatherSaveFields(n[r],t)}}},Story.prototype.hasChanges=function(e){var t=this.getTiddler(e);if(t){var i={};if(this.gatherSaveFields(t,i),!store.fetchTiddler(e))return store.isShadowTiddler(e)&&store.getShadowTiddlerText(e)==i.text?!1:!0;var r;for(r in i)if(store.getValue(e,r)!=i[r])return!0}return!1},Story.prototype.saveTiddler=function(e,t){var i=this.getTiddler(e);if(i){var r={};this.gatherSaveFields(i,r);var n=r.title||e;if(!store.tiddlerExists(n)){n=n.trim();var o=config.options.txtUserName}if(store.tiddlerExists(n)&&n!=e){if(!confirm(config.messages.overwriteWarning.format([n.toString()])))return null;e=n}n!=e&&this.closeTiddler(n,!1),i.id=this.tiddlerId(n),i.setAttribute("tiddler",n),i.setAttribute("template",DEFAULT_VIEW_TEMPLATE),i.setAttribute("dirty","false"),config.options.chkForceMinorUpdate&&(t=!t),store.tiddlerExists(n)||(t=!1);var a=new Date;if(store.tiddlerExists(e)){var s=store.fetchTiddler(e),l=s.fields;o=s.creator}else l=merge({},config.defaultCustomFields);var d;for(d in r)TiddlyWiki.isStandardField(d)||(l[d]=r[d]);var c=store.saveTiddler(e,n,r.text,t?void 0:config.options.txtUserName,t?void 0:a,r.tags,l,null,null,o);return autoSaveChanges(null,[c]),n}return null},Story.prototype.permaView=function(){var e=[];this.forEachTiddler(function(t){e.push(String.encodeTiddlyLink(t))});var t=encodeURIComponent(e.join(" "));""==t&&(t="#"),window.location.hash!=t&&(window.location.hash=t)},Story.prototype.switchTheme=function(e){if(!safeMode){var t,i=function(e,t){var i;return readOnly&&(i=store.getTiddlerSlice(e,t+"ReadOnly")||store.getTiddlerSlice(e,"Web"+t)),i=i||store.getTiddlerSlice(e,t),i&&0==i.indexOf(config.textPrimitives.sectionSeparator)&&(i=e+i),store.isAvailable(i)?i:t},r=function(e,t,r,n){var o=i(r,n);return t!=o&&store.namedNotifications[e].name==t?(store.namedNotifications[e].name=o,o):t},n=config.refresherData.pageTemplate,o=DEFAULT_VIEW_TEMPLATE,a=config.tiddlerTemplates[o],s=DEFAULT_EDIT_TEMPLATE,l=config.tiddlerTemplates[s];for(t=0;t<config.notifyTiddlers.length;t++){var d=config.notifyTiddlers[t].name;switch(d){case"PageTemplate":config.refresherData.pageTemplate=r(t,config.refresherData.pageTemplate,e,d);break;case"StyleSheet":removeStyleSheet(config.refresherData.styleSheet),config.refresherData.styleSheet=r(t,config.refresherData.styleSheet,e,d);break;case"ColorPalette":config.refresherData.colorPalette=r(t,config.refresherData.colorPalette,e,d)}}config.tiddlerTemplates[o]=i(e,"ViewTemplate"),config.tiddlerTemplates[s]=i(e,"EditTemplate"),startingUp||(config.refresherData.pageTemplate!=n||config.tiddlerTemplates[o]!=a||config.tiddlerTemplates[s]!=l?(refreshAll(),this.refreshAllTiddlers(!0)):setStylesheet(store.getRecursiveTiddlerText(config.refresherData.styleSheet,"",10),config.refreshers.styleSheet),config.options.txtTheme=e,saveOption("txtTheme"))}},config.tasks.save.action=saveChanges;var backstage={area:null,toolbar:null,button:null,showButton:null,hideButton:null,cloak:null,panel:null,panelBody:null,panelFooter:null,currTabName:null,currTabElem:null,content:null,init:function(){var e=config.messages.backstage;this.area=document.getElementById("backstageArea"),this.toolbar=jQuery("#backstageToolbar").empty()[0],this.button=jQuery("#backstageButton").empty()[0],this.button.style.display="block";var t=e.open.text+" "+glyph("bentArrowLeft");for(this.showButton=createTiddlyButton(this.button,t,e.open.tooltip,function(){return backstage.show(),!1},null,"backstageShow"),t=glyph("bentArrowRight")+" "+e.close.text,this.hideButton=createTiddlyButton(this.button,t,e.close.tooltip,function(){return backstage.hide(),!1
},null,"backstageHide"),this.cloak=document.getElementById("backstageCloak"),this.panel=document.getElementById("backstagePanel"),this.panelFooter=createTiddlyElement(this.panel,"div",null,"backstagePanelFooter"),this.panelBody=createTiddlyElement(this.panel,"div",null,"backstagePanelBody"),this.cloak.onmousedown=function(){backstage.switchTab(null)},createTiddlyText(this.toolbar,e.prompt),t=0;t<config.backstageTasks.length;t++){var i=config.backstageTasks[t],r=config.tasks[i],n=r.action?this.onClickCommand:this.onClickTab,o=r.text+(r.action?"":glyph("downTriangle")),a=createTiddlyButton(this.toolbar,o,r.tooltip,n,"backstageTab");jQuery(a).addClass(r.action?"backstageAction":"backstageTask"),a.setAttribute("task",i)}this.content=document.getElementById("contentWrapper"),config.options.chkBackstage?this.show():this.hide()},isVisible:function(){return this.area?"block"==this.area.style.display:!1},show:function(){if(this.area.style.display="block",anim&&config.options.chkAnimate){backstage.toolbar.style.left=findWindowWidth()+"px";var e=[{style:"left",start:findWindowWidth(),end:0,template:"%0px"}];anim.startAnimating(new Morpher(backstage.toolbar,config.animDuration,e))}else backstage.area.style.left="0px";jQuery(this.showButton).hide(),jQuery(this.hideButton).show(),config.options.chkBackstage=!0,saveOption("chkBackstage"),jQuery(this.content).addClass("backstageVisible")},hide:function(){if(this.currTabElem)this.switchTab(null);else{if(backstage.toolbar.style.left="0px",anim&&config.options.chkAnimate){var e=[{style:"left",start:0,end:findWindowWidth(),template:"%0px"}],t=function(){backstage.area.style.display="none"};anim.startAnimating(new Morpher(backstage.toolbar,config.animDuration,e,t))}else this.area.style.display="none";this.showButton.style.display="block",this.hideButton.style.display="none",config.options.chkBackstage=!1,saveOption("chkBackstage"),jQuery(this.content).removeClass("backstageVisible")}},onClickCommand:function(){var e=config.tasks[this.getAttribute("task")];return e.action&&(backstage.switchTab(null),e.action()),!1},onClickTab:function(){return backstage.switchTab(this.getAttribute("task")),!1},switchTab:function(e){for(var t=null,i=this.toolbar.firstChild;i;)i.getAttribute&&i.getAttribute("task")==e&&(t=i),i=i.nextSibling;if(e==backstage.currTabName)return void backstage.hidePanel();if(backstage.currTabElem&&jQuery(this.currTabElem).removeClass("backstageSelTab"),t&&e){backstage.preparePanel(),jQuery(t).addClass("backstageSelTab");var r=config.tasks[e];wikify(r.content,backstage.panelBody,null,null),backstage.showPanel()}else backstage.currTabElem&&backstage.hidePanel();backstage.currTabName=e,backstage.currTabElem=t},isPanelVisible:function(){return backstage.panel?"block"==backstage.panel.style.display:!1},preparePanel:function(){return backstage.cloak.style.height=findDocHeight()+"px",backstage.cloak.style.display="block",jQuery(backstage.panelBody).empty(),backstage.panelBody},showPanel:function(){if(backstage.panel.style.display="block",anim&&config.options.chkAnimate){backstage.panel.style.top=-backstage.panel.offsetHeight+"px";var e=[{style:"top",start:-backstage.panel.offsetHeight,end:0,template:"%0px"}];anim.startAnimating(new Morpher(backstage.panel,config.animDuration,e),new Scroller(backstage.panel,!1))}else backstage.panel.style.top="0px";return backstage.panelBody},hidePanel:function(){if(backstage.currTabElem&&jQuery(backstage.currTabElem).removeClass("backstageSelTab"),backstage.currTabElem=null,backstage.currTabName=null,anim&&config.options.chkAnimate){var e=[{style:"top",start:0,end:-backstage.panel.offsetHeight,template:"%0px"},{style:"display",atEnd:"none"}],t=function(){backstage.cloak.style.display="none"};anim.startAnimating(new Morpher(backstage.panel,config.animDuration,e,t))}else jQuery([backstage.panel,backstage.cloak]).hide()}};config.macros.backstage={},config.macros.backstage.handler=function(e,t,i){var r=config.tasks[i[0]];r&&createTiddlyButton(e,r.text,r.tooltip,function(){return backstage.switchTab(i[0]),!1})},config.macros.importTiddlers.handler=function(e){if(readOnly)return void createTiddlyElement(e,"div",null,"marked",this.readOnlyWarning);var t=new Wizard;t.createWizard(e,this.wizardTitle),this.restart(t)},config.macros.importTiddlers.onCancel=function(){var e=new Wizard(this);return e.clear(),config.macros.importTiddlers.restart(e),!1},config.macros.importTiddlers.onClose=function(){return backstage.hidePanel(),!1},config.macros.importTiddlers.restart=function(e){var t=config.macros.importTiddlers;e.addStep(this.step1Title,this.step1Html);var i,r=e.getElement("selTypes");for(i in config.adaptors){var n=createTiddlyElement(r,"option",null,null,config.adaptors[i].serverLabel||i);n.value=i}config.defaultAdaptor&&(r.value=config.defaultAdaptor),r=e.getElement("selFeeds");var o=this.getFeeds();for(i in o)n=createTiddlyElement(r,"option",null,null,i),n.value=i;e.setValue("feeds",o),r.onchange=t.onFeedChange;var a=e.getElement("txtBrowse");a.onchange=t.onBrowseChange,a.onkeyup=t.onBrowseChange,e.setButtons([{caption:this.openLabel,tooltip:this.openPrompt,onClick:t.onOpen}]),e.formElem.action="javascript:;",e.formElem.onsubmit=function(){(!this.txtPath||this.txtPath.value.length)&&this.lastChild.firstChild.onclick()}},config.macros.importTiddlers.getFeeds=function(){var e,t={},i=store.getTaggedTiddlers("systemServer","title");for(e=0;e<i.length;e++){var r=i[e].title,n=store.getTiddlerSlice(r,"Type");n||(n="file"),t[r]={title:r,url:store.getTiddlerSlice(r,"URL"),workspace:store.getTiddlerSlice(r,"Workspace"),workspaceList:store.getTiddlerSlice(r,"WorkspaceList"),tiddlerFilter:store.getTiddlerSlice(r,"TiddlerFilter"),serverType:n,description:store.getTiddlerSlice(r,"Description")}}return t},config.macros.importTiddlers.onFeedChange=function(){var e=new Wizard(this),t=e.getElement("selTypes"),i=e.getElement("txtPath"),r=e.getValue("feeds"),n=r[this.value];return n&&(t.value=n.serverType,i.value=n.url,e.setValue("feedName",n.serverType),e.setValue("feedHost",n.url),e.setValue("feedWorkspace",n.workspace),e.setValue("feedWorkspaceList",n.workspaceList),e.setValue("feedTiddlerFilter",n.tiddlerFilter)),!1},config.macros.importTiddlers.onBrowseChange=function(){var e=new Wizard(this),t=this.value;if(t=t.replace(/^C:\\fakepath\\/i,""),this.files&&this.files[0])try{netscape.security.PrivilegeManager.enablePrivilege("UniversalFileRead"),t=this.files[0].fileName}catch(i){var r=getLocalPath(document.location.href),n=r.lastIndexOf("/");-1==n&&(n=r.lastIndexOf("\\")),-1!=n&&(r=r.substr(0,n+1)),t=r+t}var o=e.getElement("txtPath");o.value=config.macros.importTiddlers.getURLFromLocalPath(t);var a=e.getElement("selTypes");return a.value="file",!0},config.macros.importTiddlers.getURLFromLocalPath=function(e){if(!e||!e.length)return e;e=e.replace(/\\/g,"/");var t,i=e.split(":"),r=i[1]||i[0];if(!i[1]||"http"!=i[0]&&"https"!=i[0]&&"file"!=i[0])if("/"==r.substr(0,1))t=document.location.protocol+"//"+document.location.hostname+(i[1]?"/":"")+e;else{var n=document.location.href.replace(/\\/g,"/"),o=n.lastIndexOf("/");-1!=o&&(n=n.substr(0,o)),t=n+"/"+r}else t=e;return t},config.macros.importTiddlers.onOpen=function(){var e=config.macros.importTiddlers,t=new Wizard(this),i=t.getElement("txtPath"),r=i.value,n=t.getElement("selTypes").value||config.defaultAdaptor,o=new config.adaptors[n];return t.setValue("adaptor",o),t.setValue("serverType",n),t.setValue("host",r),o.openHost(r,null,t,e.onOpenHost),t.setButtons([{caption:e.cancelLabel,tooltip:e.cancelPrompt,onClick:e.onCancel}],e.statusOpenHost),!1},config.macros.importTiddlers.onOpenHost=function(e,t){var i=config.macros.importTiddlers,r=t.getValue("adaptor");e.status!==!0&&displayMessage("Error in importTiddlers.onOpenHost: "+e.statusText),r.getWorkspaceList(e,t,i.onGetWorkspaceList),t.setButtons([{caption:i.cancelLabel,tooltip:i.cancelPrompt,onClick:i.onCancel}],i.statusGetWorkspaceList)},config.macros.importTiddlers.onGetWorkspaceList=function(e,t){var i=config.macros.importTiddlers;e.status!==!0&&displayMessage("Error in importTiddlers.onGetWorkspaceList: "+e.statusText),t.setValue("context",e);var r=t.getValue("feedWorkspace");if(r||1!=e.workspaces.length||(r=e.workspaces[0].title),r)return e.adaptor.openWorkspace(r,e,t,i.onOpenWorkspace),t.setValue("workspace",r),void t.setButtons([{caption:i.cancelLabel,tooltip:i.cancelPrompt,onClick:i.onCancel}],i.statusOpenWorkspace);t.addStep(i.step2Title,i.step2Html);var n,o=t.getElement("selWorkspace");for(o.onchange=i.onWorkspaceChange,n=0;n<e.workspaces.length;n++){var a=createTiddlyElement(o,"option",null,null,e.workspaces[n].title);a.value=e.workspaces[n].title}var s=t.getValue("feedWorkspaceList");if(s){var l,d=s.parseParams("workspace",null,!1,!0);for(l=1;l<d.length;l++)null==e.workspaces.findByField("title",d[l].value)&&(a=createTiddlyElement(o,"option",null,null,d[l].value),a.value=d[l].value)}r&&(n=t.getElement("txtWorkspace"),n.value=r),t.setButtons([{caption:i.openLabel,tooltip:i.openPrompt,onClick:i.onChooseWorkspace}])},config.macros.importTiddlers.onWorkspaceChange=function(){var e=new Wizard(this),t=e.getElement("txtWorkspace");return t.value=this.value,this.selectedIndex=0,!1},config.macros.importTiddlers.onChooseWorkspace=function(){var e=config.macros.importTiddlers,t=new Wizard(this),i=t.getValue("adaptor"),r=t.getElement("txtWorkspace").value;t.setValue("workspace",r);var n=t.getValue("context");return i.openWorkspace(r,n,t,e.onOpenWorkspace),t.setButtons([{caption:e.cancelLabel,tooltip:e.cancelPrompt,onClick:e.onCancel}],e.statusOpenWorkspace),!1},config.macros.importTiddlers.onOpenWorkspace=function(e,t){var i=config.macros.importTiddlers;e.status!==!0&&displayMessage("Error in importTiddlers.onOpenWorkspace: "+e.statusText);var r=t.getValue("adaptor");r.getTiddlerList(e,t,i.onGetTiddlerList,t.getValue("feedTiddlerFilter")),t.setButtons([{caption:i.cancelLabel,tooltip:i.cancelPrompt,onClick:i.onCancel}],i.statusGetTiddlerList)},config.macros.importTiddlers.onGetTiddlerList=function(e,t){var i=config.macros.importTiddlers;if(e.status!==!0){var r=e.statusText||i.errorGettingTiddlerList;return r=0===e.host.indexOf("file://")?i.errorGettingTiddlerListFile:e.xhr&&404==e.xhr.status?i.errorGettingTiddlerListHttp404:i.errorGettingTiddlerListHttp,t.setButtons([{caption:i.cancelLabel,tooltip:i.cancelPrompt,onClick:i.onCancel}],""),void jQuery("span.status",t.footerEl).html(r)}var n=[];if(e.tiddlers){var o;for(o=0;o<e.tiddlers.length;o++){var a=e.tiddlers[o];n.push({title:a.title,modified:a.modified,modifier:a.modifier,text:a.text?wikifyPlainText(a.text,100):"",tags:a.tags,size:a.text?a.text.length:0,tiddler:a})}}n.sort(function(e,t){return e.title<t.title?-1:e.title==t.title?0:1}),t.addStep(i.step3Title,i.step3Html);var s=t.getElement("markList"),l=document.createElement("div");s.parentNode.insertBefore(l,s);var d=ListView.create(l,n,i.listViewTemplate);t.setValue("listView",d),t.setValue("context",e);var c=t.getElement("txtSaveTiddler");c.value=i.generateSystemServerName(t),t.setButtons([{caption:i.cancelLabel,tooltip:i.cancelPrompt,onClick:i.onCancel},{caption:i.importLabel,tooltip:i.importPrompt,onClick:i.doImport}])},config.macros.importTiddlers.generateSystemServerName=function(e){var t=e.getValue("serverType"),i=e.getValue("host"),r=e.getValue("workspace"),n=config.macros.importTiddlers[r?"systemServerNamePattern":"systemServerNamePatternNoWorkspace"];return n.format([t,i,r])},config.macros.importTiddlers.saveServerTiddler=function(e){var t=config.macros.importTiddlers,i=e.getElement("txtSaveTiddler").value;if(store.tiddlerExists(i)){if(!confirm(t.confirmOverwriteSaveTiddler.format([i])))return;store.suspendNotifications(),store.removeTiddler(i),store.resumeNotifications()}var r=e.getValue("serverType"),n=e.getValue("host"),o=e.getValue("workspace"),a=t.serverSaveTemplate.format([r,n,o]);store.saveTiddler(i,i,a,t.serverSaveModifier,new Date,["systemServer"])},config.macros.importTiddlers.doImport=function(){var e=config.macros.importTiddlers,t=new Wizard(this);t.getElement("chkSave").checked&&e.saveServerTiddler(t);var i=t.getElement("chkSync").checked;t.setValue("sync",i);var r,n=t.getValue("listView"),o=ListView.getSelectedRows(n),a=t.getValue("adaptor"),s=[];for(r=0;r<o.length;r++)store.tiddlerExists(o[r])&&s.push(o[r]);if(s.length>0&&!confirm(e.confirmOverwriteText.format([s.join(", ")])))return!1;for(t.addStep(e.step4Title.format([o.length]),e.step4Html),r=0;r<o.length;r++){var l=document.createElement("div");createTiddlyLink(l,o[r],!0);var d=t.getElement("markReport");d.parentNode.insertBefore(l,d)}t.setValue("remainingImports",o.length),t.setButtons([{caption:e.cancelLabel,tooltip:e.cancelPrompt,onClick:e.onCancel}],e.statusDoingImport);var c=t.getValue("context"),u=c?c.tiddlers:[];for(r=0;r<o.length;r++){var p={allowSynchronous:!0,tiddler:u[u.findByField("title",o[r])]};a.getTiddler(o[r],p,t,e.onGetTiddler)}return!1},config.macros.importTiddlers.onGetTiddler=function(e,t){var i=config.macros.importTiddlers;e.status||displayMessage("Error in importTiddlers.onGetTiddler: "+e.statusText);var r=e.tiddler;store.suspendNotifications(),store.saveTiddler(r.title,r.title,r.text,r.modifier,r.modified,r.tags,r.fields,!0,r.created),t.getValue("sync")||store.setValue(r.title,"server",null),store.resumeNotifications(),e.isSynchronous||store.notify(r.title,!0);var n=t.getValue("remainingImports")-1;t.setValue("remainingImports",n),0==n&&(e.isSynchronous&&(store.notifyAll(),refreshDisplay()),t.setButtons([{caption:i.doneLabel,tooltip:i.donePrompt,onClick:i.onClose}],i.statusDoneImport),autoSaveChanges())},config.macros.upgrade.handler=function(e){var t=new Wizard;t.createWizard(e,this.wizardTitle),t.addStep(this.step1Title,this.step1Html.format([this.source,this.source])),t.setButtons([{caption:this.upgradeLabel,tooltip:this.upgradePrompt,onClick:this.onClickUpgrade}])},config.macros.upgrade.onClickUpgrade=function(){var e=config.macros.upgrade,t=new Wizard(this);if(!window.allowSave())return alert(e.errorCantUpgrade),!1;if(story.areAnyDirty()||store.isDirty())return alert(e.errorNotSaved),!1;var i=getLocalPath(document.location.toString()),r=getBackupPath(i,e.backupExtension);t.setValue("backupPath",r),t.setButtons([],e.statusPreparingBackup);var n=loadOriginal(i);t.setButtons([],e.statusSavingBackup);var o=copyFile(r,i);if(o||(o=saveFile(r,n)),!o)return t.setButtons([],e.errorSavingBackup),alert(e.errorSavingBackup),!1;t.setButtons([],e.statusLoadingCore);var a={type:"GET",url:e.source,processData:!1,success:function(i,r,n){e.onLoadCore(!0,t,n.responseText,e.source,n)},error:function(i){e.onLoadCore(!1,t,null,e.source,i)}};return ajaxReq(a),!1},config.macros.upgrade.onLoadCore=function(e,t,i){var r,n=config.macros.upgrade,o=t;e||(r=n.errorLoadingCore);var a=n.extractVersion(i);if(a||(r=n.errorCoreFormat),r)return o.setButtons([],r),void alert(r);var s=function(){o.setButtons([],n.statusSavingCore);var e=getLocalPath(document.location.toString());saveFile(e,i),o.setButtons([],n.statusReloadingCore);var t=o.getValue("backupPath"),r=document.location.toString()+"?time="+(new Date).convertToYYYYMMDDHHMM()+"#upgrade:[["+encodeURI(t)+"]]";window.setTimeout(function(){window.location=r},10)},l=[n.step2Html_downgrade,n.step2Html_restore,n.step2Html_upgrade][compareVersions(version,a)+1];o.addStep(n.step2Title,l.format([formatVersion(a),formatVersion(version)])),o.setButtons([{caption:n.startLabel,tooltip:n.startPrompt,onClick:s},{caption:n.cancelLabel,tooltip:n.cancelPrompt,onClick:n.onCancel}])},config.macros.upgrade.onCancel=function(){var e=config.macros.upgrade,t=new Wizard(this);return t.addStep(e.step3Title,e.step3Html),t.setButtons([]),!1},config.macros.upgrade.extractVersion=function(e){var t=/^var version = \{title: "([^"]+)", major: (\d+), minor: (\d+), revision: (\d+)(, beta: (\d+)){0,1}, date: new Date\("([^"]+)"\)/gm,i=t.exec(e);return i?{title:i[1],major:i[2],minor:i[3],revision:i[4],beta:i[6],date:new Date(i[7])}:null},config.macros.plugins.handler=function(e,t,i,r,n){var o=new Wizard;o.createWizard(e,this.wizardTitle),o.addStep(this.step1Title,this.step1Html);var a=o.getElement("markList"),s=document.createElement("div");a.parentNode.insertBefore(s,a),s.setAttribute("refresh","macro"),s.setAttribute("macroName","plugins"),s.setAttribute("params",n),this.refresh(s,n)},config.macros.plugins.refresh=function(e,t){var i=config.macros.plugins,r=new Wizard(e),n=[];ListView.forEachSelector(e,function(e){e.checked&&n.push(e.getAttribute("rowName"))}),jQuery(e).empty(),t=t.parseParams("anon");var o,a,s,l=installedPlugins.slice(0),d=store.getTaggedTiddlers("systemConfig");for(o=0;o<d.length;o++)a=d[o],null==l.findByField("title",a.title)&&(s=getPluginInfo(a),s.executed=!1,s.log.splice(0,0,this.skippedText),l.push(s));for(o=0;o<l.length;o++)s=l[o],s.size=s.tiddler.text?s.tiddler.text.length:0,s.forced=s.tiddler.isTagged("systemConfigForce"),s.disabled=s.tiddler.isTagged("systemConfigDisable"),s.Selected=-1!=n.indexOf(l[o].title);if(0==l.length)createTiddlyElement(e,"em",null,null,this.noPluginText),r.setButtons([]);else{var c=readOnly?this.listViewTemplateReadOnly:this.listViewTemplate,u=ListView.create(e,l,c,this.onSelectCommand);r.setValue("listView",u),readOnly||r.setButtons([{caption:i.removeLabel,tooltip:i.removePrompt,onClick:i.doRemoveTag},{caption:i.deleteLabel,tooltip:i.deletePrompt,onClick:i.doDelete}])}},config.macros.plugins.doRemoveTag=function(){var e=new Wizard(this),t=e.getValue("listView"),i=ListView.getSelectedRows(t);if(0==i.length)alert(config.messages.nothingSelected);else{var r;for(r=0;r<i.length;r++)store.setTiddlerTag(i[r],!1,"systemConfig");autoSaveChanges()}},config.macros.plugins.doDelete=function(){var e=new Wizard(this),t=e.getValue("listView"),i=ListView.getSelectedRows(t);if(0==i.length)alert(config.messages.nothingSelected);else{if(confirm(config.macros.plugins.confirmDeleteText.format([i.join(", ")]))){var r;for(r=0;r<i.length;r++)store.removeTiddler(i[r]),story.closeTiddler(i[r],!0)}autoSaveChanges()}},config.notifyTiddlers=[{name:"SystemSettings",notify:onSystemSettingsChange},{name:"StyleSheetLayout",notify:refreshStyles},{name:"StyleSheetColors",notify:refreshStyles},{name:"StyleSheet",notify:refreshStyles},{name:"StyleSheetPrint",notify:refreshStyles},{name:"PageTemplate",notify:refreshPageTemplate},{name:"SiteTitle",notify:refreshPageTitle},{name:"SiteSubtitle",notify:refreshPageTitle},{name:"WindowTitle",notify:refreshPageTitle},{name:"ColorPalette",notify:refreshColorPalette},{name:null,notify:refreshDisplay}],config.refreshers={link:function(e){var t=e.getAttribute("tiddlyLink");return refreshTiddlyLink(e,t),!0},tiddler:function(e,t){var i=e.getAttribute("tiddler"),r=e.getAttribute("template");return t&&t.indexOf&&-1!=t.indexOf(i)&&!story.isDirty(i)?story.refreshTiddler(i,r,!0):refreshElements(e,t),!0},content:function(e,t){var i=e.getAttribute("tiddler"),r=e.getAttribute("force"),n=e.getAttribute("args");return null!=r||null==t||t.indexOf&&-1!=t.indexOf(i)?(jQuery(e).empty(),config.macros.tiddler.transclude(e,i,n),!0):!1},macro:function(e){var t=e.getAttribute("macroName"),i=e.getAttribute("params");return t&&(t=config.macros[t]),t&&t.refresh&&t.refresh(e,i),!0}},config.refresherData={styleSheet:"StyleSheet",defaultStyleSheet:"StyleSheet",pageTemplate:"PageTemplate",defaultPageTemplate:"PageTemplate",colorPalette:"ColorPalette",defaultColorPalette:"ColorPalette"},config.optionHandlers={txt:{get:function(e){return encodeCookie(config.options[e].toString())},set:function(e,t){config.options[e]=decodeCookie(t)}},chk:{get:function(e){return config.options[e]?"true":"false"},set:function(e,t){config.options[e]="true"==t}}};var loadOptionsCookie=loadOptions,saveOptionCookie=saveOption,systemSettingSave;config.macros.option.genericCreate=function(e,t,i,r,n){var o=config.macros.option.types[t],a=document.createElement(o.elementType);return o.typeValue&&a.setAttribute("type",o.typeValue),a[o.eventName]=o.onChange,a.setAttribute("option",i),a.className=r||o.className,config.optionsDesc[i]&&a.setAttribute("title",config.optionsDesc[i]),e.appendChild(a),"no"!=n&&createTiddlyText(e,config.optionsDesc[i]||i),a[o.valueField]=config.options[i],a},config.macros.option.genericOnChange=function(){var e=this.getAttribute("option");if(e){var t=e.substr(0,3),i=config.macros.option.types[t];i.elementType&&i.valueField&&config.macros.option.propagateOption(e,i.valueField,this[i.valueField],i.elementType,this)}return!0},config.macros.option.types={txt:{elementType:"input",valueField:"value",eventName:"onchange",className:"txtOptionInput",create:config.macros.option.genericCreate,onChange:config.macros.option.genericOnChange},chk:{elementType:"input",valueField:"checked",eventName:"onclick",className:"chkOptionInput",typeValue:"checkbox",create:config.macros.option.genericCreate,onChange:config.macros.option.genericOnChange}},config.macros.option.propagateOption=function(e,t,i,r,n){config.options[e]=i,saveOption(e);var o,a=document.getElementsByTagName(r);for(o=0;o<a.length;o++){var s=a[o].getAttribute("option");e==s&&a[o]!=n&&(a[o][t]=i)}},config.macros.option.handler=function(e,t,i,r,n){i=n.parseParams("anon",null,!0,!1,!1);var o=i[1]&&"anon"==i[1].name?i[1].value:getParam(i,"name",null),a=i[2]&&"anon"==i[2].name?i[2].value:getParam(i,"class",null),s=getParam(i,"desc","no"),l=o.substr(0,3),d=config.macros.option.types[l];d&&d.create&&d.create(e,l,o,a,s)},config.macros.options.handler=function(e,t,i,r,n){i=n.parseParams("anon",null,!0,!1,!1);var o=getParam(i,"showUnknown","no"),a=new Wizard;a.createWizard(e,this.wizardTitle),a.addStep(this.step1Title,this.step1Html);var s=a.getElement("markList"),l=a.getElement("chkUnknown");l.checked="yes"==o,l.onchange=this.onChangeUnknown;var d=document.createElement("div");s.parentNode.insertBefore(d,s),a.setValue("listWrapper",d),this.refreshOptions(d,"yes"==o)},config.macros.options.refreshOptions=function(e,t){var i,r=[];for(i in config.options){var n={};n.option="",n.name=i,n.lowlight=!config.optionsDesc[i],n.description=n.lowlight?this.unknownDescription:config.optionsDesc[i],(!n.lowlight||t)&&r.push(n)}for(r.sort(function(e,t){return e.name.substr(3)<t.name.substr(3)?-1:e.name.substr(3)==t.name.substr(3)?0:1}),ListView.create(e,r,this.listViewTemplate),i=0;i<r.length;i++){var o=r[i].name.substr(0,3),a=config.macros.option.types[o];a&&a.create&&a.create(r[i].colElements.option,o,r[i].name,null,"no")}},config.macros.options.onChangeUnknown=function(){var e=new Wizard(this),t=e.getValue("listWrapper");return jQuery(t).empty(),config.macros.options.refreshOptions(t,this.checked),!1};var saveUsingSafari=!1,startSaveArea='<div id="storeArea">',startSaveAreaRE=/<((div)|(DIV)) ((id)|(ID))=["']?storeArea['"]?>/,endSaveArea="</div>",endSaveAreaCaps="</DIV>";window.getLocalPath=window.getLocalPath||function(e){var t=convertUriToUTF8(e,config.options.txtFileSystemCharSet),i=t.indexOf("?");-1!=i&&(t=t.substr(0,i));var r=t.indexOf("#");-1!=r&&(t=t.substr(0,r)),0==t.indexOf("file://localhost/")&&(t="file://"+t.substr(16));var n;return n=":"==t.charAt(9)?unescape(t.substr(8)).replace(new RegExp("/","g"),"\\"):0==t.indexOf("file://///")?"\\\\"+unescape(t.substr(10)).replace(new RegExp("/","g"),"\\"):0==t.indexOf("file:///")?unescape(t.substr(7)):0==t.indexOf("file:/")?unescape(t.substr(5)):"\\\\"+unescape(t.substr(7)).replace(new RegExp("/","g"),"\\")},tiddlerToRssItem=function(e,t){var i="<title>"+e.title.htmlEncode()+"</title>\n";i+="<description>"+wikifyStatic(e.text,null,e).htmlEncode()+"</description>\n";var r;for(r=0;r<e.tags.length;r++)i+="<category>"+e.tags[r]+"</category>\n";return i+="<link>"+t+"#"+encodeURIComponent(String.encodeTiddlyLink(e.title))+"</link>\n",i+="<pubDate>"+e.modified.toGMTString()+"</pubDate>\n"},window.copyFile=window.copyFile||function(e,t){return config.browser.isIE?ieCopyFile(e,t):!1},window.saveFile=window.saveFile||function(e,t){var i=mozillaSaveFile(e,t);return i||(i=ieSaveFile(e,t)),i||(i=javaSaveFile(e,t)),i},window.loadFile=window.loadFile||function(e){var t=mozillaLoadFile(e);return(null==t||0==t)&&(t=ieLoadFile(e)),(null==t||0==t)&&(t=javaLoadFile(e)),t};var LOG_TIDDLYSAVER=!0;AdaptorBase.prototype.close=function(){return!0},AdaptorBase.prototype.fullHostName=function(e){return e?(e=e.trim(),e.match(/:\/\//)||(e="http://"+e),"/"==e.substr(e.length-1)&&(e=e.substr(0,e.length-1)),e):""},AdaptorBase.minHostName=function(e){return e},AdaptorBase.prototype.setContext=function(e,t,i){return e||(e={}),e.userParams=t,i&&(e.callback=i),e.adaptor=this,e.host||(e.host=this.host),e.host=this.fullHostName(e.host),e.workspace||(e.workspace=this.workspace),e},AdaptorBase.prototype.openHost=function(e,t,i,r){return this.host=e,t=this.setContext(t,i,r),t.status=!0,r&&window.setTimeout(function(){t.callback(t,i)},10),!0},AdaptorBase.prototype.openWorkspace=function(e,t,i,r){return this.workspace=e,t=this.setContext(t,i,r),t.status=!0,r&&window.setTimeout(function(){r(t,i)},10),!0},FileAdaptor.prototype=new AdaptorBase,FileAdaptor.serverType="file",FileAdaptor.serverLabel="TiddlyWiki",FileAdaptor.loadTiddlyWikiSuccess=function(e,t){e.status=!0,e.adaptor.store=new TiddlyWiki,e.adaptor.store.importTiddlyWiki(t.responseText)||(e.statusText=config.messages.invalidFileError.format([e.host]),e.status=!1),e.complete(e,e.userParams)},FileAdaptor.loadTiddlyWikiError=function(e,t){e.status=!1,e.statusText=t.message,e.complete(e,e.userParams)},FileAdaptor.prototype.getWorkspaceList=function(e,t,i){return e=this.setContext(e,t,i),e.workspaces=[{title:"(default)"}],e.status=!0,i&&window.setTimeout(function(){i(e,t)},10),!0},FileAdaptor.prototype.getTiddlerList=function(e,t,i,r){if(e=this.setContext(e,t,i),e.filter||(e.filter=r),e.complete=FileAdaptor.getTiddlerListComplete,this.store)return e.complete(e,e.userParams);var n={type:"GET",url:e.host,processData:!1,success:function(t,i,r){FileAdaptor.loadTiddlyWikiSuccess(e,r)},error:function(t){e.xhr=t,FileAdaptor.loadTiddlyWikiError(e,t)}};return ajaxReq(n)},FileAdaptor.getTiddlerListComplete=function(e,t){if(e.status){e.filter?e.tiddlers=e.adaptor.store.filterTiddlers(e.filter):(e.tiddlers=[],e.adaptor.store.forEachTiddler(function(t,i){e.tiddlers.push(i)}));var i;for(i=0;i<e.tiddlers.length;i++)e.tiddlers[i].fields["server.type"]=FileAdaptor.serverType,e.tiddlers[i].fields["server.host"]=AdaptorBase.minHostName(e.host),e.tiddlers[i].fields["server.page.revision"]=e.tiddlers[i].modified.convertToYYYYMMDDHHMM();e.status=!0}return e.callback&&window.setTimeout(function(){e.callback(e,t)},10),!0},FileAdaptor.prototype.generateTiddlerInfo=function(e){var t={};return t.uri=e.fields["server.host"]+"#"+e.title,t},FileAdaptor.prototype.getTiddler=function(e,t,i,r){if(t=this.setContext(t,i,r),t.title=e,t.complete=FileAdaptor.getTiddlerComplete,t.adaptor.store)return t.complete(t,t.userParams);var n={type:"GET",url:t.host,processData:!1,success:function(e,i,r){FileAdaptor.loadTiddlyWikiSuccess(t,r)},error:function(e){FileAdaptor.loadTiddlyWikiError(t,e)}};return ajaxReq(n)},FileAdaptor.getTiddlerComplete=function(e,t){var i=e.adaptor.store.fetchTiddler(e.title);return i?(i.fields["server.type"]=FileAdaptor.serverType,i.fields["server.host"]=AdaptorBase.minHostName(e.host),i.fields["server.page.revision"]=i.modified.convertToYYYYMMDDHHMM(),e.tiddler=i,e.status=!0):e.status=!1,e.allowSynchronous?(e.isSynchronous=!0,e.callback(e,t)):window.setTimeout(function(){e.callback(e,t)},10),!0},FileAdaptor.prototype.close=function(){this.store=null},config.adaptors[FileAdaptor.serverType]=FileAdaptor,config.defaultAdaptor=FileAdaptor.serverType,Animator.prototype.startAnimating=function(){var e;for(e=0;e<arguments.length;e++)this.animations.push(arguments[e]);if(0==this.running){var t=this;this.timerID=window.setInterval(function(){t.doAnimate(t)},10)}this.running+=arguments.length},Animator.prototype.doAnimate=function(e){for(var t=0;t<e.animations.length;){var i=e.animations[t];i.tick()?t++:(e.animations.splice(t,1),0==--e.running&&window.clearInterval(e.timerID))}},Animator.slowInSlowOut=function(e){return 1-(Math.cos(e*Math.PI)+1)/2},Morpher.prototype.assignStyle=function(e,t,i){switch(t){case"-tw-vertScroll":window.scrollTo(findScrollX(),i);break;case"-tw-horizScroll":window.scrollTo(i,findScrollY());break;default:e.style[t]=i}},Morpher.prototype.stop=function(){var e;for(e=0;e<this.properties.length;e++){var t=this.properties[e];void 0!==t.atEnd&&this.assignStyle(this.element,t.style,t.atEnd)}this.callback&&this.callback(this.element,this.properties)},Morpher.prototype.tick=function(){var e,t=Number(new Date),i=Animator.slowInSlowOut(Math.min(1,(t-this.startTime)/this.duration));for(e=0;e<this.properties.length;e++){var r=this.properties[e];if(void 0!==r.start&&void 0!==r.end){var n=r.template||"%0";switch(r.format){case void 0:case"style":var o=r.start+(r.end-r.start)*i;this.assignStyle(this.element,r.style,n.format([o]));break;case"color":}}}return t>=this.endTime?(this.stop(),!1):!0};var Popup={stack:[]};Popup.create=function(e,t,i){var r=this.find(e,"popup");Popup.remove(r+1);var n=createTiddlyElement(document.body,t||"ol","popup",i||"popup");return n.stackPosition=r,Popup.stack.push({root:e,popup:n}),n},Popup.onDocumentClick=function(e){var t=e||window.event;return void 0==t.eventPhase?Popup.remove():(t.eventPhase==Event.BUBBLING_PHASE||t.eventPhase==Event.AT_TARGET)&&Popup.remove(),!0},Popup.show=function(e,t,i){var r=Popup.stack[Popup.stack.length-1];this.place(r.root,r.popup,e,t,i),jQuery(r.root).addClass("highlight"),config.options.chkAnimate&&anim&&"function"==typeof Scroller?anim.startAnimating(new Scroller(r.popup)):window.scrollTo(0,ensureVisible(r.popup))},Popup.place=function(e,t,i,r,n){n||(n={x:0,y:0}),t.stackPosition>=0&&!i&&!r?n.x=n.x+e.offsetWidth:(n.x="right"==r?n.x+e.offsetWidth:n.x,n.y="top"==i?n.y:n.y+e.offsetHeight);var o=findPosX(e),a=findPosY(e),s=o+n.x,l=a+n.y,d=findWindowWidth();t.offsetWidth>.75*d&&(t.style.width=.75*d+"px");var c=t.offsetWidth,u=d-document.body.offsetWidth;s+c>d-u-1&&(s="right"==r?s-e.offsetWidth-c:d-c-u-1),t.style.left=s+"px",t.style.top=l+"px",t.style.display="block"},Popup.find=function(e){var t,i=-1;for(t=this.stack.length-1;t>=0;t--)isDescendant(e,this.stack[t].popup)&&(i=t);return i},Popup.remove=function(e){e||(e=0),Popup.stack.length>e&&Popup.removeFrom(e)},Popup.removeFrom=function(e){var t;for(t=Popup.stack.length-1;t>=e;t--){var i=Popup.stack[t];jQuery(i.root).removeClass("highlight"),jQuery(i.popup).remove()}Popup.stack=Popup.stack.slice(0,e)},Wizard.prototype.setValue=function(e,t){jQuery(this.formElem).data(e,t)},Wizard.prototype.getValue=function(e){return this.formElem?jQuery(this.formElem).data(e):null},Wizard.prototype.createWizard=function(e,t){return this.formElem=createTiddlyElement(e,"form",null,"wizard"),createTiddlyElement(this.formElem,"h1",null,null,t),this.bodyElem=createTiddlyElement(this.formElem,"div",null,"wizardBody"),this.footElem=createTiddlyElement(this.formElem,"div",null,"wizardFooter"),this.formElem},Wizard.prototype.clear=function(){jQuery(this.bodyElem).empty()},Wizard.prototype.setButtons=function(e,t){jQuery(this.footElem).empty();var i;for(i=0;i<e.length;i++)createTiddlyButton(this.footElem,e[i].caption,e[i].tooltip,e[i].onClick),insertSpacer(this.footElem);"string"==typeof t&&createTiddlyElement(this.footElem,"span",null,"status",t)},Wizard.prototype.addStep=function(e,t){jQuery(this.bodyElem).empty();var i=createTiddlyElement(this.bodyElem,"div");createTiddlyElement(i,"h2",null,null,e);var r=createTiddlyElement(i,"div",null,"wizardStep");r.innerHTML=t,applyHtmlMacros(r,tiddler)},Wizard.prototype.getElement=function(e){return this.formElem.elements[e]};var ListView={};ListView.create=function(e,t,i,r,n){var o,a=createTiddlyElement(e,"table",null,n||"listView twtable"),s=createTiddlyElement(a,"thead"),l=createTiddlyElement(s,"tr");for(o=0;o<i.columns.length;o++){var d=i.columns[o],c=createTiddlyElement(l,"th"),u=ListView.columnTypes[d.type];u&&u.createHeader&&(u.createHeader(c,d,o),d.className&&jQuery(c).addClass(d.className))
}var p,f=createTiddlyElement(a,"tbody");for(p=0;p<t.length;p++){var h=t[p];for(l=createTiddlyElement(f,"tr"),c=0;c<i.rowClasses.length;c++)h[i.rowClasses[c].field]&&jQuery(l).addClass(i.rowClasses[c].className);h.rowElement=l,h.colElements={};var g;for(g=0;g<i.columns.length;g++){c=createTiddlyElement(l,"td"),d=i.columns[g];var m=d.field;u=ListView.columnTypes[d.type],u&&u.createItem&&(u.createItem(c,h,m,d,g,p),d.className&&jQuery(c).addClass(d.className)),h.colElements[m]=c}}if(r&&i.actions&&createTiddlyDropDown(e,ListView.getCommandHandler(r),i.actions),r&&i.buttons)for(o=0;o<i.buttons.length;o++){var y=i.buttons[o];y&&""!=y.name&&createTiddlyButton(e,y.caption,null,ListView.getCommandHandler(r,y.name,y.allowEmptySelection))}return a},ListView.getCommandHandler=function(e,t,i){return function(){var r=findRelated(this,"TABLE",null,"previousSibling"),n=[];ListView.forEachSelector(r,function(e,t){e.checked&&n.push(t)}),0!=n.length||i?"select"==this.nodeName.toLowerCase()?(e(r,this.value,n),this.selectedIndex=0):e(r,t,n):alert(config.messages.nothingSelected)}},ListView.forEachSelector=function(e,t){var i,r=e.getElementsByTagName("input"),n=!1;for(i=0;i<r.length;i++){var o=r[i];if("checkbox"==o.getAttribute("type")){var a=o.getAttribute("rowName");a&&(t(o,a),n=!0)}}return n},ListView.getSelectedRows=function(e){var t=[];return ListView.forEachSelector(e,function(e,i){e.checked&&t.push(i)}),t},ListView.columnTypes={},ListView.columnTypes.String={createHeader:function(e,t){createTiddlyText(e,t.title)},createItem:function(e,t,i){var r=t[i];void 0!=r&&createTiddlyText(e,r)}},ListView.columnTypes.WikiText={createHeader:ListView.columnTypes.String.createHeader,createItem:function(e,t,i){var r=t[i];void 0!=r&&wikify(r,e,null,null)}},ListView.columnTypes.Tiddler={createHeader:ListView.columnTypes.String.createHeader,createItem:function(e,t,i){var r=t[i];void 0!=r&&r.title&&createTiddlyPopup(e,r.title,config.messages.listView.tiddlerTooltip,r)}},ListView.columnTypes.Size={createHeader:ListView.columnTypes.String.createHeader,createItem:function(e,t,i){var r=config.messages.sizeTemplates,n=t[i];if(void 0!=n){for(var o=0;o<r.length-1&&n<r[o].unit;)o++;createTiddlyText(e,r[o].template.format([Math.round(n/r[o].unit)]))}}},ListView.columnTypes.Link={createHeader:ListView.columnTypes.String.createHeader,createItem:function(e,t,i,r){var n=t[i],o=r.text;void 0!=n&&createExternalLink(e,n,o||n)}},ListView.columnTypes.Date={createHeader:ListView.columnTypes.String.createHeader,createItem:function(e,t,i,r){var n=t[i];void 0!=n&&createTiddlyText(e,n.formatString(r.dateFormat))}},ListView.columnTypes.StringList={createHeader:ListView.columnTypes.String.createHeader,createItem:function(e,t,i){var r=t[i];if(void 0!=r){var n;for(n=0;n<r.length;n++)createTiddlyText(e,r[n]),createTiddlyElement(e,"br")}}},ListView.columnTypes.Selector={createHeader:function(e){createTiddlyCheckbox(e,null,!1,this.onHeaderChange)},createItem:function(e,t,i,r){var n=createTiddlyCheckbox(e,null,t[i],null);n.setAttribute("rowName",t[r.rowName])},onHeaderChange:function(){var e=this.checked,t=findRelated(this,"TABLE");t&&ListView.forEachSelector(t,function(t){t.checked=e})}},ListView.columnTypes.Tags={createHeader:ListView.columnTypes.String.createHeader,createItem:function(e,t,i){var r=t[i];createTiddlyText(e,String.encodeTiddlyLinkList(r))}},ListView.columnTypes.Boolean={createHeader:ListView.columnTypes.String.createHeader,createItem:function(e,t,i,r){1==t[i]&&createTiddlyText(e,r.trueText),0==t[i]&&createTiddlyText(e,r.falseText)}},ListView.columnTypes.TagCheckbox={createHeader:ListView.columnTypes.String.createHeader,createItem:function(e,t,i,r){var n=createTiddlyCheckbox(e,null,t[i],this.onChange);n.setAttribute("tiddler",t.title),n.setAttribute("tag",r.tag)},onChange:function(){var e=this.getAttribute("tag"),t=this.getAttribute("tiddler");store.setTiddlerTag(t,this.checked,e)}},ListView.columnTypes.TiddlerLink={createHeader:ListView.columnTypes.String.createHeader,createItem:function(e,t,i,r){var n=t[i];if(void 0!=n){var o=createTiddlyLink(e,t[r.tiddlerLink],!1,null);createTiddlyText(o,t[i])}}},Array.indexOf||(Array.prototype.indexOf=function(e,t){t||(t=0);var i;for(i=t;i<this.length;i++)if(this[i]===e)return i;return-1}),Array.prototype.findByField=function(e,t){var i;for(i=0;i<this.length;i++)if(this[i][e]===t)return i;return null},Array.prototype.contains=function(e){return-1!=this.indexOf(e)},Array.prototype.setItem=function(e,t){var i=this.indexOf(e);0==t&&(t=-1==i?1:-1),1==t?-1==i&&this.push(e):-1==t&&-1!=i&&this.splice(i,1)},Array.prototype.containsAny=function(e){var t;for(t=0;t<e.length;t++)if(-1!=this.indexOf(e[t]))return!0;return!1},Array.prototype.containsAll=function(e){var t;for(t=0;t<e.length;t++)if(-1==this.indexOf(e[t]))return!1;return!0},Array.prototype.pushUnique=function(e,t){t===!1?this.push(e):-1==this.indexOf(e)&&this.push(e)},Array.prototype.remove=function(e){var t=this.indexOf(e);-1!=t&&this.splice(t,1)},Array.prototype.map||(Array.prototype.map=function(e,t){var i,r,n=t||window,o=[];for(i=0,r=this.length;r>i;++i)o.push(e.call(n,this[i],i,this));return o}),String.prototype.right=function(e){return e<this.length?this.slice(this.length-e):this},String.prototype.trim=function(){return this.replace(/^\s*|\s*$/g,"")},String.prototype.unDash=function(){var e,t=this.split("-");if(t.length>1)for(e=1;e<t.length;e++)t[e]=t[e].substr(0,1).toUpperCase()+t[e].substr(1);return t.join("")},String.prototype.format=function(e){var t,i=e&&e.constructor==Array?e:arguments,r=/(?:%(\d+))/gm,n=0,o=[];do t=r.exec(this),t&&t[1]&&(t.index>n&&o.push(this.substring(n,t.index)),o.push(i[parseInt(t[1],10)]),n=r.lastIndex);while(t);return n<this.length&&o.push(this.substring(n,this.length)),o.join("")},String.prototype.escapeRegExp=function(){var e,t="\\^$*+?()=!|,{}[].",i=this;for(e=0;e<t.length;e++)i=i.replace(new RegExp("\\"+t.substr(e,1),"g"),"\\"+t.substr(e,1));return i},String.prototype.escapeLineBreaks=function(){return this.replace(/\\/gm,"\\s").replace(/\n/gm,"\\n").replace(/\r/gm,"")},String.prototype.unescapeLineBreaks=function(){return this.replace(/\\n/gm,"\n").replace(/\\b/gm," ").replace(/\\s/gm,"\\").replace(/\r/gm,"")},String.prototype.htmlEncode=function(){return this.replace(/&/gm,"&").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/\"/gm,"&quot;")},String.prototype.htmlDecode=function(){return this.replace(/&lt;/gm,"<").replace(/&gt;/gm,">").replace(/&quot;/gm,'"').replace(/&/gm,"&")},String.prototype.parseParams=function(e,t,i,r,n){var o,a=function(e,t){var r;if(e[t])r=e[t];else if(e[t+1])r=e[t+1];else if(e[t+2])r=e[t+2];else if(e[t+3])try{r=e[t+3],i&&"none"!=config.evaluateMacroParameters&&("restricted"==config.evaluateMacroParameters?window.restrictedEval&&(r=window.restrictedEval(r)):r=window.eval(r))}catch(n){throw"Unable to evaluate {{"+e[t+3]+"}}: "+exceptionText(n)}else e[t+4]?r=e[t+4]:e[t+5]&&(r="");return r},s=[{}],l='(?:"((?:(?:\\\\")|[^"])+)")',d="(?:'((?:(?:\\\\')|[^'])+)')",c="(?:\\[\\[((?:\\s|\\S)*?)\\]\\])",u="(?:\\{\\{((?:\\s|\\S)*?)\\}\\})",p=r?"([^\"'\\s]\\S*)":"([^\"':\\s][^\\s:]*)",f="((?:\"\")|(?:''))",h="(?:\\s*)",g="(?:"+l+"|"+d+"|"+c+"|"+u+"|"+p+"|"+f+")",m=r?new RegExp(g,"mg"):new RegExp(h+g+h+"(?:(\\:)"+h+g+")?","mg");do if(o=m.exec(this)){var y=a(o,1);if(r)s.push({name:"",value:y});else{var v=a(o,8);null==v&&e?(v=y,y=e):null==v&&t&&(v=t),s.push({name:y,value:v}),n&&(e=y,t=v)}}while(o);var T;for(T=1;T<s.length;T++)s[0][s[T].name]?s[0][s[T].name].push(s[T].value):s[0][s[T].name]=[s[T].value];return s},String.prototype.readMacroParams=function(e){var t,i=this.parseParams("list",null,!e,!0),r=[];for(t=1;t<i.length;t++)r.push(i[t].value);return r},String.prototype.readBracketedList=function(e){var t,i=this.parseParams("list",null,!1,!0),r=[];for(t=1;t<i.length;t++)i[t].value&&r.pushUnique(i[t].value,e);return r},String.prototype.getChunkRange=function(e,t){var i=this.indexOf(e);if(-1!=i){i+=e.length;var r=this.indexOf(t,i);if(-1!=r)return[i,r]}},String.prototype.replaceChunk=function(e,t,i){var r=this.getChunkRange(e,t);return r?this.substring(0,r[0])+i+this.substring(r[1]):this},String.prototype.getChunk=function(e,t){var i=this.getChunkRange(e,t);return i?this.substring(i[0],i[1]):void 0},String.encodeTiddlyLink=function(e){return-1==e.indexOf(" ")?e:"[["+e+"]]"},String.encodeTiddlyLinkList=function(e){if(e){var t,i=[];for(t=0;t<e.length;t++)i.push(String.encodeTiddlyLink(e[t]));return i.join(" ")}return""},String.prototype.decodeHashMap=function(){var e,t=this.parseParams("anon","",!1),i={};for(e=1;e<t.length;e++)i[t[e].name]=t[e].value;return i},String.encodeHashMap=function(e){var t,i=[];for(t in e)i.push(t+':"'+e[t]+'"');return i.join(" ")},String.zeroPad=function(e,t){var i=e.toString();return i.length<t&&(i="000000000000000000000000000".substr(0,t-i.length)+i),i},String.prototype.startsWith=function(e){return!e||this.substring(0,e.length)==e},Date.prototype.formatString=function(e){var t=e.replace(/0hh12/g,String.zeroPad(this.getHours12(),2));t=t.replace(/hh12/g,this.getHours12()),t=t.replace(/0hh/g,String.zeroPad(this.getHours(),2)),t=t.replace(/hh/g,this.getHours()),t=t.replace(/mmm/g,config.messages.dates.shortMonths[this.getMonth()]),t=t.replace(/0mm/g,String.zeroPad(this.getMinutes(),2)),t=t.replace(/mm/g,this.getMinutes()),t=t.replace(/0ss/g,String.zeroPad(this.getSeconds(),2)),t=t.replace(/ss/g,this.getSeconds()),t=t.replace(/[ap]m/g,this.getAmPm().toLowerCase()),t=t.replace(/[AP]M/g,this.getAmPm().toUpperCase()),t=t.replace(/wYYYY/g,this.getYearForWeekNo()),t=t.replace(/wYY/g,String.zeroPad(this.getYearForWeekNo()-2e3,2)),t=t.replace(/YYYY/g,this.getFullYear()),t=t.replace(/YY/g,String.zeroPad(this.getFullYear()-2e3,2)),t=t.replace(/MMM/g,config.messages.dates.months[this.getMonth()]),t=t.replace(/0MM/g,String.zeroPad(this.getMonth()+1,2)),t=t.replace(/MM/g,this.getMonth()+1),t=t.replace(/0WW/g,String.zeroPad(this.getWeek(),2)),t=t.replace(/WW/g,this.getWeek()),t=t.replace(/DDD/g,config.messages.dates.days[this.getDay()]),t=t.replace(/ddd/g,config.messages.dates.shortDays[this.getDay()]),t=t.replace(/0DD/g,String.zeroPad(this.getDate(),2)),t=t.replace(/DDth/g,this.getDate()+this.daySuffix()),t=t.replace(/DD/g,this.getDate());var i=this.getTimezoneOffset(),r=Math.abs(i);return t=t.replace(/TZD/g,(0>i?"+":"-")+String.zeroPad(Math.floor(r/60),2)+":"+String.zeroPad(r%60,2)),t=t.replace(/\\/g,"")},Date.prototype.getWeek=function(){var e=new Date(this.getTime()),t=e.getDay();0==t&&(t=7),e.setTime(e.getTime()+864e5*(4-t));var i=Math.floor((e.getTime()-new Date(e.getFullYear(),0,1)+36e5)/864e5);return Math.floor(i/7)+1},Date.prototype.getYearForWeekNo=function(){var e=new Date(this.getTime()),t=e.getDay();return 0==t&&(t=7),e.setTime(e.getTime()+864e5*(4-t)),e.getFullYear()},Date.prototype.getHours12=function(){var e=this.getHours();return e>12?e-12:e>0?e:12},Date.prototype.getAmPm=function(){return this.getHours()>=12?config.messages.dates.pm:config.messages.dates.am},Date.prototype.daySuffix=function(){return config.messages.dates.daySuffixes[this.getDate()-1]},Date.prototype.convertToLocalYYYYMMDDHHMM=function(){return this.getFullYear()+String.zeroPad(this.getMonth()+1,2)+String.zeroPad(this.getDate(),2)+String.zeroPad(this.getHours(),2)+String.zeroPad(this.getMinutes(),2)},Date.prototype.convertToYYYYMMDDHHMM=function(){return this.getUTCFullYear()+String.zeroPad(this.getUTCMonth()+1,2)+String.zeroPad(this.getUTCDate(),2)+String.zeroPad(this.getUTCHours(),2)+String.zeroPad(this.getUTCMinutes(),2)},Date.prototype.convertToYYYYMMDDHHMMSSMMM=function(){return this.getUTCFullYear()+String.zeroPad(this.getUTCMonth()+1,2)+String.zeroPad(this.getUTCDate(),2)+"."+String.zeroPad(this.getUTCHours(),2)+String.zeroPad(this.getUTCMinutes(),2)+String.zeroPad(this.getUTCSeconds(),2)+String.zeroPad(this.getUTCMilliseconds(),3)+"0"},Date.convertFromYYYYMMDDHHMM=function(e){return e=e?e.replace(/[^0-9]/g,""):"",Date.convertFromYYYYMMDDHHMMSSMMM(e.substr(0,12))},Date.convertFromYYYYMMDDHHMMSS=function(e){return e=e?e.replace(/[^0-9]/g,""):"",Date.convertFromYYYYMMDDHHMMSSMMM(e.substr(0,14))},Date.convertFromYYYYMMDDHHMMSSMMM=function(e){return e=e?e.replace(/[^0-9]/g,""):"",new Date(Date.UTC(parseInt(e.substr(0,4),10),parseInt(e.substr(4,2),10)-1,parseInt(e.substr(6,2),10),parseInt(e.substr(8,2)||"00",10),parseInt(e.substr(10,2)||"00",10),parseInt(e.substr(12,2)||"00",10),parseInt(e.substr(14,3)||"000",10)))},RGB.prototype.mix=function(e,t){return new RGB(this.r+(e.r-this.r)*t,this.g+(e.g-this.g)*t,this.b+(e.b-this.b)*t)},RGB.prototype.toString=function(){var e=function(e,t,i){return t>e?t:e>i?i:e};return"#"+("0"+Math.floor(255*e(this.r,0,1)).toString(16)).right(2)+("0"+Math.floor(255*e(this.g,0,1)).toString(16)).right(2)+("0"+Math.floor(255*e(this.b,0,1)).toString(16)).right(2)},LoaderBase.prototype.loadTiddler=function(e,t,i){var r=this.getTitle(e,t);if((!safeMode||!e.isShadowTiddler(r))&&r){var n=e.createTiddler(r);this.internalizeTiddler(e,n,r,t),i.push(n)}},LoaderBase.prototype.loadTiddlers=function(e,t){var i,r=[];for(i=0;i<t.length;i++)try{this.loadTiddler(e,t[i],r)}catch(n){showException(n,config.messages.tiddlerLoadError.format([this.getTitle(e,t[i])]))}return r},SaverBase.prototype.externalize=function(e){var t,i=[],r=e.getTiddlers("title");for(t=0;t<r.length;t++)r[t].doNotSave()||i.push(this.externalizeTiddler(e,r[t]));return i.join("\n")},TW21Loader.prototype=new LoaderBase,TW21Loader.prototype.getTitle=function(e,t){var i=null;if(t.getAttribute&&(i=t.getAttribute("title"),i||(i=t.getAttribute("tiddler"))),!i&&t.id){var r=e.idPrefix.length;t.id.substr(0,r)==e.idPrefix&&(i=t.id.substr(r))}return i},TW21Loader.prototype.internalizeTiddler=function(e,t,i,r){var n=r.firstChild,o=null;if(r.getAttribute("tiddler"))o=getNodeText(n).unescapeLineBreaks();else{for(;"PRE"!=n.nodeName&&"pre"!=n.nodeName;)n=n.nextSibling;o=n.innerHTML.replace(/\r/gm,"").htmlDecode()}var a,s=r.getAttribute("creator"),l=r.getAttribute("modifier"),d=r.getAttribute("created"),c=r.getAttribute("modified"),u=d?Date.convertFromYYYYMMDDHHMMSS(d):version.date,p=c?Date.convertFromYYYYMMDDHHMMSS(c):u,f=r.getAttribute("tags"),h={},g=r.attributes;for(a=g.length-1;a>=0;a--){var m=g[a].name;g[a].specified&&!TiddlyWiki.isStandardField(m)&&(h[m]=g[a].value.unescapeLineBreaks())}return t.assign(i,o,l,p,f,u,h,s),t},TW21Saver.prototype=new SaverBase,TW21Saver.prototype.externalizeTiddler=function(e,t){try{var i="",r=config.options.chkUsePreForStorage;e.forEachField(t,function(e,t,r){"string"!=typeof r&&(r=""),t.match(/^temp\./)||(i+=' %0="%1"'.format([t,r.escapeLineBreaks().htmlEncode()]))},!0);var n=t.created,o=t.modified,a=t.creator?' creator="'+t.creator.htmlEncode()+'"':"";a+=t.modifier?' modifier="'+t.modifier.htmlEncode()+'"':"",a+=r&&n==version.date?"":' created="'+n.convertToYYYYMMDDHHMM()+'"',a+=r&&o==n?"":' modified="'+o.convertToYYYYMMDDHHMM()+'"';var s=t.getTags();return(!r||s)&&(a+=' tags="'+s.htmlEncode()+'"'),'<div %0="%1"%2%3>%4</div>'.format([r?"title":"tiddler",t.title.htmlEncode(),a,i,r?"\n<pre>"+t.text.htmlEncode()+"</pre>\n":t.text.escapeLineBreaks().htmlEncode()])}catch(l){throw exceptionText(l,config.messages.tiddlerSaveError.format([t.title]))}},Crypto.strToBe32s=function(e){return jQuery.encoding.strToBe32s(e)},Crypto.be32sToStr=function(e){return jQuery.encoding.be32sToStr(e)},Crypto.be32sToHex=function(e){return jQuery.encoding.be32sToHex(e)},Crypto.hexSha1Str=function(e){return jQuery.encoding.digests.hexSha1Str(e)},Crypto.sha1Str=function(e){return jQuery.encoding.digests.sha1Str(e)},Crypto.sha1=function(e,t){return jQuery.encoding.digests.sha1(e,t)},config.formatterHelpers.charFormatHelper=function(e){e.subWikify(createTiddlyElement(e.output,this.element),this.terminator)},config.formatterHelpers.monospacedByLineHelper=function(e){var t=new RegExp(this.lookahead,"mg");t.lastIndex=e.matchStart;var i=t.exec(e.source);if(i&&i.index==e.matchStart){var r=i[1];config.browser.isIE&&(r=r.replace(/\n/g,"\r")),createTiddlyElement(e.output,"pre",null,null,r),e.nextMatch=t.lastIndex}},config.macros.br={},config.macros.br.handler=function(e){createTiddlyElement(e,"br")},Array.prototype.find=function(e){var t=this.indexOf(e);return-1==t?null:t},Tiddler.prototype.loadFromDiv=function(e,t){return store.getLoader().internalizeTiddler(store,this,t,e)},Tiddler.prototype.saveToDiv=function(){return store.getSaver().externalizeTiddler(store,this)};var createTiddlerPopup=Popup.create,scrollToTiddlerPopup=Popup.show,hideTiddlerPopup=Popup.remove,regexpBackSlashEn=new RegExp("\\\\n","mg"),regexpBackSlash=new RegExp("\\\\","mg"),regexpBackSlashEss=new RegExp("\\\\s","mg"),regexpNewLine=new RegExp("\n","mg"),regexpCarriageReturn=new RegExp("\r","mg");FileAdaptor.loadTiddlyWikiCallback=function(e,t,i,r){t.status=e,e?(t.adaptor.store=new TiddlyWiki,t.adaptor.store.importTiddlyWiki(i)||(t.statusText=config.messages.invalidFileError.format([r]),t.status=!1)):t.statusText="Error reading file",t.complete(t,t.userParams)},String.prototype.toJSONString=function(){var e={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t",'"':'\\"',"\\":"\\\\"},t=function(t,i){var r=e[i];return r?r:(r=i.charCodeAt(),"\\u00"+Math.floor(r/16).toString(16)+(r%16).toString(16))};return/["\\\x00-\x1f]/.test(this)?'"'+this.replace(/([\x00-\x1f\\"])/g,t)+'"':'"'+this+'"'},Tiddler.prototype.toRssItem=function(e){return tiddlerToRssItem(this,e)},Tiddler.prototype.saveToRss=function(e){return"<item>\n"+tiddlerToRssItem(this,e)+"\n</item>"},Tiddler.prototype.generateFingerprint=function(){return"0x"+Crypto.hexSha1Str(this.text)},Number.prototype.clamp=function(e,t){var i=this;return e>i&&(i=e),i>t&&(i=t),Number(i)},function(e,t){function i(e){var t=ht[e]={};return J.each(e.split(tt),function(e,i){t[i]=!0}),t}function r(e,i,r){if(r===t&&1===e.nodeType){var n="data-"+i.replace(mt,"-$1").toLowerCase();if(r=e.getAttribute(n),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:gt.test(r)?J.parseJSON(r):r}catch(o){}J.data(e,i,r)}else r=t}return r}function n(e){var t;for(t in e)if(("data"!==t||!J.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function o(){return!1}function a(){return!0}function s(e){return!e||!e.parentNode||11===e.parentNode.nodeType}function l(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function d(e,t,i){if(t=t||0,J.isFunction(t))return J.grep(e,function(e,r){var n=!!t.call(e,r,e);return n===i});if(t.nodeType)return J.grep(e,function(e){return e===t===i});if("string"==typeof t){var r=J.grep(e,function(e){return 1===e.nodeType});if(Ot.test(t))return J.filter(t,r,!i);t=J.filter(t,r)}return J.grep(e,function(e){return J.inArray(e,t)>=0===i})}function c(e){var t=It.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}function u(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function p(e,t){if(1===t.nodeType&&J.hasData(e)){var i,r,n,o=J._data(e),a=J._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(i in s)for(r=0,n=s[i].length;n>r;r++)J.event.add(t,i,s[i][r])}a.data&&(a.data=J.extend({},a.data))}}function f(e,t){var i;1===t.nodeType&&(t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),i=t.nodeName.toLowerCase(),"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),J.support.html5Clone&&e.innerHTML&&!J.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&Gt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.selected=e.defaultSelected:"input"===i||"textarea"===i?t.defaultValue=e.defaultValue:"script"===i&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(J.expando))}function h(e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName("*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll("*"):[]}function g(e){Gt.test(e.type)&&(e.defaultChecked=e.checked)}function m(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),r=t,n=yi.length;n--;)if(t=yi[n]+i,t in e)return t;return r}function y(e,t){return e=t||e,"none"===J.css(e,"display")||!J.contains(e.ownerDocument,e)}function v(e,t){for(var i,r,n=[],o=0,a=e.length;a>o;o++)i=e[o],i.style&&(n[o]=J._data(i,"olddisplay"),t?(!n[o]&&"none"===i.style.display&&(i.style.display=""),""===i.style.display&&y(i)&&(n[o]=J._data(i,"olddisplay",w(i.nodeName)))):(r=ii(i,"display"),!n[o]&&"none"!==r&&J._data(i,"olddisplay",r)));for(o=0;a>o;o++)i=e[o],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?n[o]||"":"none"));return e}function T(e,t,i){var r=ci.exec(t);return r?Math.max(0,r[1]-(i||0))+(r[2]||"px"):t}function b(e,t,i,r){for(var n=i===(r?"border":"content")?4:"width"===t?1:0,o=0;4>n;n+=2)"margin"===i&&(o+=J.css(e,i+mi[n],!0)),r?("content"===i&&(o-=parseFloat(ii(e,"padding"+mi[n]))||0),"margin"!==i&&(o-=parseFloat(ii(e,"border"+mi[n]+"Width"))||0)):(o+=parseFloat(ii(e,"padding"+mi[n]))||0,"padding"!==i&&(o+=parseFloat(ii(e,"border"+mi[n]+"Width"))||0));return o}function x(e,t,i){var r="width"===t?e.offsetWidth:e.offsetHeight,n=!0,o=J.support.boxSizing&&"border-box"===J.css(e,"boxSizing");if(0>=r||null==r){if(r=ii(e,t),(0>r||null==r)&&(r=e.style[t]),ui.test(r))return r;n=o&&(J.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+b(e,t,i||(o?"border":"content"),n)+"px"}function w(e){if(fi[e])return fi[e];var t=J("<"+e+">").appendTo(U.body),i=t.css("display");return t.remove(),("none"===i||""===i)&&(ri=U.body.appendChild(ri||J.extend(U.createElement("iframe"),{frameBorder:0,width:0,height:0})),ni&&ri.createElement||(ni=(ri.contentWindow||ri.contentDocument).document,ni.write("<!doctype html><html><body>"),ni.close()),t=ni.body.appendChild(ni.createElement(e)),i=ii(t,"display"),U.body.removeChild(ri)),fi[e]=i,i}function k(e,t,i,r){var n;if(J.isArray(t))J.each(t,function(t,n){i||bi.test(e)?r(e,n):k(e+"["+("object"==typeof n?t:"")+"]",n,i,r)});else if(i||"object"!==J.type(t))r(e,t);else for(n in t)k(e+"["+n+"]",t[n],i,r)}function S(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var r,n,o,a=t.toLowerCase().split(tt),s=0,l=a.length;if(J.isFunction(i))for(;l>s;s++)r=a[s],o=/^\+/.test(r),o&&(r=r.substr(1)||"*"),n=e[r]=e[r]||[],n[o?"unshift":"push"](i)}}function E(e,i,r,n,o,a){o=o||i.dataTypes[0],a=a||{},a[o]=!0;for(var s,l=e[o],d=0,c=l?l.length:0,u=e===Oi;c>d&&(u||!s);d++)s=l[d](i,r,n),"string"==typeof s&&(!u||a[s]?s=t:(i.dataTypes.unshift(s),s=E(e,i,r,n,s,a)));return(u||!s)&&!a["*"]&&(s=E(e,i,r,n,"*",a)),s}function C(e,i){var r,n,o=J.ajaxSettings.flatOptions||{};for(r in i)i[r]!==t&&((o[r]?e:n||(n={}))[r]=i[r]);n&&J.extend(!0,e,n)}function A(e,i,r){var n,o,a,s,l=e.contents,d=e.dataTypes,c=e.responseFields;for(o in c)o in r&&(i[c[o]]=r[o]);for(;"*"===d[0];)d.shift(),n===t&&(n=e.mimeType||i.getResponseHeader("content-type"));if(n)for(o in l)if(l[o]&&l[o].test(n)){d.unshift(o);break}if(d[0]in r)a=d[0];else{for(o in r){if(!d[0]||e.converters[o+" "+d[0]]){a=o;break}s||(s=o)}a=a||s}return a?(a!==d[0]&&d.unshift(a),r[a]):void 0}function L(e,t){var i,r,n,o,a=e.dataTypes.slice(),s=a[0],l={},d=0;if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a[1])for(i in e.converters)l[i.toLowerCase()]=e.converters[i];for(;n=a[++d];)if("*"!==n){if("*"!==s&&s!==n){if(i=l[s+" "+n]||l["* "+n],!i)for(r in l)if(o=r.split(" "),o[1]===n&&(i=l[s+" "+o[0]]||l["* "+o[0]])){i===!0?i=l[r]:l[r]!==!0&&(n=o[0],a.splice(d--,0,n));break}if(i!==!0)if(i&&e["throws"])t=i(t);else try{t=i(t)}catch(c){return{state:"parsererror",error:i?c:"No conversion from "+s+" to "+n}}}s=n}return{state:"success",data:t}}function M(){try{return new e.XMLHttpRequest}catch(t){}}function P(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function D(){return setTimeout(function(){Qi=t},0),Qi=J.now()}function F(e,t){J.each(t,function(t,i){for(var r=(Zi[t]||[]).concat(Zi["*"]),n=0,o=r.length;o>n;n++)if(r[n].call(e,t,i))return})}function N(e,t,i){var r,n=0,o=Ji.length,a=J.Deferred().always(function(){delete s.elem}),s=function(){for(var t=Qi||D(),i=Math.max(0,l.startTime+l.duration-t),r=1-(i/l.duration||0),n=0,o=l.tweens.length;o>n;n++)l.tweens[n].run(r);return a.notifyWith(e,[l,r,i]),1>r&&o?i:(a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:J.extend({},t),opts:J.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Qi||D(),duration:i.duration,tweens:[],createTween:function(t,i){var r=J.Tween(e,l.opts,t,i,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){for(var i=0,r=t?l.tweens.length:0;r>i;i++)l.tweens[i].run(1);return t?a.resolveWith(e,[l,t]):a.rejectWith(e,[l,t]),this}}),d=l.props;for(W(d,l.opts.specialEasing);o>n;n++)if(r=Ji[n].call(l,e,d,l.opts))return r;return F(l,d),J.isFunction(l.opts.start)&&l.opts.start.call(e,l),J.fx.timer(J.extend(s,{anim:l,queue:l.opts.queue,elem:e})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function W(e,t){var i,r,n,o,a;for(i in e)if(r=J.camelCase(i),n=t[r],o=e[i],J.isArray(o)&&(n=o[1],o=e[i]=o[0]),i!==r&&(e[r]=o,delete e[i]),a=J.cssHooks[r],a&&"expand"in a){o=a.expand(o),delete e[r];for(i in o)i in e||(e[i]=o[i],t[i]=n)}else t[r]=n}function H(e,t,i){var r,n,o,a,s,l,d,c,u=this,p=e.style,f={},h=[],g=e.nodeType&&y(e);i.queue||(d=J._queueHooks(e,"fx"),null==d.unqueued&&(d.unqueued=0,c=d.empty.fire,d.empty.fire=function(){d.unqueued||c()}),d.unqueued++,u.always(function(){u.always(function(){d.unqueued--,J.queue(e,"fx").length||d.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===J.css(e,"display")&&"none"===J.css(e,"float")&&(J.support.inlineBlockNeedsLayout&&"inline"!==w(e.nodeName)?p.zoom=1:p.display="inline-block")),i.overflow&&(p.overflow="hidden",J.support.shrinkWrapBlocks||u.done(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(r in t)if(o=t[r],Gi.exec(o)){if(delete t[r],o===(g?"hide":"show"))continue;h.push(r)}if(a=h.length)for(s=J._data(e,"fxshow")||J._data(e,"fxshow",{}),g?J(e).show():u.done(function(){J(e).hide()}),u.done(function(){var t;J.removeData(e,"fxshow",!0);for(t in f)J.style(e,t,f[t])}),r=0;a>r;r++)n=h[r],l=u.createTween(n,g?s[n]:0),f[n]=s[n]||J.style(e,n),n in s||(s[n]=l.start,g&&(l.end=l.start,l.start="width"===n||"height"===n?1:0))}function O(e,t,i,r,n){return new O.prototype.init(e,t,i,r,n)}function B(e,t){var i,r={height:e},n=0;for(t=t?1:0;4>n;n+=2-t)i=mi[n],r["margin"+i]=r["padding"+i]=e;return t&&(r.opacity=r.width=e),r}function R(e){return J.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var I,j,U=e.document,z=e.location,V=e.navigator,Y=e.jQuery,_=e.$,q=Array.prototype.push,Q=Array.prototype.slice,$=Array.prototype.indexOf,G=Object.prototype.toString,X=Object.prototype.hasOwnProperty,K=String.prototype.trim,J=function(e,t){return new J.fn.init(e,t,I)},Z=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,et=/\S/,tt=/\s+/,it=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rt=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,nt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ot=/^[\],:{}\s]*$/,at=/(?:^|:|,)(?:\s*\[)+/g,st=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,lt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,dt=/^-ms-/,ct=/-([\da-z])/gi,ut=function(e,t){return(t+"").toUpperCase()},pt=function(){U.addEventListener?(U.removeEventListener("DOMContentLoaded",pt,!1),J.ready()):"complete"===U.readyState&&(U.detachEvent("onreadystatechange",pt),J.ready())},ft={};J.fn=J.prototype={constructor:J,init:function(e,i,r){var n,o,a;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if("string"==typeof e){if(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:rt.exec(e),n&&(n[1]||!i)){if(n[1])return i=i instanceof J?i[0]:i,a=i&&i.nodeType?i.ownerDocument||i:U,e=J.parseHTML(n[1],a,!0),nt.test(n[1])&&J.isPlainObject(i)&&this.attr.call(e,i,!0),J.merge(this,e);if(o=U.getElementById(n[2]),o&&o.parentNode){if(o.id!==n[2])return r.find(e);this.length=1,this[0]=o}return this.context=U,this.selector=e,this}return!i||i.jquery?(i||r).find(e):this.constructor(i).find(e)}return J.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),J.makeArray(e,this))},selector:"",jquery:"1.8.1",length:0,size:function(){return this.length},toArray:function(){return Q.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e,t,i){var r=J.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,"find"===t?r.selector=this.selector+(this.selector?" ":"")+i:t&&(r.selector=this.selector+"."+t+"("+i+")"),r},each:function(e,t){return J.each(this,e,t)},ready:function(e){return J.ready.promise().done(e),this},eq:function(e){return e=+e,-1===e?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(Q.apply(this,arguments),"slice",Q.call(arguments).join(","))},map:function(e){return this.pushStack(J.map(this,function(t,i){return e.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:q,sort:[].sort,splice:[].splice},J.fn.init.prototype=J.fn,J.extend=J.fn.extend=function(){var e,i,r,n,o,a,s=arguments[0]||{},l=1,d=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},l=2),"object"!=typeof s&&!J.isFunction(s)&&(s={}),d===l&&(s=this,--l);d>l;l++)if(null!=(e=arguments[l]))for(i in e)r=s[i],n=e[i],s!==n&&(c&&n&&(J.isPlainObject(n)||(o=J.isArray(n)))?(o?(o=!1,a=r&&J.isArray(r)?r:[]):a=r&&J.isPlainObject(r)?r:{},s[i]=J.extend(c,a,n)):n!==t&&(s[i]=n));return s},J.extend({noConflict:function(t){return e.$===J&&(e.$=_),t&&e.jQuery===J&&(e.jQuery=Y),J},isReady:!1,readyWait:1,holdReady:function(e){e?J.readyWait++:J.ready(!0)},ready:function(e){if(e===!0?!--J.readyWait:!J.isReady){if(!U.body)return setTimeout(J.ready,1);J.isReady=!0,e!==!0&&--J.readyWait>0||(j.resolveWith(U,[J]),J.fn.trigger&&J(U).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===J.type(e)},isArray:Array.isArray||function(e){return"array"===J.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):ft[G.call(e)]||"object"},isPlainObject:function(e){if(!e||"object"!==J.type(e)||e.nodeType||J.isWindow(e))return!1;try{if(e.constructor&&!X.call(e,"constructor")&&!X.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}var r;for(r in e);return r===t||X.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,i){var r;return e&&"string"==typeof e?("boolean"==typeof t&&(i=t,t=0),t=t||U,(r=nt.exec(e))?[t.createElement(r[1])]:(r=J.buildFragment([e],t,i?null:[]),J.merge([],(r.cacheable?J.clone(r.fragment):r.fragment).childNodes))):null},parseJSON:function(t){return t&&"string"==typeof t?(t=J.trim(t),e.JSON&&e.JSON.parse?e.JSON.parse(t):ot.test(t.replace(st,"@").replace(lt,"]").replace(at,""))?new Function("return "+t)():void J.error("Invalid JSON: "+t)):null},parseXML:function(i){var r,n;if(!i||"string"!=typeof i)return null;try{e.DOMParser?(n=new DOMParser,r=n.parseFromString(i,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(i))}catch(o){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&J.error("Invalid XML: "+i),r},noop:function(){},globalEval:function(t){t&&et.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(dt,"ms-").replace(ct,ut)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toUpperCase()===t.toUpperCase()},each:function(e,i,r){var n,o=0,a=e.length,s=a===t||J.isFunction(e);if(r)if(s){for(n in e)if(i.apply(e[n],r)===!1)break}else for(;a>o&&i.apply(e[o++],r)!==!1;);else if(s){for(n in e)if(i.call(e[n],n,e[n])===!1)break}else for(;a>o&&i.call(e[o],o,e[o++])!==!1;);return e
},trim:K&&!K.call("� ")?function(e){return null==e?"":K.call(e)}:function(e){return null==e?"":e.toString().replace(it,"")},makeArray:function(e,t){var i,r=t||[];return null!=e&&(i=J.type(e),null==e.length||"string"===i||"function"===i||"regexp"===i||J.isWindow(e)?q.call(r,e):J.merge(r,e)),r},inArray:function(e,t,i){var r;if(t){if($)return $.call(t,e,i);for(r=t.length,i=i?0>i?Math.max(0,r+i):i:0;r>i;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,i){var r=i.length,n=e.length,o=0;if("number"==typeof r)for(;r>o;o++)e[n++]=i[o];else for(;i[o]!==t;)e[n++]=i[o++];return e.length=n,e},grep:function(e,t,i){var r,n=[],o=0,a=e.length;for(i=!!i;a>o;o++)r=!!t(e[o],o),i!==r&&n.push(e[o]);return n},map:function(e,i,r){var n,o,a=[],s=0,l=e.length,d=e instanceof J||l!==t&&"number"==typeof l&&(l>0&&e[0]&&e[l-1]||0===l||J.isArray(e));if(d)for(;l>s;s++)n=i(e[s],s,r),null!=n&&(a[a.length]=n);else for(o in e)n=i(e[o],o,r),null!=n&&(a[a.length]=n);return a.concat.apply([],a)},guid:1,proxy:function(e,i){var r,n,o;return"string"==typeof i&&(r=e[i],i=e,e=r),J.isFunction(e)?(n=Q.call(arguments,2),o=function(){return e.apply(i,n.concat(Q.call(arguments)))},o.guid=e.guid=e.guid||o.guid||J.guid++,o):t},access:function(e,i,r,n,o,a,s){var l,d=null==r,c=0,u=e.length;if(r&&"object"==typeof r){for(c in r)J.access(e,i,c,r[c],1,a,n);o=1}else if(n!==t){if(l=s===t&&J.isFunction(n),d&&(l?(l=i,i=function(e,t,i){return l.call(J(e),i)}):(i.call(e,n),i=null)),i)for(;u>c;c++)i(e[c],r,l?n.call(e[c],c,i(e[c],r)):n,s);o=1}return o?e:d?i.call(e):u?i(e[0],r):a},now:function(){return(new Date).getTime()}}),J.ready.promise=function(t){if(!j)if(j=J.Deferred(),"complete"===U.readyState)setTimeout(J.ready,1);else if(U.addEventListener)U.addEventListener("DOMContentLoaded",pt,!1),e.addEventListener("load",J.ready,!1);else{U.attachEvent("onreadystatechange",pt),e.attachEvent("onload",J.ready);var i=!1;try{i=null==e.frameElement&&U.documentElement}catch(r){}i&&i.doScroll&&function n(){if(!J.isReady){try{i.doScroll("left")}catch(e){return setTimeout(n,50)}J.ready()}}()}return j.promise(t)},J.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){ft["[object "+t+"]"]=t.toLowerCase()}),I=J(U);var ht={};J.Callbacks=function(e){e="string"==typeof e?ht[e]||i(e):J.extend({},e);var r,n,o,a,s,l,d=[],c=!e.once&&[],u=function(t){for(r=e.memory&&t,n=!0,l=a||0,a=0,s=d.length,o=!0;d&&s>l;l++)if(d[l].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}o=!1,d&&(c?c.length&&u(c.shift()):r?d=[]:p.disable())},p={add:function(){if(d){var t=d.length;!function i(t){J.each(t,function(t,r){var n=J.type(r);"function"!==n||e.unique&&p.has(r)?r&&r.length&&"string"!==n&&i(r):d.push(r)})}(arguments),o?s=d.length:r&&(a=t,u(r))}return this},remove:function(){return d&&J.each(arguments,function(e,t){for(var i;(i=J.inArray(t,d,i))>-1;)d.splice(i,1),o&&(s>=i&&s--,l>=i&&l--)}),this},has:function(e){return J.inArray(e,d)>-1},empty:function(){return d=[],this},disable:function(){return d=c=r=t,this},disabled:function(){return!d},lock:function(){return c=t,r||p.disable(),this},locked:function(){return!c},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],d&&(!n||c)&&(o?c.push(t):u(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!n}};return p},J.extend({Deferred:function(e){var t=[["resolve","done",J.Callbacks("once memory"),"resolved"],["reject","fail",J.Callbacks("once memory"),"rejected"],["notify","progress",J.Callbacks("memory")]],i="pending",r={state:function(){return i},always:function(){return n.done(arguments).fail(arguments),this},then:function(){var e=arguments;return J.Deferred(function(i){J.each(t,function(t,r){var o=r[0],a=e[t];n[r[1]](J.isFunction(a)?function(){var e=a.apply(this,arguments);e&&J.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o+"With"](this===n?i:this,[e])}:i[o])}),e=null}).promise()},promise:function(e){return"object"==typeof e?J.extend(e,r):r}},n={};return r.pipe=r.then,J.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){i=s},t[1^e][2].disable,t[2][2].lock),n[o[0]]=a.fire,n[o[0]+"With"]=a.fireWith}),r.promise(n),e&&e.call(n,n),n},when:function(e){var t,i,r,n=0,o=Q.call(arguments),a=o.length,s=1!==a||e&&J.isFunction(e.promise)?a:0,l=1===s?e:J.Deferred(),d=function(e,i,r){return function(n){i[e]=this,r[e]=arguments.length>1?Q.call(arguments):n,r===t?l.notifyWith(i,r):--s||l.resolveWith(i,r)}};if(a>1)for(t=new Array(a),i=new Array(a),r=new Array(a);a>n;n++)o[n]&&J.isFunction(o[n].promise)?o[n].promise().done(d(n,r,o)).fail(l.reject).progress(d(n,i,t)):--s;return s||l.resolveWith(r,o),l.promise()}}),J.support=function(){var t,i,r,n,o,a,s,l,d,c,u,p=U.createElement("div");if(p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=p.getElementsByTagName("*"),r=p.getElementsByTagName("a")[0],r.style.cssText="top:1px;float:left;opacity:.5",!i||!i.length||!r)return{};n=U.createElement("select"),o=n.appendChild(U.createElement("option")),a=p.getElementsByTagName("input")[0],t={leadingWhitespace:3===p.firstChild.nodeType,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:"/a"===r.getAttribute("href"),opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:"on"===a.value,optSelected:o.selected,getSetAttribute:"t"!==p.className,enctype:!!U.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==U.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===U.compatMode,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},a.checked=!0,t.noCloneChecked=a.cloneNode(!0).checked,n.disabled=!0,t.optDisabled=!o.disabled;try{delete p.test}catch(f){t.deleteExpando=!1}if(!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",u=function(){t.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick"),p.detachEvent("onclick",u)),a=U.createElement("input"),a.value="t",a.setAttribute("type","radio"),t.radioValue="t"===a.value,a.setAttribute("checked","checked"),a.setAttribute("name","t"),p.appendChild(a),s=U.createDocumentFragment(),s.appendChild(p.lastChild),t.checkClone=s.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=a.checked,s.removeChild(a),s.appendChild(p),p.attachEvent)for(d in{submit:!0,change:!0,focusin:!0})l="on"+d,c=l in p,c||(p.setAttribute(l,"return;"),c="function"==typeof p[l]),t[d+"Bubbles"]=c;return J(function(){var i,r,n,o,a="padding:0;margin:0;border:0;display:block;overflow:hidden;",s=U.getElementsByTagName("body")[0];s&&(i=U.createElement("div"),i.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",s.insertBefore(i,s.firstChild),r=U.createElement("div"),i.appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",n=r.getElementsByTagName("td"),n[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===n[0].offsetHeight,n[0].style.display="",n[1].style.display="none",t.reliableHiddenOffsets=c&&0===n[0].offsetHeight,r.innerHTML="",r.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===r.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==s.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(r,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(r,null)||{width:"4px"}).width,o=U.createElement("div"),o.style.cssText=r.style.cssText=a,o.style.marginRight=o.style.width="0",r.style.width="1px",r.appendChild(o),t.reliableMarginRight=!parseFloat((e.getComputedStyle(o,null)||{}).marginRight)),"undefined"!=typeof r.style.zoom&&(r.innerHTML="",r.style.cssText=a+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===r.offsetWidth,r.style.display="block",r.style.overflow="visible",r.innerHTML="<div></div>",r.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==r.offsetWidth,i.style.zoom=1),s.removeChild(i),i=r=n=o=null)}),s.removeChild(p),i=r=n=o=a=s=p=null,t}();var gt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,mt=/([A-Z])/g;J.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(J.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?J.cache[e[J.expando]]:e[J.expando],!!e&&!n(e)},data:function(e,i,r,n){if(J.acceptData(e)){var o,a,s=J.expando,l="string"==typeof i,d=e.nodeType,c=d?J.cache:e,u=d?e[s]:e[s]&&s;if(u&&c[u]&&(n||c[u].data)||!l||r!==t)return u||(d?e[s]=u=J.deletedIds.pop()||++J.uuid:u=s),c[u]||(c[u]={},d||(c[u].toJSON=J.noop)),("object"==typeof i||"function"==typeof i)&&(n?c[u]=J.extend(c[u],i):c[u].data=J.extend(c[u].data,i)),o=c[u],n||(o.data||(o.data={}),o=o.data),r!==t&&(o[J.camelCase(i)]=r),l?(a=o[i],null==a&&(a=o[J.camelCase(i)])):a=o,a}},removeData:function(e,t,i){if(J.acceptData(e)){var r,o,a,s=e.nodeType,l=s?J.cache:e,d=s?e[J.expando]:J.expando;if(l[d]){if(t&&(r=i?l[d]:l[d].data)){J.isArray(t)||(t in r?t=[t]:(t=J.camelCase(t),t=t in r?[t]:t.split(" ")));for(o=0,a=t.length;a>o;o++)delete r[t[o]];if(!(i?n:J.isEmptyObject)(r))return}(i||(delete l[d].data,n(l[d])))&&(s?J.cleanData([e],!0):J.support.deleteExpando||l!=l.window?delete l[d]:l[d]=null)}}},_data:function(e,t,i){return J.data(e,t,i,!0)},acceptData:function(e){var t=e.nodeName&&J.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),J.fn.extend({data:function(e,i){var n,o,a,s,l,d=this[0],c=0,u=null;if(e===t){if(this.length&&(u=J.data(d),1===d.nodeType&&!J._data(d,"parsedAttrs"))){for(a=d.attributes,l=a.length;l>c;c++)s=a[c].name,0===s.indexOf("data-")&&(s=J.camelCase(s.substring(5)),r(d,s,u[s]));J._data(d,"parsedAttrs",!0)}return u}return"object"==typeof e?this.each(function(){J.data(this,e)}):(n=e.split(".",2),n[1]=n[1]?"."+n[1]:"",o=n[1]+"!",J.access(this,function(i){return i===t?(u=this.triggerHandler("getData"+o,[n[0]]),u===t&&d&&(u=J.data(d,e),u=r(d,e,u)),u===t&&n[1]?this.data(n[0]):u):(n[1]=i,void this.each(function(){var t=J(this);t.triggerHandler("setData"+o,n),J.data(this,e,i),t.triggerHandler("changeData"+o,n)}))},null,i,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){J.removeData(this,e)})}}),J.extend({queue:function(e,t,i){var r;return e?(t=(t||"fx")+"queue",r=J._data(e,t),i&&(!r||J.isArray(i)?r=J._data(e,t,J.makeArray(i)):r.push(i)),r||[]):void 0},dequeue:function(e,t){t=t||"fx";var i=J.queue(e,t),r=i.length,n=i.shift(),o=J._queueHooks(e,t),a=function(){J.dequeue(e,t)};"inprogress"===n&&(n=i.shift(),r--),n&&("fx"===t&&i.unshift("inprogress"),delete o.stop,n.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return J._data(e,i)||J._data(e,i,{empty:J.Callbacks("once memory").add(function(){J.removeData(e,t+"queue",!0),J.removeData(e,i,!0)})})}}),J.fn.extend({queue:function(e,i){var r=2;return"string"!=typeof e&&(i=e,e="fx",r--),arguments.length<r?J.queue(this[0],e):i===t?this:this.each(function(){var t=J.queue(this,e,i);J._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&J.dequeue(this,e)})},dequeue:function(e){return this.each(function(){J.dequeue(this,e)})},delay:function(e,t){return e=J.fx?J.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var r=setTimeout(t,e);i.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){var r,n=1,o=J.Deferred(),a=this,s=this.length,l=function(){--n||o.resolveWith(a,[a])};for("string"!=typeof e&&(i=e,e=t),e=e||"fx";s--;)r=J._data(a[s],e+"queueHooks"),r&&r.empty&&(n++,r.empty.add(l));return l(),o.promise(i)}});var yt,vt,Tt,bt=/[\t\r\n]/g,xt=/\r/g,wt=/^(?:button|input)$/i,kt=/^(?:button|input|object|select|textarea)$/i,St=/^a(?:rea|)$/i,Et=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Ct=J.support.getSetAttribute;J.fn.extend({attr:function(e,t){return J.access(this,J.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){J.removeAttr(this,e)})},prop:function(e,t){return J.access(this,J.prop,e,t,arguments.length>1)},removeProp:function(e){return e=J.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(i){}})},addClass:function(e){var t,i,r,n,o,a,s;if(J.isFunction(e))return this.each(function(t){J(this).addClass(e.call(this,t,this.className))});if(e&&"string"==typeof e)for(t=e.split(tt),i=0,r=this.length;r>i;i++)if(n=this[i],1===n.nodeType)if(n.className||1!==t.length){for(o=" "+n.className+" ",a=0,s=t.length;s>a;a++)~o.indexOf(" "+t[a]+" ")||(o+=t[a]+" ");n.className=J.trim(o)}else n.className=e;return this},removeClass:function(e){var i,r,n,o,a,s,l;if(J.isFunction(e))return this.each(function(t){J(this).removeClass(e.call(this,t,this.className))});if(e&&"string"==typeof e||e===t)for(i=(e||"").split(tt),s=0,l=this.length;l>s;s++)if(n=this[s],1===n.nodeType&&n.className){for(r=(" "+n.className+" ").replace(bt," "),o=0,a=i.length;a>o;o++)for(;r.indexOf(" "+i[o]+" ")>-1;)r=r.replace(" "+i[o]+" "," ");n.className=e?J.trim(r):""}return this},toggleClass:function(e,t){var i=typeof e,r="boolean"==typeof t;return this.each(J.isFunction(e)?function(i){J(this).toggleClass(e.call(this,i,this.className,t),t)}:function(){if("string"===i)for(var n,o=0,a=J(this),s=t,l=e.split(tt);n=l[o++];)s=r?s:!a.hasClass(n),a[s?"addClass":"removeClass"](n);else("undefined"===i||"boolean"===i)&&(this.className&&J._data(this,"__className__",this.className),this.className=this.className||e===!1?"":J._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,r=this.length;r>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(bt," ").indexOf(t)>-1)return!0;return!1},val:function(e){var i,r,n,o=this[0];{if(arguments.length)return n=J.isFunction(e),this.each(function(r){var o,a=J(this);1===this.nodeType&&(o=n?e.call(this,r,a.val()):e,null==o?o="":"number"==typeof o?o+="":J.isArray(o)&&(o=J.map(o,function(e){return null==e?"":e+""})),i=J.valHooks[this.type]||J.valHooks[this.nodeName.toLowerCase()],i&&"set"in i&&i.set(this,o,"value")!==t||(this.value=o))});if(o)return i=J.valHooks[o.type]||J.valHooks[o.nodeName.toLowerCase()],i&&"get"in i&&(r=i.get(o,"value"))!==t?r:(r=o.value,"string"==typeof r?r.replace(xt,""):null==r?"":r)}}}),J.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,i,r,n,o=e.selectedIndex,a=[],s=e.options,l="select-one"===e.type;if(0>o)return null;for(i=l?o:0,r=l?o+1:s.length;r>i;i++)if(n=s[i],!(!n.selected||(J.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&J.nodeName(n.parentNode,"optgroup"))){if(t=J(n).val(),l)return t;a.push(t)}return l&&!a.length&&s.length?J(s[o]).val():a},set:function(e,t){var i=J.makeArray(t);return J(e).find("option").each(function(){this.selected=J.inArray(J(this).val(),i)>=0}),i.length||(e.selectedIndex=-1),i}}},attrFn:{},attr:function(e,i,r,n){var o,a,s,l=e.nodeType;if(e&&3!==l&&8!==l&&2!==l)return n&&J.isFunction(J.fn[i])?J(e)[i](r):"undefined"==typeof e.getAttribute?J.prop(e,i,r):(s=1!==l||!J.isXMLDoc(e),s&&(i=i.toLowerCase(),a=J.attrHooks[i]||(Et.test(i)?vt:yt)),r!==t?null===r?void J.removeAttr(e,i):a&&"set"in a&&s&&(o=a.set(e,r,i))!==t?o:(e.setAttribute(i,""+r),r):a&&"get"in a&&s&&null!==(o=a.get(e,i))?o:(o=e.getAttribute(i),null===o?t:o))},removeAttr:function(e,t){var i,r,n,o,a=0;if(t&&1===e.nodeType)for(r=t.split(tt);a<r.length;a++)n=r[a],n&&(i=J.propFix[n]||n,o=Et.test(n),o||J.attr(e,n,""),e.removeAttribute(Ct?n:i),o&&i in e&&(e[i]=!1))},attrHooks:{type:{set:function(e,t){if(wt.test(e.nodeName)&&e.parentNode)J.error("type property can't be changed");else if(!J.support.radioValue&&"radio"===t&&J.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}},value:{get:function(e,t){return yt&&J.nodeName(e,"button")?yt.get(e,t):t in e?e.value:null},set:function(e,t,i){return yt&&J.nodeName(e,"button")?yt.set(e,t,i):void(e.value=t)}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,i,r){var n,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!J.isXMLDoc(e),a&&(i=J.propFix[i]||i,o=J.propHooks[i]),r!==t?o&&"set"in o&&(n=o.set(e,r,i))!==t?n:e[i]=r:o&&"get"in o&&null!==(n=o.get(e,i))?n:e[i]},propHooks:{tabIndex:{get:function(e){var i=e.getAttributeNode("tabindex");return i&&i.specified?parseInt(i.value,10):kt.test(e.nodeName)||St.test(e.nodeName)&&e.href?0:t}}}}),vt={get:function(e,i){var r,n=J.prop(e,i);return n===!0||"boolean"!=typeof n&&(r=e.getAttributeNode(i))&&r.nodeValue!==!1?i.toLowerCase():t},set:function(e,t,i){var r;return t===!1?J.removeAttr(e,i):(r=J.propFix[i]||i,r in e&&(e[r]=!0),e.setAttribute(i,i.toLowerCase())),i}},Ct||(Tt={name:!0,id:!0,coords:!0},yt=J.valHooks.button={get:function(e,i){var r;return r=e.getAttributeNode(i),r&&(Tt[i]?""!==r.value:r.specified)?r.value:t},set:function(e,t,i){var r=e.getAttributeNode(i);return r||(r=U.createAttribute(i),e.setAttributeNode(r)),r.value=t+""}},J.each(["width","height"],function(e,t){J.attrHooks[t]=J.extend(J.attrHooks[t],{set:function(e,i){return""===i?(e.setAttribute(t,"auto"),i):void 0}})}),J.attrHooks.contenteditable={get:yt.get,set:function(e,t,i){""===t&&(t="false"),yt.set(e,t,i)}}),J.support.hrefNormalized||J.each(["href","src","width","height"],function(e,i){J.attrHooks[i]=J.extend(J.attrHooks[i],{get:function(e){var r=e.getAttribute(i,2);return null===r?t:r}})}),J.support.style||(J.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=""+t}}),J.support.optSelected||(J.propHooks.selected=J.extend(J.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),J.support.enctype||(J.propFix.enctype="encoding"),J.support.checkOn||J.each(["radio","checkbox"],function(){J.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),J.each(["radio","checkbox"],function(){J.valHooks[this]=J.extend(J.valHooks[this],{set:function(e,t){return J.isArray(t)?e.checked=J.inArray(J(e).val(),t)>=0:void 0}})});var At=/^(?:textarea|input|select)$/i,Lt=/^([^\.]*|)(?:\.(.+)|)$/,Mt=/(?:^|\s)hover(\.\S+|)\b/,Pt=/^key/,Dt=/^(?:mouse|contextmenu)|click/,Ft=/^(?:focusinfocus|focusoutblur)$/,Nt=function(e){return J.event.special.hover?e:e.replace(Mt,"mouseenter$1 mouseleave$1")};J.event={add:function(e,i,r,n,o){var a,s,l,d,c,u,p,f,h,g,m;if(3!==e.nodeType&&8!==e.nodeType&&i&&r&&(a=J._data(e))){for(r.handler&&(h=r,r=h.handler,o=h.selector),r.guid||(r.guid=J.guid++),l=a.events,l||(a.events=l={}),s=a.handle,s||(a.handle=s=function(e){return"undefined"==typeof J||e&&J.event.triggered===e.type?t:J.event.dispatch.apply(s.elem,arguments)},s.elem=e),i=J.trim(Nt(i)).split(" "),d=0;d<i.length;d++)c=Lt.exec(i[d])||[],u=c[1],p=(c[2]||"").split(".").sort(),m=J.event.special[u]||{},u=(o?m.delegateType:m.bindType)||u,m=J.event.special[u]||{},f=J.extend({type:u,origType:c[1],data:n,handler:r,guid:r.guid,selector:o,namespace:p.join(".")},h),g=l[u],g||(g=l[u]=[],g.delegateCount=0,m.setup&&m.setup.call(e,n,p,s)!==!1||(e.addEventListener?e.addEventListener(u,s,!1):e.attachEvent&&e.attachEvent("on"+u,s))),m.add&&(m.add.call(e,f),f.handler.guid||(f.handler.guid=r.guid)),o?g.splice(g.delegateCount++,0,f):g.push(f),J.event.global[u]=!0;e=null}},global:{},remove:function(e,t,i,r,n){var o,a,s,l,d,c,u,p,f,h,g,m=J.hasData(e)&&J._data(e);if(m&&(p=m.events)){for(t=J.trim(Nt(t||"")).split(" "),o=0;o<t.length;o++)if(a=Lt.exec(t[o])||[],s=l=a[1],d=a[2],s){for(f=J.event.special[s]||{},s=(r?f.delegateType:f.bindType)||s,h=p[s]||[],c=h.length,d=d?new RegExp("(^|\\.)"+d.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null,u=0;u<h.length;u++)g=h[u],!(!n&&l!==g.origType||i&&i.guid!==g.guid||d&&!d.test(g.namespace)||r&&r!==g.selector&&("**"!==r||!g.selector)||(h.splice(u--,1),g.selector&&h.delegateCount--,!f.remove||!f.remove.call(e,g)));0===h.length&&c!==h.length&&((!f.teardown||f.teardown.call(e,d,m.handle)===!1)&&J.removeEvent(e,s,m.handle),delete p[s])}else for(s in p)J.event.remove(e,s+t[o],i,r,!0);J.isEmptyObject(p)&&(delete m.handle,J.removeData(e,"events",!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(i,r,n,o){if(!n||3!==n.nodeType&&8!==n.nodeType){var a,s,l,d,c,u,p,f,h,g,m=i.type||i,y=[];if(Ft.test(m+J.event.triggered))return;if(m.indexOf("!")>=0&&(m=m.slice(0,-1),s=!0),m.indexOf(".")>=0&&(y=m.split("."),m=y.shift(),y.sort()),(!n||J.event.customEvent[m])&&!J.event.global[m])return;if(i="object"==typeof i?i[J.expando]?i:new J.Event(m,i):new J.Event(m),i.type=m,i.isTrigger=!0,i.exclusive=s,i.namespace=y.join("."),i.namespace_re=i.namespace?new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,u=m.indexOf(":")<0?"on"+m:"",!n){a=J.cache;for(l in a)a[l].events&&a[l].events[m]&&J.event.trigger(i,r,a[l].handle.elem,!0);return}if(i.result=t,i.target||(i.target=n),r=null!=r?J.makeArray(r):[],r.unshift(i),p=J.event.special[m]||{},p.trigger&&p.trigger.apply(n,r)===!1)return;if(h=[[n,p.bindType||m]],!o&&!p.noBubble&&!J.isWindow(n)){for(g=p.delegateType||m,d=Ft.test(g+m)?n:n.parentNode,c=n;d;d=d.parentNode)h.push([d,g]),c=d;c===(n.ownerDocument||U)&&h.push([c.defaultView||c.parentWindow||e,g])}for(l=0;l<h.length&&!i.isPropagationStopped();l++)d=h[l][0],i.type=h[l][1],f=(J._data(d,"events")||{})[i.type]&&J._data(d,"handle"),f&&f.apply(d,r),f=u&&d[u],f&&J.acceptData(d)&&f.apply(d,r)===!1&&i.preventDefault();return i.type=m,!(o||i.isDefaultPrevented()||p._default&&p._default.apply(n.ownerDocument,r)!==!1||"click"===m&&J.nodeName(n,"a")||!J.acceptData(n)||!u||!n[m]||("focus"===m||"blur"===m)&&0===i.target.offsetWidth||J.isWindow(n)||(c=n[u],c&&(n[u]=null),J.event.triggered=m,n[m](),J.event.triggered=t,!c||!(n[u]=c))),i.result}},dispatch:function(i){i=J.event.fix(i||e.event);var r,n,o,a,s,l,d,c,u,p=(J._data(this,"events")||{})[i.type]||[],f=p.delegateCount,h=[].slice.call(arguments),g=!i.exclusive&&!i.namespace,m=J.event.special[i.type]||{},y=[];if(h[0]=i,i.delegateTarget=this,!m.preDispatch||m.preDispatch.call(this,i)!==!1){if(f&&(!i.button||"click"!==i.type))for(o=i.target;o!=this;o=o.parentNode||this)if(o.disabled!==!0||"click"!==i.type){for(s={},d=[],r=0;f>r;r++)c=p[r],u=c.selector,s[u]===t&&(s[u]=J(u,this).index(o)>=0),s[u]&&d.push(c);d.length&&y.push({elem:o,matches:d})}for(p.length>f&&y.push({elem:this,matches:p.slice(f)}),r=0;r<y.length&&!i.isPropagationStopped();r++)for(l=y[r],i.currentTarget=l.elem,n=0;n<l.matches.length&&!i.isImmediatePropagationStopped();n++)c=l.matches[n],(g||!i.namespace&&!c.namespace||i.namespace_re&&i.namespace_re.test(c.namespace))&&(i.data=c.data,i.handleObj=c,a=((J.event.special[c.origType]||{}).handle||c.handler).apply(l.elem,h),a!==t&&(i.result=a,a===!1&&(i.preventDefault(),i.stopPropagation())));return m.postDispatch&&m.postDispatch.call(this,i),i.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,i){var r,n,o,a=i.button,s=i.fromElement;return null==e.pageX&&null!=i.clientX&&(r=e.target.ownerDocument||U,n=r.documentElement,o=r.body,e.pageX=i.clientX+(n&&n.scrollLeft||o&&o.scrollLeft||0)-(n&&n.clientLeft||o&&o.clientLeft||0),e.pageY=i.clientY+(n&&n.scrollTop||o&&o.scrollTop||0)-(n&&n.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&s&&(e.relatedTarget=s===e.target?i.toElement:s),!e.which&&a!==t&&(e.which=1&a?1:2&a?3:4&a?2:0),e}},fix:function(e){if(e[J.expando])return e;var t,i,r=e,n=J.event.fixHooks[e.type]||{},o=n.props?this.props.concat(n.props):this.props;for(e=J.Event(r),t=o.length;t;)i=o[--t],e[i]=r[i];return e.target||(e.target=r.srcElement||U),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,n.filter?n.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,i){J.isWindow(this)&&(this.onbeforeunload=i)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,i,r){var n=J.extend(new J.Event,i,{type:e,isSimulated:!0,originalEvent:{}});r?J.event.trigger(n,null,t):J.event.dispatch.call(t,n),n.isDefaultPrevented()&&i.preventDefault()}},J.event.handle=J.event.dispatch,J.removeEvent=U.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){var r="on"+t;e.detachEvent&&("undefined"==typeof e[r]&&(e[r]=null),e.detachEvent(r,i))},J.Event=function(e,t){return this instanceof J.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?a:o):this.type=e,t&&J.extend(this,t),this.timeStamp=e&&e.timeStamp||J.now(),this[J.expando]=!0,void 0):new J.Event(e,t)},J.Event.prototype={preventDefault:function(){this.isDefaultPrevented=a;var e=this.originalEvent;e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=a;var e=this.originalEvent;e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=a,this.stopPropagation()},isDefaultPrevented:o,isPropagationStopped:o,isImmediatePropagationStopped:o},J.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){J.event.special[e]={delegateType:t,bindType:t,handle:function(e){{var i,r=this,n=e.relatedTarget,o=e.handleObj;o.selector}return(!n||n!==r&&!J.contains(r,n))&&(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),J.support.submitBubbles||(J.event.special.submit={setup:function(){return J.nodeName(this,"form")?!1:void J.event.add(this,"click._submit keypress._submit",function(e){var i=e.target,r=J.nodeName(i,"input")||J.nodeName(i,"button")?i.form:t;r&&!J._data(r,"_submit_attached")&&(J.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),J._data(r,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&J.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return J.nodeName(this,"form")?!1:void J.event.remove(this,"._submit")}}),J.support.changeBubbles||(J.event.special.change={setup:function(){return At.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(J.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),J.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),J.event.simulate("change",this,e,!0)})),!1):void J.event.add(this,"beforeactivate._change",function(e){var t=e.target;At.test(t.nodeName)&&!J._data(t,"_change_attached")&&(J.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&J.event.simulate("change",this.parentNode,e,!0)}),J._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return J.event.remove(this,"._change"),!At.test(this.nodeName)}}),J.support.focusinBubbles||J.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,r=function(e){J.event.simulate(t,e.target,J.event.fix(e),!0)};J.event.special[t]={setup:function(){0===i++&&U.addEventListener(e,r,!0)},teardown:function(){0===--i&&U.removeEventListener(e,r,!0)}}}),J.fn.extend({on:function(e,i,r,n,a){var s,l;if("object"==typeof e){"string"!=typeof i&&(r=r||i,i=t);for(l in e)this.on(l,i,r,e[l],a);return this}if(null==r&&null==n?(n=i,r=i=t):null==n&&("string"==typeof i?(n=r,r=t):(n=r,r=i,i=t)),n===!1)n=o;else if(!n)return this;return 1===a&&(s=n,n=function(e){return J().off(e),s.apply(this,arguments)},n.guid=s.guid||(s.guid=J.guid++)),this.each(function(){J.event.add(this,e,n,r,i)})},one:function(e,t,i,r){return this.on(e,t,i,r,1)},off:function(e,i,r){var n,a;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,J(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(a in e)this.off(a,i,e[a]);return this}return(i===!1||"function"==typeof i)&&(r=i,i=t),r===!1&&(r=o),this.each(function(){J.event.remove(this,e,r,i)})},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,i){return J(this.context).on(e,this.selector,t,i),this},die:function(e,t){return J(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,i,r){return this.on(t,e,i,r)},undelegate:function(e,t,i){return 1==arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},trigger:function(e,t){return this.each(function(){J.event.trigger(e,t,this)})},triggerHandler:function(e,t){return this[0]?J.event.trigger(e,t,this[0],!0):void 0},toggle:function(e){var t=arguments,i=e.guid||J.guid++,r=0,n=function(i){var n=(J._data(this,"lastToggle"+e.guid)||0)%r;return J._data(this,"lastToggle"+e.guid,n+1),i.preventDefault(),t[n].apply(this,arguments)||!1};for(n.guid=i;r<t.length;)t[r++].guid=i;return this.click(n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),J.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){J.fn[t]=function(e,i){return null==i&&(i=e,e=null),arguments.length>0?this.on(t,null,e,i):this.trigger(t)},Pt.test(t)&&(J.event.fixHooks[t]=J.event.keyHooks),Dt.test(t)&&(J.event.fixHooks[t]=J.event.mouseHooks)}),function(e,t){function i(e,t,i,r){i=i||[],t=t||L;var n,o,a,s,l=t.nodeType;if(1!==l&&9!==l)return[];if(!e||"string"!=typeof e)return i;if(a=b(t),!a&&!r&&(n=G.exec(e)))if(s=n[1]){if(9===l){if(o=t.getElementById(s),!o||!o.parentNode)return i;if(o.id===s)return i.push(o),i}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(s))&&x(t,o)&&o.id===s)return i.push(o),i}else{if(n[2])return F.apply(i,D.call(t.getElementsByTagName(e),0)),i;if((s=n[3])&&st&&t.getElementsByClassName)return F.apply(i,D.call(t.getElementsByClassName(s),0)),i}return h(e,t,i,r,a)}function r(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function n(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function o(e,t,i){if(e===t)return i;for(var r=e.nextSibling;r;){if(r===t)return-1;r=r.nextSibling}return 1}function a(e,t,r,n){var o,a,s,l,d,c,u,p,f,h,g=!r&&t!==L,m=(g?"<s>":"")+e.replace(_,"$1<s>"),y=O[A][m];if(y)return n?0:D.call(y,0);for(d=e,c=[],p=0,f=v.preFilter,h=v.filter;d;){(!o||(a=q.exec(d)))&&(a&&(d=d.slice(a[0].length),s.selector=u),c.push(s=[]),u="",g&&(d=" "+d)),o=!1,(a=Q.exec(d))&&(u+=a[0],d=d.slice(a[0].length),o=s.push({part:a.pop().replace(_," "),string:a[0],captures:a}));for(l in h)(a=it[l].exec(d))&&(!f[l]||(a=f[l](a,t,r)))&&(u+=a[0],d=d.slice(a[0].length),o=s.push({part:l,string:a.shift(),captures:a}));if(!o)break}return u&&(s.selector=u),n?d.length:d?i.error(e):D.call(O(m,c),0)
}function s(e,t,i,r){var n=t.dir,o=P++;return e||(e=function(e){return e===i}),t.first?function(t){for(;t=t[n];)if(1===t.nodeType)return e(t)&&t}:r?function(t){for(;t=t[n];)if(1===t.nodeType&&e(t))return t}:function(t){for(var i,r=o+"."+g,a=r+"."+m;t=t[n];)if(1===t.nodeType){if((i=t[A])===a)return t.sizset;if("string"==typeof i&&0===i.indexOf(r)){if(t.sizset)return t}else{if(t[A]=a,e(t))return t.sizset=!0,t;t.sizset=!1}}}}function l(e,t){return e?function(i){var r=t(i);return r&&e(r===!0?i:r)}:t}function d(e,t,i){for(var r,n,o=0;r=e[o];o++)n=v.relative[r.part]?s(n,v.relative[r.part],t,i):l(n,v.filter[r.part].apply(null,r.captures.concat(t,i)));return n}function c(e){return function(t){for(var i,r=0;i=e[r];r++)if(i(t))return!0;return!1}}function u(e,t,r,n){for(var o=0,a=t.length;a>o;o++)i(e,t[o],r,n)}function p(e,t,r,n,o,a){var s,l=v.setFilters[t.toLowerCase()];return l||i.error(t),(e||!(s=o))&&u(e||"*",n,s=[],o),s.length>0?l(s,r,a):[]}function f(e,r,n,o){for(var a,s,l,d,c,f,h,g,m,y,v,T,b,x=0,w=e.length,k=it.POS,S=new RegExp("^"+k.source+"(?!"+R+")","i"),E=function(){for(var e=1,i=arguments.length-2;i>e;e++)arguments[e]===t&&(m[e]=t)};w>x;x++){for(a=e[x],s="",g=o,l=0,d=a.length;d>l;l++){if(c=a[l],f=c.string,"PSEUDO"===c.part)for(k.exec(""),h=0;m=k.exec(f);)y=!0,v=k.lastIndex=m.index+m[0].length,v>h&&(s+=f.slice(h,m.index),h=v,T=[r],Q.test(s)&&(g&&(T=g),g=o),(b=K.test(s))&&(s=s.slice(0,-5).replace(Q,"$&*"),h++),m.length>1&&m[0].replace(S,E),g=p(s,m[1],m[2],T,g,b)),s="";y||(s+=f),y=!1}s?Q.test(s)?u(s,g||[r],n,o):i(s,r,n,o?o.concat(g):g):F.apply(n,g)}return 1===w?n:i.uniqueSort(n)}function h(e,t,i,r,n){e=e.replace(_,"$1");var o,s,l,d,c,u,p,h,y,T=a(e,t,n),b=t.nodeType;if(it.POS.test(e))return f(T,t,i,r);if(r)o=D.call(r,0);else if(1===T.length){if((c=D.call(T[0],0)).length>2&&"ID"===(u=c[0]).part&&9===b&&!n&&v.relative[c[1].part]){if(t=v.find.ID(u.captures[0].replace(tt,""),t,n)[0],!t)return i;e=e.slice(c.shift().string.length)}for(h=(T=X.exec(c[0].string))&&!T.index&&t.parentNode||t,p="",d=c.length-1;d>=0&&(u=c[d],y=u.part,p=u.string+p,!v.relative[y]);d--)if(v.order.test(y)){if(o=v.find[y](u.captures[0].replace(tt,""),h,n),null==o)continue;e=e.slice(0,e.length-p.length)+p.replace(it[y],""),e||F.apply(i,D.call(o,0));break}}if(e)for(s=w(e,t,n),g=s.dirruns++,null==o&&(o=v.find.TAG("*",X.test(e)&&t.parentNode||t)),d=0;l=o[d];d++)m=s.runs++,s(l)&&i.push(l);return i}var g,m,y,v,T,b,x,w,k,S,E=!0,C="undefined",A=("sizcache"+Math.random()).replace(".",""),L=e.document,M=L.documentElement,P=0,D=[].slice,F=[].push,N=function(e,t){return e[A]=t||!0,e},W=function(){var e={},t=[];return N(function(i,r){return t.push(i)>v.cacheLength&&delete e[t.shift()],e[i]=r},e)},H=W(),O=W(),B=W(),R="[\\x20\\t\\r\\n\\f]",I="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",j=I.replace("w","w#"),U="([*^$|!~]?=)",z="\\["+R+"*("+I+")"+R+"*(?:"+U+R+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+j+")|)|)"+R+"*\\]",V=":("+I+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+z+")|[^:]|\\\\.)*|.*))\\)|)",Y=":(nth|eq|gt|lt|first|last|even|odd)(?:\\(((?:-\\d)?\\d*)\\)|)(?=[^-]|$)",_=new RegExp("^"+R+"+|((?:^|[^\\\\])(?:\\\\.)*)"+R+"+$","g"),q=new RegExp("^"+R+"*,"+R+"*"),Q=new RegExp("^"+R+"*([\\x20\\t\\r\\n\\f>+~])"+R+"*"),$=new RegExp(V),G=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,X=/[\x20\t\r\n\f]*[+~]/,K=/:not\($/,Z=/h\d/i,et=/input|select|textarea|button/i,tt=/\\(?!\\)/g,it={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),NAME:new RegExp("^\\[name=['\"]?("+I+")['\"]?\\]"),TAG:new RegExp("^("+I.replace("w","w*")+")"),ATTR:new RegExp("^"+z),PSEUDO:new RegExp("^"+V),CHILD:new RegExp("^:(only|nth|last|first)-child(?:\\("+R+"*(even|odd|(([+-]|)(\\d*)n|)"+R+"*(?:([+-]|)"+R+"*(\\d+)|))"+R+"*\\)|)","i"),POS:new RegExp(Y,"ig"),needsContext:new RegExp("^"+R+"*[>+~]|"+Y,"i")},rt=function(e){var t=L.createElement("div");try{return e(t)}catch(i){return!1}finally{t=null}},nt=rt(function(e){return e.appendChild(L.createComment("")),!e.getElementsByTagName("*").length}),ot=rt(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==C&&"#"===e.firstChild.getAttribute("href")}),at=rt(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),st=rt(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),lt=rt(function(e){e.id=A+0,e.innerHTML="<a name='"+A+"'></a><div name='"+A+"'></div>",M.insertBefore(e,M.firstChild);var t=L.getElementsByName&&L.getElementsByName(A).length===2+L.getElementsByName(A+0).length;return y=!L.getElementById(A),M.removeChild(e),t});try{D.call(M.childNodes,0)[0].nodeType}catch(dt){D=function(e){for(var t,i=[];t=this[e];e++)i.push(t);return i}}i.matches=function(e,t){return i(e,null,null,t)},i.matchesSelector=function(e,t){return i(t,null,null,[e]).length>0},T=i.getText=function(e){var t,i="",r=0,n=e.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=T(e)}else if(3===n||4===n)return e.nodeValue}else for(;t=e[r];r++)i+=T(t);return i},b=i.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},x=i.contains=M.contains?function(e,t){var i=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&1===r.nodeType&&i.contains&&i.contains(r))}:M.compareDocumentPosition?function(e,t){return t&&!!(16&e.compareDocumentPosition(t))}:function(e,t){for(;t=t.parentNode;)if(t===e)return!0;return!1},i.attr=function(e,t){var i,r=b(e);return r||(t=t.toLowerCase()),v.attrHandle[t]?v.attrHandle[t](e):at||r?e.getAttribute(t):(i=e.getAttributeNode(t),i?"boolean"==typeof e[t]?e[t]?t:null:i.specified?i.value:null:null)},v=i.selectors={cacheLength:50,createPseudo:N,match:it,order:new RegExp("ID|TAG"+(lt?"|NAME":"")+(st?"|CLASS":"")),attrHandle:ot?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:y?function(e,t,i){if(typeof t.getElementById!==C&&!i){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,i,r){if(typeof i.getElementById!==C&&!r){var n=i.getElementById(e);return n?n.id===e||typeof n.getAttributeNode!==C&&n.getAttributeNode("id").value===e?[n]:t:[]}},TAG:nt?function(e,t){return typeof t.getElementsByTagName!==C?t.getElementsByTagName(e):void 0}:function(e,t){var i=t.getElementsByTagName(e);if("*"===e){for(var r,n=[],o=0;r=i[o];o++)1===r.nodeType&&n.push(r);return n}return i},NAME:function(e,t){return typeof t.getElementsByName!==C?t.getElementsByName(name):void 0},CLASS:function(e,t,i){return typeof t.getElementsByClassName===C||i?void 0:t.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(tt,""),e[3]=(e[4]||e[5]||"").replace(tt,""),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1]?(e[2]||i.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*("even"===e[2]||"odd"===e[2])),e[4]=+(e[6]+e[7]||"odd"===e[2])):e[2]&&i.error(e[0]),e},PSEUDO:function(e,t,i){var r,n;return it.CHILD.test(e[0])?null:(e[3]?e[2]=e[3]:(r=e[4])&&($.test(r)&&(n=a(r,t,i,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(r=r.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=r),e.slice(0,3))}},filter:{ID:y?function(e){return e=e.replace(tt,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace(tt,""),function(t){var i=typeof t.getAttributeNode!==C&&t.getAttributeNode("id");return i&&i.value===e}},TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(tt,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=H[A][e];return t||(t=H(e,new RegExp("(^|"+R+")"+e+"("+R+"|$)"))),function(e){return t.test(e.className||typeof e.getAttribute!==C&&e.getAttribute("class")||"")}},ATTR:function(e,t,r){return t?function(n){var o=i.attr(n,e),a=o+"";if(null==o)return"!="===t;switch(t){case"=":return a===r;case"!=":return a!==r;case"^=":return r&&0===a.indexOf(r);case"*=":return r&&a.indexOf(r)>-1;case"$=":return r&&a.substr(a.length-r.length)===r;case"~=":return(" "+a+" ").indexOf(r)>-1;case"|=":return a===r||a.substr(0,r.length+1)===r+"-"}}:function(t){return null!=i.attr(t,e)}},CHILD:function(e,t,i,r){if("nth"===e){var n=P++;return function(e){var t,o,a=0,s=e;if(1===i&&0===r)return!0;if(t=e.parentNode,t&&(t[A]!==n||!e.sizset)){for(s=t.firstChild;s&&(1!==s.nodeType||(s.sizset=++a,s!==e));s=s.nextSibling);t[A]=n}return o=e.sizset-r,0===i?0===o:o%i===0&&o/i>=0}}return function(t){var i=t;switch(e){case"only":case"first":for(;i=i.previousSibling;)if(1===i.nodeType)return!1;if("first"===e)return!0;i=t;case"last":for(;i=i.nextSibling;)if(1===i.nodeType)return!1;return!0}}},PSEUDO:function(e,t,r,n){var o,a=v.pseudos[e]||v.pseudos[e.toLowerCase()];return a||i.error("unsupported pseudo: "+e),a[A]?a(t,r,n):a.length>1?(o=[e,e,"",t],function(e){return a(e,0,o)}):a}},pseudos:{not:N(function(e,t,i){var r=w(e.replace(_,"$1"),t,i);return function(e){return!r(e)}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!v.pseudos.empty(e)},empty:function(e){var t;for(e=e.firstChild;e;){if(e.nodeName>"@"||3===(t=e.nodeType)||4===t)return!1;e=e.nextSibling}return!0},contains:N(function(e){return function(t){return(t.textContent||t.innerText||T(t)).indexOf(e)>-1}}),has:N(function(e){return function(t){return i(e,t).length>0}}),header:function(e){return Z.test(e.nodeName)},text:function(e){var t,i;return"input"===e.nodeName.toLowerCase()&&"text"===(t=e.type)&&(null==(i=e.getAttribute("type"))||i.toLowerCase()===t)},radio:r("radio"),checkbox:r("checkbox"),file:r("file"),password:r("password"),image:r("image"),submit:n("submit"),reset:n("reset"),button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},input:function(e){return et.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return!(e!==t.activeElement||t.hasFocus&&!t.hasFocus()||!e.type&&!e.href)},active:function(e){return e===e.ownerDocument.activeElement}},setFilters:{first:function(e,t,i){return i?e.slice(1):[e[0]]},last:function(e,t,i){var r=e.pop();return i?e:[r]},even:function(e,t,i){for(var r=[],n=i?1:0,o=e.length;o>n;n+=2)r.push(e[n]);return r},odd:function(e,t,i){for(var r=[],n=i?0:1,o=e.length;o>n;n+=2)r.push(e[n]);return r},lt:function(e,t,i){return i?e.slice(+t):e.slice(0,+t)},gt:function(e,t,i){return i?e.slice(0,+t+1):e.slice(+t+1)},eq:function(e,t,i){var r=e.splice(+t,1);return i?e:r}}},k=M.compareDocumentPosition?function(e,t){return e===t?(S=!0,0):(e.compareDocumentPosition&&t.compareDocumentPosition?4&e.compareDocumentPosition(t):e.compareDocumentPosition)?-1:1}:function(e,t){if(e===t)return S=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var i,r,n=[],a=[],s=e.parentNode,l=t.parentNode,d=s;if(s===l)return o(e,t);if(!s)return-1;if(!l)return 1;for(;d;)n.unshift(d),d=d.parentNode;for(d=l;d;)a.unshift(d),d=d.parentNode;i=n.length,r=a.length;for(var c=0;i>c&&r>c;c++)if(n[c]!==a[c])return o(n[c],a[c]);return c===i?o(e,a[c],-1):o(n[c],t,1)},[0,0].sort(k),E=!S,i.uniqueSort=function(e){var t,i=1;if(S=E,e.sort(k),S)for(;t=e[i];i++)t===e[i-1]&&e.splice(i--,1);return e},i.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},w=i.compile=function(e,t,i){var r,n,o,s=B[A][e];if(s&&s.context===t)return s;for(r=a(e,t,i),n=0,o=r.length;o>n;n++)r[n]=d(r[n],t,i);return s=B(e,c(r)),s.context=t,s.runs=s.dirruns=0,s},L.querySelectorAll&&function(){var e,t=h,r=/'|\\/g,n=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,o=[],s=[":active"],l=M.matchesSelector||M.mozMatchesSelector||M.webkitMatchesSelector||M.oMatchesSelector||M.msMatchesSelector;rt(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||o.push("\\["+R+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||o.push(":checked")}),rt(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&o.push("[*^$]="+R+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||o.push(":enabled",":disabled")}),o=o.length&&new RegExp(o.join("|")),h=function(e,i,n,s,l){if(!(s||l||o&&o.test(e)))if(9===i.nodeType)try{return F.apply(n,D.call(i.querySelectorAll(e),0)),n}catch(d){}else if(1===i.nodeType&&"object"!==i.nodeName.toLowerCase()){var c,u,p,f=i.getAttribute("id"),h=f||A,g=X.test(e)&&i.parentNode||i;for(f?h=h.replace(r,"\\$&"):i.setAttribute("id",h),c=a(e,i,l),h="[id='"+h+"']",u=0,p=c.length;p>u;u++)c[u]=h+c[u].selector;try{return F.apply(n,D.call(g.querySelectorAll(c.join(",")),0)),n}catch(d){}finally{f||i.removeAttribute("id")}}return t(e,i,n,s,l)},l&&(rt(function(t){e=l.call(t,"div");try{l.call(t,"[test!='']:sizzle"),s.push(it.PSEUDO.source,it.POS.source,"!=")}catch(i){}}),s=new RegExp(s.join("|")),i.matchesSelector=function(t,r){if(r=r.replace(n,"='$1']"),!(b(t)||s.test(r)||o&&o.test(r)))try{var a=l.call(t,r);if(a||e||t.document&&11!==t.document.nodeType)return a}catch(d){}return i(r,null,null,[t]).length>0})}(),v.setFilters.nth=v.setFilters.eq,v.filters=v.pseudos,i.attr=J.attr,J.find=i,J.expr=i.selectors,J.expr[":"]=J.expr.pseudos,J.unique=i.uniqueSort,J.text=i.getText,J.isXMLDoc=i.isXML,J.contains=i.contains}(e);var Wt=/Until$/,Ht=/^(?:parents|prev(?:Until|All))/,Ot=/^.[^:#\[\.,]*$/,Bt=J.expr.match.needsContext,Rt={children:!0,contents:!0,next:!0,prev:!0};J.fn.extend({find:function(e){var t,i,r,n,o,a,s=this;if("string"!=typeof e)return J(e).filter(function(){for(t=0,i=s.length;i>t;t++)if(J.contains(s[t],this))return!0});for(a=this.pushStack("","find",e),t=0,i=this.length;i>t;t++)if(r=a.length,J.find(e,this[t],a),t>0)for(n=r;n<a.length;n++)for(o=0;r>o;o++)if(a[o]===a[n]){a.splice(n--,1);break}return a},has:function(e){var t,i=J(e,this),r=i.length;return this.filter(function(){for(t=0;r>t;t++)if(J.contains(this,i[t]))return!0})},not:function(e){return this.pushStack(d(this,e,!1),"not",e)},filter:function(e){return this.pushStack(d(this,e,!0),"filter",e)},is:function(e){return!!e&&("string"==typeof e?Bt.test(e)?J(e,this.context).index(this[0])>=0:J.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){for(var i,r=0,n=this.length,o=[],a=Bt.test(e)||"string"!=typeof e?J(e,t||this.context):0;n>r;r++)for(i=this[r];i&&i.ownerDocument&&i!==t&&11!==i.nodeType;){if(a?a.index(i)>-1:J.find.matchesSelector(i,e)){o.push(i);break}i=i.parentNode}return o=o.length>1?J.unique(o):o,this.pushStack(o,"closest",e)},index:function(e){return e?"string"==typeof e?J.inArray(this[0],J(e)):J.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var i="string"==typeof e?J(e,t):J.makeArray(e&&e.nodeType?[e]:e),r=J.merge(this.get(),i);return this.pushStack(s(i[0])||s(r[0])?r:J.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),J.fn.andSelf=J.fn.addBack,J.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return J.dir(e,"parentNode")},parentsUntil:function(e,t,i){return J.dir(e,"parentNode",i)},next:function(e){return l(e,"nextSibling")},prev:function(e){return l(e,"previousSibling")},nextAll:function(e){return J.dir(e,"nextSibling")},prevAll:function(e){return J.dir(e,"previousSibling")},nextUntil:function(e,t,i){return J.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return J.dir(e,"previousSibling",i)},siblings:function(e){return J.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return J.sibling(e.firstChild)},contents:function(e){return J.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:J.merge([],e.childNodes)}},function(e,t){J.fn[e]=function(i,r){var n=J.map(this,t,i);return Wt.test(e)||(r=i),r&&"string"==typeof r&&(n=J.filter(r,n)),n=this.length>1&&!Rt[e]?J.unique(n):n,this.length>1&&Ht.test(e)&&(n=n.reverse()),this.pushStack(n,e,Q.call(arguments).join(","))}}),J.extend({filter:function(e,t,i){return i&&(e=":not("+e+")"),1===t.length?J.find.matchesSelector(t[0],e)?[t[0]]:[]:J.find.matches(e,t)},dir:function(e,i,r){for(var n=[],o=e[i];o&&9!==o.nodeType&&(r===t||1!==o.nodeType||!J(o).is(r));)1===o.nodeType&&n.push(o),o=o[i];return n},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}});var It="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",jt=/ jQuery\d+="(?:null|\d+)"/g,Ut=/^\s+/,zt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Vt=/<([\w:]+)/,Yt=/<tbody/i,_t=/<|&#?\w+;/,qt=/<(?:script|style|link)/i,Qt=/<(?:script|object|embed|option|style)/i,$t=new RegExp("<(?:"+It+")[\\s/>]","i"),Gt=/^(?:checkbox|radio)$/,Xt=/checked\s*(?:[^=]|=\s*.checked.)/i,Kt=/\/(java|ecma)script/i,Jt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Zt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},ei=c(U),ti=ei.appendChild(U.createElement("div"));Zt.optgroup=Zt.option,Zt.tbody=Zt.tfoot=Zt.colgroup=Zt.caption=Zt.thead,Zt.th=Zt.td,J.support.htmlSerialize||(Zt._default=[1,"X<div>","</div>"]),J.fn.extend({text:function(e){return J.access(this,function(e){return e===t?J.text(this):this.empty().append((this[0]&&this[0].ownerDocument||U).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(J.isFunction(e))return this.each(function(t){J(this).wrapAll(e.call(this,t))});if(this[0]){var t=J(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return this.each(J.isFunction(e)?function(t){J(this).wrapInner(e.call(this,t))}:function(){var t=J(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=J.isFunction(e);return this.each(function(i){J(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){J.nodeName(this,"body")||J(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!s(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=J.clean(arguments);return this.pushStack(J.merge(e,this),"before",this.selector)}},after:function(){if(!s(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=J.clean(arguments);return this.pushStack(J.merge(this,e),"after",this.selector)}},remove:function(e,t){for(var i,r=0;null!=(i=this[r]);r++)(!e||J.filter(e,[i]).length)&&(!t&&1===i.nodeType&&(J.cleanData(i.getElementsByTagName("*")),J.cleanData([i])),i.parentNode&&i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)for(1===e.nodeType&&J.cleanData(e.getElementsByTagName("*"));e.firstChild;)e.removeChild(e.firstChild);return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return J.clone(this,e,t)})},html:function(e){return J.access(this,function(e){var i=this[0]||{},r=0,n=this.length;if(e===t)return 1===i.nodeType?i.innerHTML.replace(jt,""):t;if(!("string"!=typeof e||qt.test(e)||!J.support.htmlSerialize&&$t.test(e)||!J.support.leadingWhitespace&&Ut.test(e)||Zt[(Vt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(zt,"<$1></$2>");try{for(;n>r;r++)i=this[r]||{},1===i.nodeType&&(J.cleanData(i.getElementsByTagName("*")),i.innerHTML=e);i=0}catch(o){}}i&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return s(this[0])?this.length?this.pushStack(J(J.isFunction(e)?e():e),"replaceWith",e):this:J.isFunction(e)?this.each(function(t){var i=J(this),r=i.html();i.replaceWith(e.call(this,t,r))}):("string"!=typeof e&&(e=J(e).detach()),this.each(function(){var t=this.nextSibling,i=this.parentNode;J(this).remove(),t?J(t).before(e):J(i).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,i,r){e=[].concat.apply([],e);var n,o,a,s,l=0,d=e[0],c=[],p=this.length;if(!J.support.checkClone&&p>1&&"string"==typeof d&&Xt.test(d))return this.each(function(){J(this).domManip(e,i,r)});if(J.isFunction(d))return this.each(function(n){var o=J(this);e[0]=d.call(this,n,i?o.html():t),o.domManip(e,i,r)});if(this[0]){if(n=J.buildFragment(e,this,c),a=n.fragment,o=a.firstChild,1===a.childNodes.length&&(a=o),o)for(i=i&&J.nodeName(o,"tr"),s=n.cacheable||p-1;p>l;l++)r.call(i&&J.nodeName(this[l],"table")?u(this[l],"tbody"):this[l],l===s?a:J.clone(a,!0,!0));a=o=null,c.length&&J.each(c,function(e,t){t.src?J.ajax?J.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):J.error("no ajax"):J.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Jt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),J.buildFragment=function(e,i,r){var n,o,a,s=e[0];return i=i||U,i=!i.nodeType&&i[0]||i,i=i.ownerDocument||i,1===e.length&&"string"==typeof s&&s.length<512&&i===U&&"<"===s.charAt(0)&&!Qt.test(s)&&(J.support.checkClone||!Xt.test(s))&&(J.support.html5Clone||!$t.test(s))&&(o=!0,n=J.fragments[s],a=n!==t),n||(n=i.createDocumentFragment(),J.clean(e,i,n,r),o&&(J.fragments[s]=a&&n)),{fragment:n,cacheable:o}},J.fragments={},J.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){J.fn[e]=function(i){var r,n=0,o=[],a=J(i),s=a.length,l=1===this.length&&this[0].parentNode;if((null==l||l&&11===l.nodeType&&1===l.childNodes.length)&&1===s)return a[t](this[0]),this;for(;s>n;n++)r=(n>0?this.clone(!0):this).get(),J(a[n])[t](r),o=o.concat(r);return this.pushStack(o,e,a.selector)}}),J.extend({clone:function(e,t,i){var r,n,o,a;if(J.support.html5Clone||J.isXMLDoc(e)||!$t.test("<"+e.nodeName+">")?a=e.cloneNode(!0):(ti.innerHTML=e.outerHTML,ti.removeChild(a=ti.firstChild)),!(J.support.noCloneEvent&&J.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||J.isXMLDoc(e)))for(f(e,a),r=h(e),n=h(a),o=0;r[o];++o)n[o]&&f(r[o],n[o]);if(t&&(p(e,a),i))for(r=h(e),n=h(a),o=0;r[o];++o)p(r[o],n[o]);return r=n=null,a},clean:function(e,t,i,r){var n,o,a,s,l,d,u,p,f,h,m,y=t===U&&ei,v=[];for(t&&"undefined"!=typeof t.createDocumentFragment||(t=U),n=0;null!=(a=e[n]);n++)if("number"==typeof a&&(a+=""),a){if("string"==typeof a)if(_t.test(a)){for(y=y||c(t),u=t.createElement("div"),y.appendChild(u),a=a.replace(zt,"<$1></$2>"),s=(Vt.exec(a)||["",""])[1].toLowerCase(),l=Zt[s]||Zt._default,d=l[0],u.innerHTML=l[1]+a+l[2];d--;)u=u.lastChild;if(!J.support.tbody)for(p=Yt.test(a),f="table"!==s||p?"<table>"!==l[1]||p?[]:u.childNodes:u.firstChild&&u.firstChild.childNodes,o=f.length-1;o>=0;--o)J.nodeName(f[o],"tbody")&&!f[o].childNodes.length&&f[o].parentNode.removeChild(f[o]);!J.support.leadingWhitespace&&Ut.test(a)&&u.insertBefore(t.createTextNode(Ut.exec(a)[0]),u.firstChild),a=u.childNodes,u.parentNode.removeChild(u)}else a=t.createTextNode(a);a.nodeType?v.push(a):J.merge(v,a)}if(u&&(a=u=y=null),!J.support.appendChecked)for(n=0;null!=(a=v[n]);n++)J.nodeName(a,"input")?g(a):"undefined"!=typeof a.getElementsByTagName&&J.grep(a.getElementsByTagName("input"),g);if(i)for(h=function(e){return!e.type||Kt.test(e.type)?r?r.push(e.parentNode?e.parentNode.removeChild(e):e):i.appendChild(e):void 0},n=0;null!=(a=v[n]);n++)J.nodeName(a,"script")&&h(a)||(i.appendChild(a),"undefined"!=typeof a.getElementsByTagName&&(m=J.grep(J.merge([],a.getElementsByTagName("script")),h),v.splice.apply(v,[n+1,0].concat(m)),n+=m.length));return v},cleanData:function(e,t){for(var i,r,n,o,a=0,s=J.expando,l=J.cache,d=J.support.deleteExpando,c=J.event.special;null!=(n=e[a]);a++)if((t||J.acceptData(n))&&(r=n[s],i=r&&l[r])){if(i.events)for(o in i.events)c[o]?J.event.remove(n,o):J.removeEvent(n,o,i.handle);l[r]&&(delete l[r],d?delete n[s]:n.removeAttribute?n.removeAttribute(s):n[s]=null,J.deletedIds.push(r))}}}),function(){var e,t;J.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=J.uaMatch(V.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),J.browser=t,J.sub=function(){function e(t,i){return new e.fn.init(t,i)}J.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function i(i,r){return r&&r instanceof J&&!(r instanceof e)&&(r=e(r)),J.fn.init.call(this,i,r,t)},e.fn.init.prototype=e.fn;var t=e(U);return e}}();var ii,ri,ni,oi=/alpha\([^)]*\)/i,ai=/opacity=([^)]*)/,si=/^(top|right|bottom|left)$/,li=/^(none|table(?!-c[ea]).+)/,di=/^margin/,ci=new RegExp("^("+Z+")(.*)$","i"),ui=new RegExp("^("+Z+")(?!px)[a-z%]+$","i"),pi=new RegExp("^([-+])=("+Z+")","i"),fi={},hi={position:"absolute",visibility:"hidden",display:"block"},gi={letterSpacing:0,fontWeight:400},mi=["Top","Right","Bottom","Left"],yi=["Webkit","O","Moz","ms"],vi=J.fn.toggle;J.fn.extend({css:function(e,i){return J.access(this,function(e,i,r){return r!==t?J.style(e,i,r):J.css(e,i)},e,i,arguments.length>1)},show:function(){return v(this,!0)},hide:function(){return v(this)},toggle:function(e,t){var i="boolean"==typeof e;return J.isFunction(e)&&J.isFunction(t)?vi.apply(this,arguments):this.each(function(){(i?e:y(this))?J(this).show():J(this).hide()})}}),J.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=ii(e,"opacity");return""===i?"1":i}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":J.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,i,r,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,l=J.camelCase(i),d=e.style;if(i=J.cssProps[l]||(J.cssProps[l]=m(d,l)),s=J.cssHooks[i]||J.cssHooks[l],r===t)return s&&"get"in s&&(o=s.get(e,!1,n))!==t?o:d[i];if(a=typeof r,"string"===a&&(o=pi.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(J.css(e,i)),a="number"),!(null==r||"number"===a&&isNaN(r)||("number"===a&&!J.cssNumber[l]&&(r+="px"),s&&"set"in s&&(r=s.set(e,r,n))===t)))try{d[i]=r}catch(c){}}},css:function(e,i,r,n){var o,a,s,l=J.camelCase(i);return i=J.cssProps[l]||(J.cssProps[l]=m(e.style,l)),s=J.cssHooks[i]||J.cssHooks[l],s&&"get"in s&&(o=s.get(e,!0,n)),o===t&&(o=ii(e,i)),"normal"===o&&i in gi&&(o=gi[i]),r||n!==t?(a=parseFloat(o),r||J.isNumeric(a)?a||0:o):o},swap:function(e,t,i){var r,n,o={};for(n in t)o[n]=e.style[n],e.style[n]=t[n];r=i.call(e);for(n in t)e.style[n]=o[n];return r}}),e.getComputedStyle?ii=function(t,i){var r,n,o,a,s=e.getComputedStyle(t,null),l=t.style;return s&&(r=s[i],""===r&&!J.contains(t.ownerDocument,t)&&(r=J.style(t,i)),ui.test(r)&&di.test(i)&&(n=l.width,o=l.minWidth,a=l.maxWidth,l.minWidth=l.maxWidth=l.width=r,r=s.width,l.width=n,l.minWidth=o,l.maxWidth=a)),r}:U.documentElement.currentStyle&&(ii=function(e,t){var i,r,n=e.currentStyle&&e.currentStyle[t],o=e.style;return null==n&&o&&o[t]&&(n=o[t]),ui.test(n)&&!si.test(t)&&(i=o.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),o.left="fontSize"===t?"1em":n,n=o.pixelLeft+"px",o.left=i,r&&(e.runtimeStyle.left=r)),""===n?"auto":n}),J.each(["height","width"],function(e,t){J.cssHooks[t]={get:function(e,i,r){return i?0===e.offsetWidth&&li.test(ii(e,"display"))?J.swap(e,hi,function(){return x(e,t,r)}):x(e,t,r):void 0},set:function(e,i,r){return T(e,i,r?b(e,t,r,J.support.boxSizing&&"border-box"===J.css(e,"boxSizing")):0)}}}),J.support.opacity||(J.cssHooks.opacity={get:function(e,t){return ai.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,r=e.currentStyle,n=J.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=r&&r.filter||i.filter||"";i.zoom=1,t>=1&&""===J.trim(o.replace(oi,""))&&i.removeAttribute&&(i.removeAttribute("filter"),r&&!r.filter)||(i.filter=oi.test(o)?o.replace(oi,n):o+" "+n)}}),J(function(){J.support.reliableMarginRight||(J.cssHooks.marginRight={get:function(e,t){return J.swap(e,{display:"inline-block"},function(){return t?ii(e,"marginRight"):void 0})}}),!J.support.pixelPosition&&J.fn.position&&J.each(["top","left"],function(e,t){J.cssHooks[t]={get:function(e,i){if(i){var r=ii(e,t);return ui.test(r)?J(e).position()[t]+"px":r}}}})}),J.expr&&J.expr.filters&&(J.expr.filters.hidden=function(e){return 0===e.offsetWidth&&0===e.offsetHeight||!J.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||ii(e,"display"))},J.expr.filters.visible=function(e){return!J.expr.filters.hidden(e)}),J.each({margin:"",padding:"",border:"Width"},function(e,t){J.cssHooks[e+t]={expand:function(i){var r,n="string"==typeof i?i.split(" "):[i],o={};for(r=0;4>r;r++)o[e+mi[r]+t]=n[r]||n[r-2]||n[0];return o}},di.test(e)||(J.cssHooks[e+t].set=T)});var Ti=/%20/g,bi=/\[\]$/,xi=/\r?\n/g,wi=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,ki=/^(?:select|textarea)/i;J.fn.extend({serialize:function(){return J.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?J.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||ki.test(this.nodeName)||wi.test(this.type))}).map(function(e,t){var i=J(this).val();return null==i?null:J.isArray(i)?J.map(i,function(e){return{name:t.name,value:e.replace(xi,"\r\n")}}):{name:t.name,value:i.replace(xi,"\r\n")}}).get()}}),J.param=function(e,i){var r,n=[],o=function(e,t){t=J.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(i===t&&(i=J.ajaxSettings&&J.ajaxSettings.traditional),J.isArray(e)||e.jquery&&!J.isPlainObject(e))J.each(e,function(){o(this.name,this.value)});else for(r in e)k(r,e[r],i,o);return n.join("&").replace(Ti,"+")};var Si,Ei,Ci=/#.*$/,Ai=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Li=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,Mi=/^(?:GET|HEAD)$/,Pi=/^\/\//,Di=/\?/,Fi=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Ni=/([?&])_=[^&]*/,Wi=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Hi=J.fn.load,Oi={},Bi={},Ri=["*/"]+["*"];try{Si=z.href}catch(Ii){Si=U.createElement("a"),Si.href="",Si=Si.href}Ei=Wi.exec(Si.toLowerCase())||[],J.fn.load=function(e,i,r){if("string"!=typeof e&&Hi)return Hi.apply(this,arguments);if(!this.length)return this;var n,o,a,s=this,l=e.indexOf(" ");return l>=0&&(n=e.slice(l,e.length),e=e.slice(0,l)),J.isFunction(i)?(r=i,i=t):i&&"object"==typeof i&&(o="POST"),J.ajax({url:e,type:o,dataType:"html",data:i,complete:function(e,t){r&&s.each(r,a||[e.responseText,t,e])}}).done(function(e){a=arguments,s.html(n?J("<div>").append(e.replace(Fi,"")).find(n):e)}),this},J.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){J.fn[t]=function(e){return this.on(t,e)
}}),J.each(["get","post"],function(e,i){J[i]=function(e,r,n,o){return J.isFunction(r)&&(o=o||n,n=r,r=t),J.ajax({type:i,url:e,data:r,success:n,dataType:o})}}),J.extend({getScript:function(e,i){return J.get(e,t,i,"script")},getJSON:function(e,t,i){return J.get(e,t,i,"json")},ajaxSetup:function(e,t){return t?C(e,J.ajaxSettings):(t=e,e=J.ajaxSettings),C(e,t),e},ajaxSettings:{url:Si,isLocal:Li.test(Ei[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Ri},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":J.parseJSON,"text xml":J.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:S(Oi),ajaxTransport:S(Bi),ajax:function(e,i){function r(e,i,r,a){var d,u,v,T,x,k=i;2!==b&&(b=2,l&&clearTimeout(l),s=t,o=a||"",w.readyState=e>0?4:0,r&&(T=A(p,w,r)),e>=200&&300>e||304===e?(p.ifModified&&(x=w.getResponseHeader("Last-Modified"),x&&(J.lastModified[n]=x),x=w.getResponseHeader("Etag"),x&&(J.etag[n]=x)),304===e?(k="notmodified",d=!0):(d=L(p,T),k=d.state,u=d.data,v=d.error,d=!v)):(v=k,(!k||e)&&(k="error",0>e&&(e=0))),w.status=e,w.statusText=""+(i||k),d?g.resolveWith(f,[u,k,w]):g.rejectWith(f,[w,k,v]),w.statusCode(y),y=t,c&&h.trigger("ajax"+(d?"Success":"Error"),[w,p,d?u:v]),m.fireWith(f,[w,k]),c&&(h.trigger("ajaxComplete",[w,p]),--J.active||J.event.trigger("ajaxStop")))}"object"==typeof e&&(i=e,e=t),i=i||{};var n,o,a,s,l,d,c,u,p=J.ajaxSetup({},i),f=p.context||p,h=f!==p&&(f.nodeType||f instanceof J)?J(f):J.event,g=J.Deferred(),m=J.Callbacks("once memory"),y=p.statusCode||{},v={},T={},b=0,x="canceled",w={readyState:0,setRequestHeader:function(e,t){if(!b){var i=e.toLowerCase();e=T[i]=T[i]||e,v[e]=t}return this},getAllResponseHeaders:function(){return 2===b?o:null},getResponseHeader:function(e){var i;if(2===b){if(!a)for(a={};i=Ai.exec(o);)a[i[1].toLowerCase()]=i[2];i=a[e.toLowerCase()]}return i===t?null:i},overrideMimeType:function(e){return b||(p.mimeType=e),this},abort:function(e){return e=e||x,s&&s.abort(e),r(0,e),this}};if(g.promise(w),w.success=w.done,w.error=w.fail,w.complete=m.add,w.statusCode=function(e){if(e){var t;if(2>b)for(t in e)y[t]=[y[t],e[t]];else t=e[w.status],w.always(t)}return this},p.url=((e||p.url)+"").replace(Ci,"").replace(Pi,Ei[1]+"//"),p.dataTypes=J.trim(p.dataType||"*").toLowerCase().split(tt),null==p.crossDomain&&(d=Wi.exec(p.url.toLowerCase()),p.crossDomain=!(!d||d[1]==Ei[1]&&d[2]==Ei[2]&&(d[3]||("http:"===d[1]?80:443))==(Ei[3]||("http:"===Ei[1]?80:443)))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=J.param(p.data,p.traditional)),E(Oi,p,i,w),2===b)return w;if(c=p.global,p.type=p.type.toUpperCase(),p.hasContent=!Mi.test(p.type),c&&0===J.active++&&J.event.trigger("ajaxStart"),!p.hasContent&&(p.data&&(p.url+=(Di.test(p.url)?"&":"?")+p.data,delete p.data),n=p.url,p.cache===!1)){var k=J.now(),S=p.url.replace(Ni,"$1_="+k);p.url=S+(S===p.url?(Di.test(p.url)?"&":"?")+"_="+k:"")}(p.data&&p.hasContent&&p.contentType!==!1||i.contentType)&&w.setRequestHeader("Content-Type",p.contentType),p.ifModified&&(n=n||p.url,J.lastModified[n]&&w.setRequestHeader("If-Modified-Since",J.lastModified[n]),J.etag[n]&&w.setRequestHeader("If-None-Match",J.etag[n])),w.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Ri+"; q=0.01":""):p.accepts["*"]);for(u in p.headers)w.setRequestHeader(u,p.headers[u]);if(!p.beforeSend||p.beforeSend.call(f,w,p)!==!1&&2!==b){x="abort";for(u in{success:1,error:1,complete:1})w[u](p[u]);if(s=E(Bi,p,i,w)){w.readyState=1,c&&h.trigger("ajaxSend",[w,p]),p.async&&p.timeout>0&&(l=setTimeout(function(){w.abort("timeout")},p.timeout));try{b=1,s.send(v,r)}catch(C){if(!(2>b))throw C;r(-1,C)}}else r(-1,"No Transport");return w}return w.abort()},active:0,lastModified:{},etag:{}});var ji=[],Ui=/\?/,zi=/(=)\?(?=&|$)|\?\?/,Vi=J.now();J.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=ji.pop()||J.expando+"_"+Vi++;return this[e]=!0,e}}),J.ajaxPrefilter("json jsonp",function(i,r,n){var o,a,s,l=i.data,d=i.url,c=i.jsonp!==!1,u=c&&zi.test(d),p=c&&!u&&"string"==typeof l&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&zi.test(l);return"jsonp"===i.dataTypes[0]||u||p?(o=i.jsonpCallback=J.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,a=e[o],u?i.url=d.replace(zi,"$1"+o):p?i.data=l.replace(zi,"$1"+o):c&&(i.url+=(Ui.test(d)?"&":"?")+i.jsonp+"="+o),i.converters["script json"]=function(){return s||J.error(o+" was not called"),s[0]},i.dataTypes[0]="json",e[o]=function(){s=arguments},n.always(function(){e[o]=a,i[o]&&(i.jsonpCallback=r.jsonpCallback,ji.push(o)),s&&J.isFunction(a)&&a(s[0]),s=a=t}),"script"):void 0}),J.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return J.globalEval(e),e}}}),J.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),J.ajaxTransport("script",function(e){if(e.crossDomain){var i,r=U.head||U.getElementsByTagName("head")[0]||U.documentElement;return{send:function(n,o){i=U.createElement("script"),i.async="async",e.scriptCharset&&(i.charset=e.scriptCharset),i.src=e.url,i.onload=i.onreadystatechange=function(e,n){(n||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,r&&i.parentNode&&r.removeChild(i),i=t,n||o(200,"success"))},r.insertBefore(i,r.firstChild)},abort:function(){i&&i.onload(0,1)}}}});var Yi,_i=e.ActiveXObject?function(){for(var e in Yi)Yi[e](0,1)}:!1,qi=0;J.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&M()||P()}:M,function(e){J.extend(J.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(J.ajaxSettings.xhr()),J.support.ajax&&J.ajaxTransport(function(i){if(!i.crossDomain||J.support.cors){var r;return{send:function(n,o){var a,s,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(s in i.xhrFields)l[s]=i.xhrFields[s];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),!i.crossDomain&&!n["X-Requested-With"]&&(n["X-Requested-With"]="XMLHttpRequest");try{for(s in n)l.setRequestHeader(s,n[s])}catch(d){}l.send(i.hasContent&&i.data||null),r=function(e,n){var s,d,c,u,p;try{if(r&&(n||4===l.readyState))if(r=t,a&&(l.onreadystatechange=J.noop,_i&&delete Yi[a]),n)4!==l.readyState&&l.abort();else{s=l.status,c=l.getAllResponseHeaders(),u={},p=l.responseXML,p&&p.documentElement&&(u.xml=p);try{u.text=l.responseText}catch(e){}try{d=l.statusText}catch(f){d=""}s||!i.isLocal||i.crossDomain?1223===s&&(s=204):s=u.text?200:404}}catch(h){n||o(-1,h)}u&&o(s,d,u,c)},i.async?4===l.readyState?setTimeout(r,0):(a=++qi,_i&&(Yi||(Yi={},J(e).unload(_i)),Yi[a]=r),l.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var Qi,$i,Gi=/^(?:toggle|show|hide)$/,Xi=new RegExp("^(?:([-+])=|)("+Z+")([a-z%]*)$","i"),Ki=/queueHooks$/,Ji=[H],Zi={"*":[function(e,t){var i,r,n,o=this.createTween(e,t),a=Xi.exec(t),s=o.cur(),l=+s||0,d=1;if(a){if(i=+a[2],r=a[3]||(J.cssNumber[e]?"":"px"),"px"!==r&&l){l=J.css(o.elem,e,!0)||i||1;do n=d=d||".5",l/=d,J.style(o.elem,e,l+r),d=o.cur()/s;while(1!==d&&d!==n)}o.unit=r,o.start=l,o.end=a[1]?l+(a[1]+1)*i:i}return o}]};J.Animation=J.extend(N,{tweener:function(e,t){J.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,r=0,n=e.length;n>r;r++)i=e[r],Zi[i]=Zi[i]||[],Zi[i].unshift(t)},prefilter:function(e,t){t?Ji.unshift(e):Ji.push(e)}}),J.Tween=O,O.prototype={constructor:O,init:function(e,t,i,r,n,o){this.elem=e,this.prop=i,this.easing=n||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(J.cssNumber[i]?"":"px")},cur:function(){var e=O.propHooks[this.prop];return e&&e.get?e.get(this):O.propHooks._default.get(this)},run:function(e){var t,i=O.propHooks[this.prop];return this.pos=t=this.options.duration?J.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):O.propHooks._default.set(this),this}},O.prototype.init.prototype=O.prototype,O.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=J.css(e.elem,e.prop,!1,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){J.fx.step[e.prop]?J.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[J.cssProps[e.prop]]||J.cssHooks[e.prop])?J.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},O.propHooks.scrollTop=O.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},J.each(["toggle","show","hide"],function(e,t){var i=J.fn[t];J.fn[t]=function(r,n,o){return null==r||"boolean"==typeof r||!e&&J.isFunction(r)&&J.isFunction(n)?i.apply(this,arguments):this.animate(B(t,!0),r,n,o)}}),J.fn.extend({fadeTo:function(e,t,i,r){return this.filter(y).css("opacity",0).show().end().animate({opacity:t},e,i,r)},animate:function(e,t,i,r){var n=J.isEmptyObject(e),o=J.speed(t,i,r),a=function(){var t=N(this,J.extend({},e),o);n&&t.stop(!0)};return n||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,i,r){var n=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=i,i=e,e=t),i&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=J.timers,a=J._data(this);if(i)a[i]&&a[i].stop&&n(a[i]);else for(i in a)a[i]&&a[i].stop&&Ki.test(i)&&n(a[i]);for(i=o.length;i--;)o[i].elem===this&&(null==e||o[i].queue===e)&&(o[i].anim.stop(r),t=!1,o.splice(i,1));(t||!r)&&J.dequeue(this,e)})}}),J.each({slideDown:B("show"),slideUp:B("hide"),slideToggle:B("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){J.fn[e]=function(e,i,r){return this.animate(t,e,i,r)}}),J.speed=function(e,t,i){var r=e&&"object"==typeof e?J.extend({},e):{complete:i||!i&&t||J.isFunction(e)&&e,duration:e,easing:i&&t||t&&!J.isFunction(t)&&t};return r.duration=J.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in J.fx.speeds?J.fx.speeds[r.duration]:J.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){J.isFunction(r.old)&&r.old.call(this),r.queue&&J.dequeue(this,r.queue)},r},J.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},J.timers=[],J.fx=O.prototype.init,J.fx.tick=function(){for(var e,t=J.timers,i=0;i<t.length;i++)e=t[i],!e()&&t[i]===e&&t.splice(i--,1);t.length||J.fx.stop()},J.fx.timer=function(e){e()&&J.timers.push(e)&&!$i&&($i=setInterval(J.fx.tick,J.fx.interval))},J.fx.interval=13,J.fx.stop=function(){clearInterval($i),$i=null},J.fx.speeds={slow:600,fast:200,_default:400},J.fx.step={},J.expr&&J.expr.filters&&(J.expr.filters.animated=function(e){return J.grep(J.timers,function(t){return e===t.elem}).length});var er=/^(?:body|html)$/i;J.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){J.offset.setOffset(this,e,t)});var i,r,n,o,a,s,l,d,c,u,p=this[0],f=p&&p.ownerDocument;if(f)return(n=f.body)===p?J.offset.bodyOffset(p):(r=f.documentElement,J.contains(r,p)?(i=p.getBoundingClientRect(),o=R(f),a=r.clientTop||n.clientTop||0,s=r.clientLeft||n.clientLeft||0,l=o.pageYOffset||r.scrollTop,d=o.pageXOffset||r.scrollLeft,c=i.top+l-a,u=i.left+d-s,{top:c,left:u}):{top:0,left:0})},J.offset={bodyOffset:function(e){var t=e.offsetTop,i=e.offsetLeft;return J.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(J.css(e,"marginTop"))||0,i+=parseFloat(J.css(e,"marginLeft"))||0),{top:t,left:i}},setOffset:function(e,t,i){var r=J.css(e,"position");"static"===r&&(e.style.position="relative");var n,o,a=J(e),s=a.offset(),l=J.css(e,"top"),d=J.css(e,"left"),c=("absolute"===r||"fixed"===r)&&J.inArray("auto",[l,d])>-1,u={},p={};c?(p=a.position(),n=p.top,o=p.left):(n=parseFloat(l)||0,o=parseFloat(d)||0),J.isFunction(t)&&(t=t.call(e,i,s)),null!=t.top&&(u.top=t.top-s.top+n),null!=t.left&&(u.left=t.left-s.left+o),"using"in t?t.using.call(e,u):a.css(u)}},J.fn.extend({position:function(){if(this[0]){var e=this[0],t=this.offsetParent(),i=this.offset(),r=er.test(t[0].nodeName)?{top:0,left:0}:t.offset();return i.top-=parseFloat(J.css(e,"marginTop"))||0,i.left-=parseFloat(J.css(e,"marginLeft"))||0,r.top+=parseFloat(J.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(J.css(t[0],"borderLeftWidth"))||0,{top:i.top-r.top,left:i.left-r.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||U.body;e&&!er.test(e.nodeName)&&"static"===J.css(e,"position");)e=e.offsetParent;return e||U.body})}}),J.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var r=/Y/.test(i);J.fn[e]=function(n){return J.access(this,function(e,n,o){var a=R(e);return o===t?a?i in a?a[i]:a.document.documentElement[n]:e[n]:void(a?a.scrollTo(r?J(a).scrollLeft():o,r?o:J(a).scrollTop()):e[n]=o)},e,n,arguments.length,null)}}),J.each({Height:"height",Width:"width"},function(e,i){J.each({padding:"inner"+e,content:i,"":"outer"+e},function(r,n){J.fn[n]=function(n,o){var a=arguments.length&&(r||"boolean"!=typeof n),s=r||(n===!0||o===!0?"margin":"border");return J.access(this,function(i,r,n){var o;return J.isWindow(i)?i.document.documentElement["client"+e]:9===i.nodeType?(o=i.documentElement,Math.max(i.body["scroll"+e],o["scroll"+e],i.body["offset"+e],o["offset"+e],o["client"+e])):n===t?J.css(i,r,n,s):J.style(i,r,n,s)},i,a?n:t,a,null)}})}),e.jQuery=e.$=J,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return J})}(window),function(e){e.encoding||(e.encoding={}),e.extend(e.encoding,{strToBe32s:function(e){var t,i,r=[],n=Math.floor(e.length/4);for(t=0,i=0;n>t;t++,i+=4)r[t]=(255&e.charCodeAt(i))<<24|(255&e.charCodeAt(i+1))<<16|(255&e.charCodeAt(i+2))<<8|255&e.charCodeAt(i+3);for(;i<e.length;)r[i>>2]|=(255&e.charCodeAt(i))<<24-8*i%32,i++;return r},be32sToStr:function(e){for(var t="",i=0;i<32*e.length;i+=8)t+=String.fromCharCode(e[i>>5]>>>24-i%32&255);return t},be32sToHex:function(e){for(var t="0123456789ABCDEF",i="",r=0;r<4*e.length;r++)i+=t.charAt(e[r>>2]>>8*(3-r%4)+4&15)+t.charAt(e[r>>2]>>8*(3-r%4)&15);return i}})}(jQuery),function(e){function t(e,t){function i(e,t){var i=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(i>>16);return r<<16|65535&i}function r(e,t,i,r,n){t=t>>>27|t<<5;var o=(65535&e)+(65535&t)+(65535&i)+(65535&r)+(65535&n),a=(e>>16)+(t>>16)+(i>>16)+(r>>16)+(n>>16)+(o>>16);return a<<16|65535&o}function n(e,t){var i=e[t-3]^e[t-8]^e[t-14]^e[t-16];return i>>>31|i<<1}var o=8*t;e[o>>5]|=128<<24-o%32,e[(o+64>>9<<4)+15]=o;for(var a=new Array(80),s=1518500249,l=1859775393,d=2400959708,c=3395469782,u=1732584193,p=4023233417,f=2562383102,h=271733878,g=3285377520,m=0;m<e.length;m+=16){for(var y,v=0,T=u,b=p,x=f,w=h,k=g;16>v;)a[v]=e[m+v],y=r(k,T,w^b&(x^w),a[v],s),k=w,w=x,x=b>>>2|b<<30,b=T,T=y,v++;for(;20>v;)a[v]=n(a,v),y=r(k,T,w^b&(x^w),a[v],s),k=w,w=x,x=b>>>2|b<<30,b=T,T=y,v++;for(;40>v;)a[v]=n(a,v),y=r(k,T,b^x^w,a[v],l),k=w,w=x,x=b>>>2|b<<30,b=T,T=y,v++;for(;60>v;)a[v]=n(a,v),y=r(k,T,b&x|w&(b|x),a[v],d),k=w,w=x,x=b>>>2|b<<30,b=T,T=y,v++;for(;80>v;)a[v]=n(a,v),y=r(k,T,b^x^w,a[v],c),k=w,w=x,x=b>>>2|b<<30,b=T,T=y,v++;u=i(u,T),p=i(p,b),f=i(f,x),h=i(h,w),g=i(g,k)}return[u,p,f,h,g]}e.encoding.digests||(e.encoding.digests={}),e.extend(e.encoding.digests,{hexSha1Str:function(t){return e.encoding.be32sToHex(e.encoding.digests.sha1Str(t))},sha1Str:function(i){return t(e.encoding.strToBe32s(i),i.length)},sha1:function(){return t(e.encoding.strToBe32s(str),str.length)}})}(jQuery),function(e){var t="customStyleSheet";e.twStylesheet=function(e,i){i=i||{};var r=i.id||t,n=i.doc||document,o=n.getElementById(r);n.createStyleSheet?(o&&o.parentNode.removeChild(o),n.getElementsByTagName("head")[0].insertAdjacentHTML("beforeEnd",'&nbsp;<style id="'+r+'" type="text/css">'+e+"</style>")):o?o.replaceChild(n.createTextNode(e),o.firstChild):(o=n.createElement("style"),o.type="text/css",o.id=r,o.appendChild(n.createTextNode(e)),n.getElementsByTagName("head")[0].appendChild(o))},e.twStylesheet.remove=function(e){e=e||{};var i=e.id||t,r=e.doc||document,n=r.getElementById(i);n&&n.parentNode.removeChild(n)}}(jQuery),useJavaSaver&&document.write("<applet style='position:absolute;left:-1px' name='TiddlySaver' code='TiddlySaver.class' archive='TiddlySaver.jar' width='1' height='1'></applet>");